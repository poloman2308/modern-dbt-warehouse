[0m23:35:51.646585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F017B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F2569700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F256B3B0>]}


============================== 23:35:51.732886 | 19f4866d-58ff-4b11-8194-109f074cbdca ==============================
[0m23:35:51.732886 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:35:51.746378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:35:53.805008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F310F710>]}
[0m23:35:54.010454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F30F75F0>]}
[0m23:35:54.021366 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:35:55.102127 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:35:55.108136 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:35:55.109130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F4263FB0>]}
[0m23:35:58.184721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F4A08230>]}
[0m23:35:58.337900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:35:58.352425 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:35:58.533353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F49C7E60>]}
[0m23:35:58.534358 [info ] [MainThread]: Found 5 models, 10 data tests, 3 sources, 433 macros
[0m23:35:58.535354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F4A70140>]}
[0m23:35:58.538352 [info ] [MainThread]: 
[0m23:35:58.539353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:35:58.540353 [info ] [MainThread]: 
[0m23:35:58.541354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:58.554623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:36:02.228751 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:36:02.228751 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:36:02.229751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:02.316733 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.087 seconds
[0m23:36:02.317747 [debug] [ThreadPool]: On list_analytics: Close
[0m23:36:02.321366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:36:02.329314 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:36:02.330319 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:36:02.330319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:02.355135 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m23:36:02.356138 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:36:02.356138 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:36:02.382193 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m23:36:02.383207 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:36:02.385203 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:36:02.395184 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:02.395184 [debug] [MainThread]: On master: BEGIN
[0m23:36:02.396190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:02.417383 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m23:36:02.417383 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:02.417383 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:36:02.432693 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m23:36:02.434703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F4C920C0>]}
[0m23:36:02.435713 [debug] [MainThread]: On master: ROLLBACK
[0m23:36:02.436705 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:02.437706 [debug] [MainThread]: On master: BEGIN
[0m23:36:02.439700 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:36:02.440703 [debug] [MainThread]: On master: COMMIT
[0m23:36:02.440703 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:02.441702 [debug] [MainThread]: On master: COMMIT
[0m23:36:02.442703 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:36:02.442703 [debug] [MainThread]: On master: Close
[0m23:36:02.460967 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.my_first_dbt_model
[0m23:36:02.460967 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_customers
[0m23:36:02.461960 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_orders
[0m23:36:02.462961 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.stg_products
[0m23:36:02.461960 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:36:02.462961 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_customers ............................... [RUN]
[0m23:36:02.464467 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_orders .................................. [RUN]
[0m23:36:02.467756 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m23:36:02.473628 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m23:36:02.466489 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.my_first_dbt_model'
[0m23:36:02.470771 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m23:36:02.465477 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_products ................................ [RUN]
[0m23:36:02.484783 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.my_first_dbt_model
[0m23:36:02.501199 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m23:36:02.502803 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m23:36:02.503823 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m23:36:02.507826 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:36:02.510822 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m23:36:02.511820 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.stg_products
[0m23:36:02.517391 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m23:36:02.524653 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_customers
[0m23:36:02.535943 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.my_first_dbt_model
[0m23:36:02.536955 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_orders
[0m23:36:02.602292 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.stg_products
[0m23:36:02.613149 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.stg_orders"
[0m23:36:02.625682 [debug] [Thread-4 (]: Writing runtime sql for node "model.analytics_warehouse.stg_products"
[0m23:36:02.628684 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.stg_customers"
[0m23:36:02.642519 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:36:02.651088 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:36:02.652605 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: BEGIN
[0m23:36:02.653620 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:36:02.654622 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:36:02.655618 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: BEGIN
[0m23:36:02.656634 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:36:02.657618 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:36:02.658622 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: BEGIN
[0m23:36:02.660012 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:36:02.662240 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:36:02.663236 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: BEGIN
[0m23:36:02.663236 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:36:02.695036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:36:02.695036 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:36:02.696038 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */

  
    

  create  table "analytics"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m23:36:02.703944 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m23:36:02.703944 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:36:02.704954 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */

  create view "analytics"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."products"
)

select
    product_id,
    initcap(product_name) as product_name,
    price,
    category,
    created_at
from source
  );
[0m23:36:02.717016 [debug] [Thread-2 (]: SQL status: BEGIN in 0.061 seconds
[0m23:36:02.718016 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:36:02.719014 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */

  create view "analytics"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."customers"
)

select
    customer_id,
    lower(first_name) as first_name,
    lower(last_name) as last_name,
    lower(email) as email,
    created_at,
    updated_at,
from source
  );
[0m23:36:02.724010 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 18: from source
         ^

[0m23:36:02.725010 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: ROLLBACK
[0m23:36:02.727045 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: Close
[0m23:36:02.732579 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.035 seconds
[0m23:36:02.750626 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:36:02.751638 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:36:02.752635 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m23:36:02.758162 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:36:02.759154 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m23:36:02.762916 [debug] [Thread-3 (]: SQL status: BEGIN in 0.099 seconds
[0m23:36:02.764447 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:36:02.765465 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */

  create view "analytics"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."orders"
)

select
    order_id,
    customer_id,
    product_id,
    quantity,
    order_date,
    lower(status) as status
from source
  );
[0m23:36:02.769149 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m23:36:02.770150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m23:36:02.796996 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m23:36:02.809249 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:36:02.816180 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:36:02.817222 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:36:02.818038 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:36:02.818544 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:36:02.820556 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:36:02.820556 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:36:02.822068 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:36:02.824206 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:36:02.827219 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:36:02.828100 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:36:02.828100 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:36:02.848746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m23:36:02.850169 [debug] [Thread-4 (]: SQL status: COMMIT in 0.027 seconds
[0m23:36:02.855245 [debug] [Thread-3 (]: SQL status: COMMIT in 0.025 seconds
[0m23:36:02.863005 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."my_first_dbt_model__dbt_backup"
[0m23:36:02.867473 [debug] [Thread-4 (]: Applying DROP to: "analytics"."public"."stg_products__dbt_backup"
[0m23:36:02.872372 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."stg_orders__dbt_backup"
[0m23:36:02.882871 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:36:02.888644 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:36:02.890351 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:36:02.891075 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
drop table if exists "analytics"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:36:02.892087 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
drop view if exists "analytics"."public"."stg_products__dbt_backup" cascade
[0m23:36:02.893092 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
drop view if exists "analytics"."public"."stg_orders__dbt_backup" cascade
[0m23:36:02.896951 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:36:02.897950 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:36:02.898456 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:36:02.902877 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: Close
[0m23:36:02.905562 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: Close
[0m23:36:02.908524 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: Close
[0m23:36:02.929794 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F026F350>]}
[0m23:36:02.930314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F490AD50>]}
[0m23:36:02.931323 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F30AB9E0>]}
[0m23:36:02.932342 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.44s]
[0m23:36:02.936142 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_orders
[0m23:36:02.933353 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.45s]
[0m23:36:02.938318 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.my_first_dbt_model
[0m23:36:02.939870 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.my_second_dbt_model
[0m23:36:02.934868 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.41s]
[0m23:36:02.941867 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.stg_products
[0m23:36:02.940868 [info ] [Thread-3 (]: 5 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:36:02.976290 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_orders, now model.analytics_warehouse.my_second_dbt_model)
[0m23:36:02.978290 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.my_second_dbt_model
[0m23:36:02.987826 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:36:02.997069 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.my_second_dbt_model
[0m23:36:03.008370 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:36:03.018892 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:36:03.019898 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: BEGIN
[0m23:36:03.021601 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:03.077646 [debug] [Thread-3 (]: SQL status: BEGIN in 0.056 seconds
[0m23:36:03.078637 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:36:03.079642 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */

  create view "analytics"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "analytics"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:36:03.088028 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:36:03.095505 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:36:03.096522 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
alter table "analytics"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:36:03.102043 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:36:03.106076 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:36:03.106585 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:36:03.108596 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:36:03.116567 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m23:36:03.125958 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."my_second_dbt_model__dbt_backup"
[0m23:36:03.126970 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:36:03.128605 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
drop view if exists "analytics"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:36:03.130196 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:36:03.133726 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: Close
[0m23:36:03.135094 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F527F620>]}
[0m23:36:03.136361 [info ] [Thread-3 (]: 5 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.16s]
[0m23:36:03.139995 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.my_second_dbt_model
[0m23:36:03.177380 [debug] [Thread-2 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near "from"
  LINE 18: from source
           ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:36:03.178382 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19f4866d-58ff-4b11-8194-109f074cbdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F527F620>]}
[0m23:36:03.179377 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.71s]
[0m23:36:03.183711 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_customers
[0m23:36:03.184525 [debug] [Thread-7 (]: Marking all children of 'model.analytics_warehouse.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near "from"
  LINE 18: from source
           ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql.
[0m23:36:03.188600 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:03.189976 [debug] [MainThread]: On master: BEGIN
[0m23:36:03.189976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:03.246348 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m23:36:03.248466 [debug] [MainThread]: On master: COMMIT
[0m23:36:03.249478 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:03.250481 [debug] [MainThread]: On master: COMMIT
[0m23:36:03.252556 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:36:03.253565 [debug] [MainThread]: On master: Close
[0m23:36:03.255123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:03.255123 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:36:03.256139 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:36:03.257133 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_first_dbt_model' was properly closed.
[0m23:36:03.257133 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_customers' was properly closed.
[0m23:36:03.257133 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_second_dbt_model' was properly closed.
[0m23:36:03.258642 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_products' was properly closed.
[0m23:36:03.258642 [info ] [MainThread]: 
[0m23:36:03.269050 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m23:36:03.273217 [debug] [MainThread]: Command end result
[0m23:36:03.356398 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:36:03.368346 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:36:03.382442 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:36:03.383201 [info ] [MainThread]: 
[0m23:36:03.384919 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:36:03.386041 [info ] [MainThread]: 
[0m23:36:03.387351 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near "from"
  LINE 18: from source
           ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:36:03.389284 [info ] [MainThread]: 
[0m23:36:03.404963 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:36:03.421959 [debug] [MainThread]: Command `dbt run` failed at 23:36:03.421959 after 12.67 seconds
[0m23:36:03.421959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F017B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F25D0BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1F25D1130>]}
[0m23:36:03.425499 [debug] [MainThread]: Flushing usage events
[0m23:36:03.808345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:36:58.251867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E92C79070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E92B543E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E904E86B0>]}


============================== 23:36:58.262851 | cdf9f8e2-6bc5-4de5-bed2-70968ad726ca ==============================
[0m23:36:58.262851 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:36:58.265405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:36:58.670085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E904E86B0>]}
[0m23:36:58.755056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E9245CA70>]}
[0m23:36:58.759055 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:36:59.489800 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:36:59.975630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:59.976635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:00.091016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E94185C10>]}
[0m23:37:00.245114 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:37:00.260864 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:37:00.359186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E946BB500>]}
[0m23:37:00.360180 [info ] [MainThread]: Found 5 models, 10 data tests, 3 sources, 433 macros
[0m23:37:00.361182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E941045C0>]}
[0m23:37:00.367617 [info ] [MainThread]: 
[0m23:37:00.368628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:00.369632 [info ] [MainThread]: 
[0m23:37:00.371634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:00.378631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:37:01.376552 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:37:01.377566 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:37:01.377566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:01.427366 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.049 seconds
[0m23:37:01.428374 [debug] [ThreadPool]: On list_analytics: Close
[0m23:37:01.433170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:37:01.440178 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:37:01.440178 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:37:01.440178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:01.460888 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m23:37:01.461887 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:37:01.461887 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:37:01.468435 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m23:37:01.470458 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:37:01.471465 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:37:01.477582 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:01.478585 [debug] [MainThread]: On master: BEGIN
[0m23:37:01.478585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:01.495946 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m23:37:01.496971 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:01.496971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:37:01.508691 [debug] [MainThread]: SQL status: SELECT 3 in 0.011 seconds
[0m23:37:01.510709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E94185AF0>]}
[0m23:37:01.510709 [debug] [MainThread]: On master: ROLLBACK
[0m23:37:01.511691 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:01.512688 [debug] [MainThread]: On master: BEGIN
[0m23:37:01.514689 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:37:01.514689 [debug] [MainThread]: On master: COMMIT
[0m23:37:01.515859 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:01.515859 [debug] [MainThread]: On master: COMMIT
[0m23:37:01.516846 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:37:01.517872 [debug] [MainThread]: On master: Close
[0m23:37:01.527396 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.my_first_dbt_model
[0m23:37:01.527396 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_customers
[0m23:37:01.528393 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_orders
[0m23:37:01.529414 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.stg_products
[0m23:37:01.528393 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:37:01.530425 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_customers ............................... [RUN]
[0m23:37:01.532944 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.my_first_dbt_model'
[0m23:37:01.530931 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_orders .................................. [RUN]
[0m23:37:01.533951 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m23:37:01.531963 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_products ................................ [RUN]
[0m23:37:01.534956 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.my_first_dbt_model
[0m23:37:01.534956 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m23:37:01.535954 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m23:37:01.536953 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m23:37:01.546966 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:37:01.546966 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m23:37:01.552428 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m23:37:01.553423 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.stg_products
[0m23:37:01.557405 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m23:37:01.564429 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_customers
[0m23:37:01.566918 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m23:37:01.573926 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.my_first_dbt_model
[0m23:37:01.601132 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_orders
[0m23:37:01.656828 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.stg_products
[0m23:37:01.664334 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.stg_customers"
[0m23:37:01.668389 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.stg_orders"
[0m23:37:01.674683 [debug] [Thread-4 (]: Writing runtime sql for node "model.analytics_warehouse.stg_products"
[0m23:37:01.679691 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:37:01.683591 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:37:01.684601 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: BEGIN
[0m23:37:01.684601 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:37:01.685612 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:37:01.686602 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: BEGIN
[0m23:37:01.686602 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:37:01.687601 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:37:01.688605 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:37:01.689604 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: BEGIN
[0m23:37:01.691297 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: BEGIN
[0m23:37:01.692804 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:37:01.693600 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:01.714874 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m23:37:01.715882 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:37:01.716883 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */

  create view "analytics"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."customers"
)

select
    customer_id,
    lower(first_name) as first_name,
    lower(last_name) as last_name,
    lower(email) as email,
    created_at,
    updated_at,
from source
  );
[0m23:37:01.718396 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 18: from source
         ^

[0m23:37:01.718396 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: ROLLBACK
[0m23:37:01.719738 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m23:37:01.720751 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:37:01.720751 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */

  create view "analytics"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."orders"
)

select
    order_id,
    customer_id,
    product_id,
    quantity,
    order_date,
    lower(status) as status
from source
  );
[0m23:37:01.722104 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: Close
[0m23:37:01.727126 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m23:37:01.728128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m23:37:01.728128 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:37:01.729129 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:37:01.730124 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */

  create view "analytics"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."products"
)

select
    product_id,
    initcap(product_name) as product_name,
    price,
    category,
    created_at
from source
  );
[0m23:37:01.731127 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */

  
    

  create  table "analytics"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m23:37:01.735022 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m23:37:01.746818 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.014 seconds
[0m23:37:01.752128 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:37:01.757741 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:37:01.759497 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m23:37:01.760513 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:37:01.764511 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:37:01.765959 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m23:37:01.765959 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m23:37:01.766967 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m23:37:01.769972 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:37:01.770967 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:37:01.771973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:37:01.773029 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:37:01.777150 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:37:01.777150 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:37:01.782204 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:37:01.783218 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:37:01.806836 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m23:37:01.811840 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:37:01.812834 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:37:01.814340 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:37:01.815351 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:37:01.818885 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:37:01.819896 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:37:01.820892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m23:37:01.820892 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:37:01.832952 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:37:01.833960 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."stg_orders__dbt_backup"
[0m23:37:01.833960 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:37:01.834964 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:37:01.845429 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:37:01.846442 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:37:01.846442 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
drop view if exists "analytics"."public"."stg_orders__dbt_backup" cascade
[0m23:37:01.848959 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:37:01.852959 [debug] [Thread-4 (]: Applying DROP to: "analytics"."public"."stg_products__dbt_backup"
[0m23:37:01.853960 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:37:01.855960 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:37:01.863538 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."my_first_dbt_model__dbt_backup"
[0m23:37:01.864535 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m23:37:01.865045 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
drop view if exists "analytics"."public"."stg_products__dbt_backup" cascade
[0m23:37:01.871065 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:37:01.874064 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: Close
[0m23:37:01.875065 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
drop table if exists "analytics"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:37:01.882587 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:37:01.885798 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: Close
[0m23:37:01.890393 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E949ABA10>]}
[0m23:37:01.891407 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E923E3C50>]}
[0m23:37:01.892406 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.34s]
[0m23:37:01.895114 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_orders
[0m23:37:01.893915 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.35s]
[0m23:37:01.897652 [debug] [Thread-2 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near "from"
  LINE 18: from source
           ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:37:01.899484 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.stg_products
[0m23:37:01.900496 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E940785C0>]}
[0m23:37:01.902822 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.37s]
[0m23:37:01.903416 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_customers
[0m23:37:01.904432 [debug] [Thread-7 (]: Marking all children of 'model.analytics_warehouse.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near "from"
  LINE 18: from source
           ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql.
[0m23:37:01.907427 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.024 seconds
[0m23:37:01.908460 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: Close
[0m23:37:01.910426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E94AD2D80>]}
[0m23:37:01.911430 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.38s]
[0m23:37:01.912426 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.my_first_dbt_model
[0m23:37:01.913424 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.my_second_dbt_model
[0m23:37:01.915961 [info ] [Thread-3 (]: 5 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:37:01.916959 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_orders, now model.analytics_warehouse.my_second_dbt_model)
[0m23:37:01.918364 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.my_second_dbt_model
[0m23:37:01.922397 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:37:01.925925 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.my_second_dbt_model
[0m23:37:01.929926 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:37:01.935055 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:37:01.936069 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: BEGIN
[0m23:37:01.936069 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:37:01.956005 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m23:37:01.957169 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:37:01.957169 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */

  create view "analytics"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "analytics"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:37:01.960177 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:37:01.965782 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:37:01.965782 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
alter table "analytics"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:37:01.967794 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:37:01.969797 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:37:01.970838 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:37:01.971834 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:37:01.974791 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:37:01.976818 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."my_second_dbt_model__dbt_backup"
[0m23:37:01.977837 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:37:01.978795 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
drop view if exists "analytics"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:37:01.979816 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:37:01.982363 [debug] [Thread-3 (]: On model.analytics_warehouse.my_second_dbt_model: Close
[0m23:37:01.983379 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf9f8e2-6bc5-4de5-bed2-70968ad726ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E94EF03B0>]}
[0m23:37:01.984690 [info ] [Thread-3 (]: 5 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:37:01.985732 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.my_second_dbt_model
[0m23:37:01.989211 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:01.989211 [debug] [MainThread]: On master: BEGIN
[0m23:37:01.990209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:02.012769 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m23:37:02.014302 [debug] [MainThread]: On master: COMMIT
[0m23:37:02.015319 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:02.015319 [debug] [MainThread]: On master: COMMIT
[0m23:37:02.017315 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:37:02.018351 [debug] [MainThread]: On master: Close
[0m23:37:02.019799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:02.019799 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:37:02.019799 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:37:02.021297 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_first_dbt_model' was properly closed.
[0m23:37:02.022324 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_customers' was properly closed.
[0m23:37:02.022324 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_second_dbt_model' was properly closed.
[0m23:37:02.022324 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_products' was properly closed.
[0m23:37:02.023339 [info ] [MainThread]: 
[0m23:37:02.024352 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m23:37:02.027354 [debug] [MainThread]: Command end result
[0m23:37:02.064457 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:37:02.070032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:37:02.079037 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:37:02.079037 [info ] [MainThread]: 
[0m23:37:02.080416 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:37:02.081425 [info ] [MainThread]: 
[0m23:37:02.082436 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near "from"
  LINE 18: from source
           ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:37:02.084434 [info ] [MainThread]: 
[0m23:37:02.085433 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:37:02.087449 [debug] [MainThread]: Command `dbt run` failed at 23:37:02.087449 after 4.22 seconds
[0m23:37:02.088450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E91F28F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E8FEFCBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E92B81970>]}
[0m23:37:02.089482 [debug] [MainThread]: Flushing usage events
[0m23:37:02.391370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:21.250634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86C6669F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86CA52E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86CA518E0>]}


============================== 23:38:21.256650 | 396d2ce3-7034-4f45-a4f9-78353a4cfc21 ==============================
[0m23:38:21.256650 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:38:21.257631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:38:21.565684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86DFFD1C0>]}
[0m23:38:21.635502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86A0CDC40>]}
[0m23:38:21.638020 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:38:22.229485 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:38:22.550916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:38:22.551923 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\staging\stg_customers.sql
[0m23:38:23.347662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86E905E50>]}
[0m23:38:23.440348 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:38:23.448081 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:38:23.503988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86E7A8050>]}
[0m23:38:23.504988 [info ] [MainThread]: Found 5 models, 10 data tests, 3 sources, 433 macros
[0m23:38:23.504988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86E65B5C0>]}
[0m23:38:23.507989 [info ] [MainThread]: 
[0m23:38:23.507989 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:23.508986 [info ] [MainThread]: 
[0m23:38:23.509984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:23.516907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:38:24.081415 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:38:24.081415 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:38:24.081415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:24.114484 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m23:38:24.116978 [debug] [ThreadPool]: On list_analytics: Close
[0m23:38:24.118977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:38:24.125985 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:38:24.125985 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:38:24.125985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:24.142646 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m23:38:24.143646 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:38:24.143646 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:38:24.147639 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m23:38:24.148795 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:38:24.149834 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:38:24.156215 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:24.156725 [debug] [MainThread]: On master: BEGIN
[0m23:38:24.156725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:24.174416 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m23:38:24.174416 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:24.175442 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:38:24.180943 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m23:38:24.182956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86E7754C0>]}
[0m23:38:24.182956 [debug] [MainThread]: On master: ROLLBACK
[0m23:38:24.183975 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:24.184953 [debug] [MainThread]: On master: BEGIN
[0m23:38:24.186952 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:38:24.186952 [debug] [MainThread]: On master: COMMIT
[0m23:38:24.186952 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:24.187953 [debug] [MainThread]: On master: COMMIT
[0m23:38:24.188951 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:38:24.188951 [debug] [MainThread]: On master: Close
[0m23:38:24.196014 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.my_first_dbt_model
[0m23:38:24.197016 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_customers
[0m23:38:24.197016 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_orders
[0m23:38:24.198019 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.stg_products
[0m23:38:24.198019 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:38:24.199148 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_customers ............................... [RUN]
[0m23:38:24.200170 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_orders .................................. [RUN]
[0m23:38:24.202158 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.my_first_dbt_model'
[0m23:38:24.201158 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_products ................................ [RUN]
[0m23:38:24.202158 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m23:38:24.203154 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m23:38:24.203154 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.my_first_dbt_model
[0m23:38:24.204156 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m23:38:24.204156 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m23:38:24.205155 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m23:38:24.213260 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:24.214770 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.stg_products
[0m23:38:24.217794 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m23:38:24.222794 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m23:38:24.226793 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m23:38:24.231042 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.my_first_dbt_model
[0m23:38:24.248515 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_customers
[0m23:38:24.253846 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.stg_products
[0m23:38:24.265413 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_orders
[0m23:38:24.344860 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:24.356654 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.stg_customers"
[0m23:38:24.359430 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.stg_orders"
[0m23:38:24.362487 [debug] [Thread-4 (]: Writing runtime sql for node "model.analytics_warehouse.stg_products"
[0m23:38:24.366346 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:38:24.367092 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: BEGIN
[0m23:38:24.367648 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:38:24.368749 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:24.370139 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: BEGIN
[0m23:38:24.370648 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:24.371854 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:38:24.373279 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:24.373875 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: BEGIN
[0m23:38:24.375134 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: BEGIN
[0m23:38:24.375885 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:38:24.376896 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:38:24.397868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m23:38:24.398379 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:38:24.399393 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */

  create view "analytics"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."customers"
)

select
    customer_id,
    lower(first_name) as first_name,
    lower(last_name) as last_name,
    lower(email) as email,
    created_at,
    updated_at
from source;
  );
[0m23:38:24.402397 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: from source;
                    ^

[0m23:38:24.403390 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: ROLLBACK
[0m23:38:24.405392 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: Close
[0m23:38:24.405392 [debug] [Thread-3 (]: SQL status: BEGIN in 0.034 seconds
[0m23:38:24.406901 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:24.407912 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */

  create view "analytics"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."orders"
)

select
    order_id,
    customer_id,
    product_id,
    quantity,
    order_date,
    lower(status) as status
from source
  );
[0m23:38:24.419666 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:38:24.425472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m23:38:24.431948 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:24.433262 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:24.433939 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m23:38:24.434486 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:38:24.435573 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */

  
    

  create  table "analytics"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m23:38:24.436143 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:24.437542 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */

  create view "analytics"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."products"
)

select
    product_id,
    initcap(product_name) as product_name,
    price,
    category,
    created_at
from source
  );
[0m23:38:24.441971 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:38:24.448984 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:24.449983 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m23:38:24.449983 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.013 seconds
[0m23:38:24.450984 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m23:38:24.454008 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:24.463044 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:24.464709 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:38:24.465658 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m23:38:24.466694 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:38:24.472656 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:38:24.473732 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:24.474273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:38:24.491350 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m23:38:24.508836 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:24.503836 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:38:24.509839 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:38:24.510837 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:24.510837 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:38:24.511837 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:38:24.514538 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:38:24.515904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:38:24.516912 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:24.519912 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:38:24.519912 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:38:24.520917 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:38:24.520917 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:24.578678 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."stg_orders__dbt_backup"
[0m23:38:24.579648 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:38:24.586390 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:24.586390 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m23:38:24.588384 [debug] [Thread-2 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near ";"
  LINE 18: from source;
                      ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:38:24.589383 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
drop view if exists "analytics"."public"."stg_orders__dbt_backup" cascade
[0m23:38:24.592410 [debug] [Thread-4 (]: Applying DROP to: "analytics"."public"."stg_products__dbt_backup"
[0m23:38:24.592410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:38:24.594382 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:24.597912 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."my_first_dbt_model__dbt_backup"
[0m23:38:24.599065 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:38:24.599065 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
drop view if exists "analytics"."public"."stg_products__dbt_backup" cascade
[0m23:38:24.603071 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:24.605101 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: Close
[0m23:38:24.606092 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86C363D70>]}
[0m23:38:24.607078 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
drop table if exists "analytics"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:38:24.609073 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B869FEF410>]}
[0m23:38:24.610076 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:38:24.608081 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.39s]
[0m23:38:24.613598 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: Close
[0m23:38:24.611595 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.41s]
[0m23:38:24.615612 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_customers
[0m23:38:24.617329 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_orders
[0m23:38:24.619336 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86E7D3380>]}
[0m23:38:24.619336 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m23:38:24.620333 [debug] [Thread-7 (]: Marking all children of 'model.analytics_warehouse.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near ";"
  LINE 18: from source;
                      ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql.
[0m23:38:24.626331 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: Close
[0m23:38:24.622336 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.41s]
[0m23:38:24.629340 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.stg_products
[0m23:38:24.631848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86E7D2690>]}
[0m23:38:24.633162 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.43s]
[0m23:38:24.635187 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.my_first_dbt_model
[0m23:38:24.636179 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.my_second_dbt_model
[0m23:38:24.637683 [info ] [Thread-2 (]: 5 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:38:24.638695 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_customers, now model.analytics_warehouse.my_second_dbt_model)
[0m23:38:24.639695 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.my_second_dbt_model
[0m23:38:24.645257 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:24.648752 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.my_second_dbt_model
[0m23:38:24.655267 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:24.659276 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:24.660316 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: BEGIN
[0m23:38:24.661277 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:38:24.681971 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m23:38:24.683981 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:24.685001 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */

  create view "analytics"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "analytics"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:38:24.688024 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:38:24.691995 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:24.692995 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
alter table "analytics"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:38:24.693995 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:24.695992 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:38:24.695992 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:24.696991 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:38:24.700200 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:38:24.703211 [debug] [Thread-2 (]: Applying DROP to: "analytics"."public"."my_second_dbt_model__dbt_backup"
[0m23:38:24.703211 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:24.704213 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
drop view if exists "analytics"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:38:24.705209 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:38:24.707209 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: Close
[0m23:38:24.708208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '396d2ce3-7034-4f45-a4f9-78353a4cfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86E76C200>]}
[0m23:38:24.709219 [info ] [Thread-2 (]: 5 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:38:24.710207 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.my_second_dbt_model
[0m23:38:24.711210 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:24.712211 [debug] [MainThread]: On master: BEGIN
[0m23:38:24.712211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:24.733773 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m23:38:24.734773 [debug] [MainThread]: On master: COMMIT
[0m23:38:24.734773 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:24.734773 [debug] [MainThread]: On master: COMMIT
[0m23:38:24.737836 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:38:24.737836 [debug] [MainThread]: On master: Close
[0m23:38:24.739856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:24.739856 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:38:24.739856 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:38:24.741369 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_first_dbt_model' was properly closed.
[0m23:38:24.741369 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_second_dbt_model' was properly closed.
[0m23:38:24.742378 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_orders' was properly closed.
[0m23:38:24.742378 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_products' was properly closed.
[0m23:38:24.743381 [info ] [MainThread]: 
[0m23:38:24.743381 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m23:38:24.745401 [debug] [MainThread]: Command end result
[0m23:38:24.780156 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:38:24.787697 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:38:24.796222 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:38:24.796222 [info ] [MainThread]: 
[0m23:38:24.797750 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:38:24.798759 [info ] [MainThread]: 
[0m23:38:24.799761 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near ";"
  LINE 18: from source;
                      ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:38:24.799761 [info ] [MainThread]: 
[0m23:38:24.800757 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:38:24.801758 [debug] [MainThread]: Command `dbt run` failed at 23:38:24.801758 after 3.85 seconds
[0m23:38:24.802793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86CC1E0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86CDD4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86C399070>]}
[0m23:38:24.803759 [debug] [MainThread]: Flushing usage events
[0m23:38:25.097957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:46.250814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021394D96F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213944DF5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213944DF8C0>]}


============================== 23:38:46.257791 | d73460c2-2e86-4021-bbf2-13883057692d ==============================
[0m23:38:46.257791 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:38:46.257791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:38:46.544798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213960FC4A0>]}
[0m23:38:46.628550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021395053FE0>]}
[0m23:38:46.630762 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:38:47.165658 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:38:47.481251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:38:47.482324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:38:47.531042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002139625AC30>]}
[0m23:38:47.613647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:38:47.620828 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:38:47.676923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002139673A810>]}
[0m23:38:47.677937 [info ] [MainThread]: Found 5 models, 10 data tests, 3 sources, 433 macros
[0m23:38:47.678961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021396694500>]}
[0m23:38:47.680963 [info ] [MainThread]: 
[0m23:38:47.682043 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:47.683186 [info ] [MainThread]: 
[0m23:38:47.683186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:47.690201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:38:48.349928 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:38:48.349928 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:38:48.350927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:48.390185 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.039 seconds
[0m23:38:48.391186 [debug] [ThreadPool]: On list_analytics: Close
[0m23:38:48.393601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:38:48.401151 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:38:48.401151 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:38:48.401151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:48.417660 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m23:38:48.418684 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:38:48.418684 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:38:48.423694 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m23:38:48.425696 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:38:48.425696 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:38:48.433342 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:48.433342 [debug] [MainThread]: On master: BEGIN
[0m23:38:48.433342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:48.466386 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m23:38:48.466386 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:48.467410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:38:48.471393 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m23:38:48.472412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002139673B2F0>]}
[0m23:38:48.473414 [debug] [MainThread]: On master: ROLLBACK
[0m23:38:48.474962 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:48.474962 [debug] [MainThread]: On master: BEGIN
[0m23:38:48.475963 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:38:48.475963 [debug] [MainThread]: On master: COMMIT
[0m23:38:48.477494 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:48.478061 [debug] [MainThread]: On master: COMMIT
[0m23:38:48.479069 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:38:48.479069 [debug] [MainThread]: On master: Close
[0m23:38:48.487593 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.my_first_dbt_model
[0m23:38:48.487593 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_customers
[0m23:38:48.488591 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_orders
[0m23:38:48.489604 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.stg_products
[0m23:38:48.488591 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:38:48.490594 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_customers ............................... [RUN]
[0m23:38:48.491595 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_orders .................................. [RUN]
[0m23:38:48.493600 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.my_first_dbt_model'
[0m23:38:48.491595 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_products ................................ [RUN]
[0m23:38:48.494109 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m23:38:48.495118 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m23:38:48.496119 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.my_first_dbt_model
[0m23:38:48.498640 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m23:38:48.499648 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m23:38:48.499648 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m23:38:48.509725 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.stg_products
[0m23:38:48.511698 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:48.516270 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m23:38:48.521315 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m23:38:48.524706 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m23:38:48.529813 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.my_first_dbt_model
[0m23:38:48.529813 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_orders
[0m23:38:48.529813 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.stg_products
[0m23:38:48.532332 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_customers
[0m23:38:48.625501 [debug] [Thread-4 (]: Writing runtime sql for node "model.analytics_warehouse.stg_products"
[0m23:38:48.629505 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.stg_customers"
[0m23:38:48.616499 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.stg_orders"
[0m23:38:48.635361 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:48.640360 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:38:48.641359 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:48.641359 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:48.642361 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:48.642361 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: BEGIN
[0m23:38:48.642361 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: BEGIN
[0m23:38:48.643356 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: BEGIN
[0m23:38:48.643356 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: BEGIN
[0m23:38:48.644355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:38:48.644355 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:38:48.644355 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:38:48.645356 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:38:48.671538 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m23:38:48.672543 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:38:48.673542 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */

  create view "analytics"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."customers"
)

select
    customer_id,
    lower(first_name) as first_name,
    lower(last_name) as last_name,
    lower(email) as email,
    created_at,
    updated_at
from source;
  );
[0m23:38:48.674048 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m23:38:48.675057 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:48.676411 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */

  create view "analytics"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."products"
)

select
    product_id,
    initcap(product_name) as product_name,
    price,
    category,
    created_at
from source
  );
[0m23:38:48.676963 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: from source;
                    ^

[0m23:38:48.676963 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: ROLLBACK
[0m23:38:48.679893 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: Close
[0m23:38:48.682439 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:38:48.695382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m23:38:48.696383 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:48.696383 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:48.697892 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m23:38:48.697892 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */

  
    

  create  table "analytics"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m23:38:48.700973 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:48.705972 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:48.706977 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.007 seconds
[0m23:38:48.707971 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m23:38:48.719917 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:48.720919 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m23:38:48.721929 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:48.722920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:48.734435 [debug] [Thread-3 (]: SQL status: BEGIN in 0.089 seconds
[0m23:38:48.742437 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:48.752081 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:38:48.752081 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:48.753056 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:38:48.754055 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:48.754055 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */

  create view "analytics"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."orders"
)

select
    order_id,
    customer_id,
    product_id,
    quantity,
    order_date,
    lower(status) as status
from source
  );
[0m23:38:48.755058 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:38:48.756366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:48.760445 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:38:48.760982 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m23:38:48.762103 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:48.773895 [debug] [Thread-4 (]: Applying DROP to: "analytics"."public"."stg_products__dbt_backup"
[0m23:38:48.774435 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m23:38:48.774974 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:38:48.782804 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:38:48.787132 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:48.788221 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
drop view if exists "analytics"."public"."stg_products__dbt_backup" cascade
[0m23:38:48.789387 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:38:48.790950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:38:48.791853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:48.795674 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."my_first_dbt_model__dbt_backup"
[0m23:38:48.796688 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:38:48.800281 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:48.804289 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:38:48.807810 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: Close
[0m23:38:48.808812 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:38:48.809803 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
drop table if exists "analytics"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:38:48.813858 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:38:48.817922 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:38:48.818739 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:48.820169 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:38:48.820867 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:38:48.823490 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: Close
[0m23:38:48.825305 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021396238D70>]}
[0m23:38:48.826498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021396AEB500>]}
[0m23:38:48.828329 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:38:48.827766 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m23:38:48.835080 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."stg_orders__dbt_backup"
[0m23:38:48.829423 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.33s]
[0m23:38:48.836597 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.stg_products
[0m23:38:48.838615 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:38:48.839835 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.my_first_dbt_model
[0m23:38:48.841357 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
drop view if exists "analytics"."public"."stg_orders__dbt_backup" cascade
[0m23:38:48.845362 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.my_second_dbt_model
[0m23:38:48.847668 [info ] [Thread-4 (]: 5 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:38:48.854640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_products, now model.analytics_warehouse.my_second_dbt_model)
[0m23:38:48.855931 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.013 seconds
[0m23:38:48.856945 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.my_second_dbt_model
[0m23:38:48.859948 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: Close
[0m23:38:48.864462 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:48.868122 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021396AB0110>]}
[0m23:38:48.878632 [debug] [Thread-2 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near ";"
  LINE 18: from source;
                      ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:38:48.883743 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021396F617C0>]}
[0m23:38:48.880194 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.37s]
[0m23:38:48.887467 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_orders
[0m23:38:48.885448 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.39s]
[0m23:38:48.889554 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.my_second_dbt_model
[0m23:38:48.890570 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_customers
[0m23:38:48.895512 [debug] [Thread-4 (]: Writing runtime sql for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:48.895512 [debug] [Thread-7 (]: Marking all children of 'model.analytics_warehouse.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near ";"
  LINE 18: from source;
                      ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql.
[0m23:38:48.902144 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:48.903164 [debug] [Thread-4 (]: On model.analytics_warehouse.my_second_dbt_model: BEGIN
[0m23:38:48.904163 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:38:48.934347 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m23:38:48.935351 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:48.936373 [debug] [Thread-4 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */

  create view "analytics"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "analytics"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:38:48.939357 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:38:48.943852 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:48.944405 [debug] [Thread-4 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
alter table "analytics"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:38:48.945411 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:48.947965 [debug] [Thread-4 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:38:48.948974 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:48.949990 [debug] [Thread-4 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:38:48.952989 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m23:38:48.955983 [debug] [Thread-4 (]: Applying DROP to: "analytics"."public"."my_second_dbt_model__dbt_backup"
[0m23:38:48.956983 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:38:48.956983 [debug] [Thread-4 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
drop view if exists "analytics"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:38:48.958984 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:38:48.959984 [debug] [Thread-4 (]: On model.analytics_warehouse.my_second_dbt_model: Close
[0m23:38:48.961990 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73460c2-2e86-4021-bbf2-13883057692d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021397076A50>]}
[0m23:38:48.962988 [info ] [Thread-4 (]: 5 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m23:38:48.962988 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.my_second_dbt_model
[0m23:38:48.965509 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:48.966512 [debug] [MainThread]: On master: BEGIN
[0m23:38:48.966512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:48.986600 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m23:38:48.986600 [debug] [MainThread]: On master: COMMIT
[0m23:38:48.987631 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:48.988643 [debug] [MainThread]: On master: COMMIT
[0m23:38:48.989616 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:38:48.990643 [debug] [MainThread]: On master: Close
[0m23:38:48.991612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:48.993033 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:38:48.993033 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:38:48.994048 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_first_dbt_model' was properly closed.
[0m23:38:48.994048 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_customers' was properly closed.
[0m23:38:48.995041 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_orders' was properly closed.
[0m23:38:48.995041 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_second_dbt_model' was properly closed.
[0m23:38:48.996048 [info ] [MainThread]: 
[0m23:38:48.996048 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m23:38:48.998564 [debug] [MainThread]: Command end result
[0m23:38:49.031240 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:38:49.039025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:38:49.047034 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:38:49.047034 [info ] [MainThread]: 
[0m23:38:49.048038 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:38:49.049298 [info ] [MainThread]: 
[0m23:38:49.050306 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  syntax error at or near ";"
  LINE 18: from source;
                      ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:38:49.051312 [info ] [MainThread]: 
[0m23:38:49.051312 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:38:49.053311 [debug] [MainThread]: Command `dbt run` failed at 23:38:49.052311 after 3.02 seconds
[0m23:38:49.053311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021394DBFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021396B41AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002139447AE40>]}
[0m23:38:49.053311 [debug] [MainThread]: Flushing usage events
[0m23:38:49.366186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:08.883698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047FDCE9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047F8873E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047F884170>]}


============================== 23:39:08.890695 | 8cbbe791-a650-4ad9-9d60-155ccc0d1939 ==============================
[0m23:39:08.890695 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:39:08.891697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:39:09.173672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204011D5730>]}
[0m23:39:09.254201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020401211D30>]}
[0m23:39:09.256206 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:39:09.828829 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:39:10.180349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:39:10.181350 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\staging\stg_customers.sql
[0m23:39:10.707375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204019053A0>]}
[0m23:39:10.794330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:39:10.803865 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:39:10.869434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047FB70230>]}
[0m23:39:10.870441 [info ] [MainThread]: Found 5 models, 10 data tests, 3 sources, 433 macros
[0m23:39:10.870441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204019EBC80>]}
[0m23:39:10.874435 [info ] [MainThread]: 
[0m23:39:10.875431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:39:10.876434 [info ] [MainThread]: 
[0m23:39:10.878814 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:39:10.891965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:39:11.545228 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:39:11.545228 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:39:11.546218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:11.586526 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m23:39:11.587527 [debug] [ThreadPool]: On list_analytics: Close
[0m23:39:11.591533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:39:11.598040 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:39:11.599050 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:39:11.599050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:11.618617 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m23:39:11.619630 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:39:11.619630 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:39:11.623625 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m23:39:11.624627 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:39:11.625626 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:39:11.632212 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:11.632212 [debug] [MainThread]: On master: BEGIN
[0m23:39:11.633245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:11.648731 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m23:39:11.649739 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:11.649739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:39:11.654736 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m23:39:11.655762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040185CEC0>]}
[0m23:39:11.656766 [debug] [MainThread]: On master: ROLLBACK
[0m23:39:11.657736 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:11.657736 [debug] [MainThread]: On master: BEGIN
[0m23:39:11.659739 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:39:11.659739 [debug] [MainThread]: On master: COMMIT
[0m23:39:11.660764 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:11.660764 [debug] [MainThread]: On master: COMMIT
[0m23:39:11.661736 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:39:11.662740 [debug] [MainThread]: On master: Close
[0m23:39:11.670046 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.my_first_dbt_model
[0m23:39:11.671045 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_customers
[0m23:39:11.671045 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_orders
[0m23:39:11.672045 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.stg_products
[0m23:39:11.672045 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:39:11.673046 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_customers ............................... [RUN]
[0m23:39:11.673046 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_orders .................................. [RUN]
[0m23:39:11.675482 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.my_first_dbt_model'
[0m23:39:11.674050 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_products ................................ [RUN]
[0m23:39:11.676495 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m23:39:11.676495 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m23:39:11.677491 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.my_first_dbt_model
[0m23:39:11.681005 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m23:39:11.683019 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m23:39:11.683019 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m23:39:11.694046 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.stg_products
[0m23:39:11.700492 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:11.706471 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m23:39:11.709020 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m23:39:11.712005 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m23:39:11.717514 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_customers
[0m23:39:11.736248 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_orders
[0m23:39:11.762429 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.my_first_dbt_model
[0m23:39:11.789671 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.stg_customers"
[0m23:39:11.791927 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.stg_orders"
[0m23:39:11.797971 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.stg_products
[0m23:39:11.811466 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:11.815579 [debug] [Thread-4 (]: Writing runtime sql for node "model.analytics_warehouse.stg_products"
[0m23:39:11.817556 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:39:11.818067 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:11.818748 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: BEGIN
[0m23:39:11.819758 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: BEGIN
[0m23:39:11.819758 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:39:11.820759 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:11.820759 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:39:11.821758 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:11.821758 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: BEGIN
[0m23:39:11.822758 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: BEGIN
[0m23:39:11.823759 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:39:11.824757 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:39:11.850681 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m23:39:11.851680 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:39:11.852679 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */

  create view "analytics"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."customers"
)

select
    customer_id,
    lower(first_name) as first_name,
    lower(last_name) as last_name,
    lower(email) as email,
    created_at,
    updated_at
from sourceS
  );
[0m23:39:11.855684 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "sources" does not exist
LINE 18: from sourceS
              ^

[0m23:39:11.856679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m23:39:11.856679 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: ROLLBACK
[0m23:39:11.857676 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m23:39:11.858681 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m23:39:11.858681 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:11.859679 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:11.860681 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:11.860681 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: Close
[0m23:39:11.861677 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */

  
    

  create  table "analytics"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m23:39:11.861677 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */

  create view "analytics"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."orders"
)

select
    order_id,
    customer_id,
    product_id,
    quantity,
    order_date,
    lower(status) as status
from source
  );
[0m23:39:11.861677 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */

  create view "analytics"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."products"
)

select
    product_id,
    initcap(product_name) as product_name,
    price,
    category,
    created_at
from source
  );
[0m23:39:11.866513 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m23:39:11.867521 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:39:11.872778 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:39:11.882260 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:11.877743 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:11.885289 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:11.885289 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:39:11.886267 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m23:39:11.887269 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m23:39:11.889275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:11.889275 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:39:11.890273 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:39:11.893282 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:11.896271 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:11.899793 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:11.900791 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:39:11.900791 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m23:39:11.901792 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:39:11.903212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:11.904248 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:39:11.904248 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:39:11.944947 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:39:11.946954 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:39:11.949273 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:39:11.949273 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:11.950271 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:11.951297 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:11.951297 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:39:11.952270 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:39:11.953275 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:39:11.956633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:39:11.957627 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:39:12.016775 [debug] [Thread-4 (]: SQL status: COMMIT in 0.063 seconds
[0m23:39:12.023847 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."my_first_dbt_model__dbt_backup"
[0m23:39:12.026846 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."stg_orders__dbt_backup"
[0m23:39:12.029847 [debug] [Thread-4 (]: Applying DROP to: "analytics"."public"."stg_products__dbt_backup"
[0m23:39:12.036500 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:12.040499 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:12.048004 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:12.049019 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
drop table if exists "analytics"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:39:12.050012 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
drop view if exists "analytics"."public"."stg_orders__dbt_backup" cascade
[0m23:39:12.051014 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
drop view if exists "analytics"."public"."stg_products__dbt_backup" cascade
[0m23:39:12.056019 [debug] [Thread-2 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  relation "sources" does not exist
  LINE 18: from sourceS
                ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:39:12.057015 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:39:12.058015 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:39:12.058015 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m23:39:12.062012 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: Close
[0m23:39:12.063019 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: Close
[0m23:39:12.065863 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: Close
[0m23:39:12.069877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204019AAE10>]}
[0m23:39:12.070876 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047D0BF050>]}
[0m23:39:12.071883 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020401959EE0>]}
[0m23:39:12.073879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020401B36AE0>]}
[0m23:39:12.072879 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.38s]
[0m23:39:12.074877 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.39s]
[0m23:39:12.075874 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.39s]
[0m23:39:12.077873 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_customers
[0m23:39:12.076875 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.39s]
[0m23:39:12.078872 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_orders
[0m23:39:12.079873 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.stg_products
[0m23:39:12.080964 [debug] [Thread-7 (]: Marking all children of 'model.analytics_warehouse.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  relation "sources" does not exist
  LINE 18: from sourceS
                ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql.
[0m23:39:12.082990 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.my_first_dbt_model
[0m23:39:12.085073 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.my_second_dbt_model
[0m23:39:12.086403 [info ] [Thread-2 (]: 5 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:39:12.087415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_customers, now model.analytics_warehouse.my_second_dbt_model)
[0m23:39:12.088431 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.my_second_dbt_model
[0m23:39:12.093973 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:12.099508 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.my_second_dbt_model
[0m23:39:12.107394 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:12.110388 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:12.111395 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: BEGIN
[0m23:39:12.112387 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:12.133503 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m23:39:12.134504 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:12.135502 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */

  create view "analytics"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "analytics"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:39:12.139506 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:39:12.144050 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:12.144050 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
alter table "analytics"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:39:12.146057 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:12.147084 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:39:12.148600 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:12.149613 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:39:12.151609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:39:12.153642 [debug] [Thread-2 (]: Applying DROP to: "analytics"."public"."my_second_dbt_model__dbt_backup"
[0m23:39:12.155752 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:12.155752 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
drop view if exists "analytics"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:39:12.156760 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:39:12.158761 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: Close
[0m23:39:12.159765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cbbe791-a650-4ad9-9d60-155ccc0d1939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204018F3530>]}
[0m23:39:12.160764 [info ] [Thread-2 (]: 5 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:39:12.161760 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.my_second_dbt_model
[0m23:39:12.162783 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:12.164297 [debug] [MainThread]: On master: BEGIN
[0m23:39:12.164297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:12.182194 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m23:39:12.182194 [debug] [MainThread]: On master: COMMIT
[0m23:39:12.183198 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:12.184194 [debug] [MainThread]: On master: COMMIT
[0m23:39:12.185204 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:39:12.186200 [debug] [MainThread]: On master: Close
[0m23:39:12.188198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:12.189215 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:39:12.190203 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:39:12.191202 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_first_dbt_model' was properly closed.
[0m23:39:12.191202 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_second_dbt_model' was properly closed.
[0m23:39:12.191202 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_orders' was properly closed.
[0m23:39:12.191202 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_products' was properly closed.
[0m23:39:12.192198 [info ] [MainThread]: 
[0m23:39:12.193195 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m23:39:12.194195 [debug] [MainThread]: Command end result
[0m23:39:12.225247 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:39:12.231761 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:39:12.242908 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:39:12.243909 [info ] [MainThread]: 
[0m23:39:12.243909 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:39:12.244905 [info ] [MainThread]: 
[0m23:39:12.245907 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  relation "sources" does not exist
  LINE 18: from sourceS
                ^
  compiled code at target\run\analytics_warehouse\models\staging\stg_customers.sql
[0m23:39:12.245907 [info ] [MainThread]: 
[0m23:39:12.246908 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:39:12.248416 [debug] [MainThread]: Command `dbt run` failed at 23:39:12.248416 after 3.60 seconds
[0m23:39:12.249424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047FDCE9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047F762FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002047DA91A00>]}
[0m23:39:12.249424 [debug] [MainThread]: Flushing usage events
[0m23:39:12.628501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:31.074654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E4B1B320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E15E5AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E4A4CA40>]}


============================== 23:39:31.081195 | 6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40 ==============================
[0m23:39:31.081195 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:39:31.082303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:39:31.379604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E6F7B8C0>]}
[0m23:39:31.439678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E7ADC9E0>]}
[0m23:39:31.442202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:39:31.971619 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:39:32.276130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:39:32.277120 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\staging\stg_customers.sql
[0m23:39:32.847072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E92B41D0>]}
[0m23:39:33.042493 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:39:33.057107 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:39:33.157165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E8DCEAE0>]}
[0m23:39:33.157165 [info ] [MainThread]: Found 5 models, 10 data tests, 3 sources, 433 macros
[0m23:39:33.159173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E9001E80>]}
[0m23:39:33.165119 [info ] [MainThread]: 
[0m23:39:33.168934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:39:33.171537 [info ] [MainThread]: 
[0m23:39:33.175304 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:39:33.185905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:39:33.821678 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:39:33.822669 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:39:33.822669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:33.852006 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m23:39:33.859362 [debug] [ThreadPool]: On list_analytics: Close
[0m23:39:33.862361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:39:33.868602 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:39:33.869602 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:39:33.869602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:33.889149 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m23:39:33.890171 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:39:33.890171 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:39:33.893173 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m23:39:33.895150 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:39:33.896148 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:39:33.902879 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:33.902879 [debug] [MainThread]: On master: BEGIN
[0m23:39:33.902879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:33.923723 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m23:39:33.923723 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:33.924726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:39:33.929872 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m23:39:33.931384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E8DCE960>]}
[0m23:39:33.932399 [debug] [MainThread]: On master: ROLLBACK
[0m23:39:33.933400 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:33.933400 [debug] [MainThread]: On master: BEGIN
[0m23:39:33.935826 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:39:33.935826 [debug] [MainThread]: On master: COMMIT
[0m23:39:33.936831 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:33.936831 [debug] [MainThread]: On master: COMMIT
[0m23:39:33.937822 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:39:33.938824 [debug] [MainThread]: On master: Close
[0m23:39:33.947822 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.my_first_dbt_model
[0m23:39:33.947822 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_customers
[0m23:39:33.949268 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_orders
[0m23:39:33.950278 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.stg_products
[0m23:39:33.950278 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:39:33.951277 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_customers ............................... [RUN]
[0m23:39:33.952296 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_orders .................................. [RUN]
[0m23:39:33.954279 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.my_first_dbt_model'
[0m23:39:33.953278 [info ] [Thread-4 (]: 4 of 5 START sql view model public.stg_products ................................ [RUN]
[0m23:39:33.955277 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m23:39:33.956276 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m23:39:33.956276 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.my_first_dbt_model
[0m23:39:33.957293 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m23:39:33.959278 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m23:39:33.959278 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m23:39:33.968720 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.stg_products
[0m23:39:33.974727 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:33.977725 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m23:39:33.984263 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m23:39:33.988836 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m23:39:33.992861 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.my_first_dbt_model
[0m23:39:33.992861 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_customers
[0m23:39:34.011068 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_orders
[0m23:39:34.052528 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:34.059530 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.stg_products
[0m23:39:34.060549 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.stg_customers"
[0m23:39:34.064526 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.stg_orders"
[0m23:39:34.068045 [debug] [Thread-4 (]: Writing runtime sql for node "model.analytics_warehouse.stg_products"
[0m23:39:34.072045 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:34.072045 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: BEGIN
[0m23:39:34.073042 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:39:34.074094 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:39:34.075105 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: BEGIN
[0m23:39:34.075105 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:34.076616 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:34.077317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:39:34.078841 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: BEGIN
[0m23:39:34.079843 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: BEGIN
[0m23:39:34.079843 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:39:34.082367 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:39:34.101553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m23:39:34.102955 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:34.102955 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */

  
    

  create  table "analytics"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m23:39:34.107294 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m23:39:34.108292 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m23:39:34.121447 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:34.121447 [debug] [Thread-4 (]: SQL status: BEGIN in 0.040 seconds
[0m23:39:34.122414 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:39:34.123412 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m23:39:34.124412 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m23:39:34.124412 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:34.125409 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */

  create view "analytics"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."customers"
)

select
    customer_id,
    lower(first_name) as first_name,
    lower(last_name) as last_name,
    lower(email) as email,
    created_at,
    updated_at
from source
  );
[0m23:39:34.125409 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:34.126414 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */

  create view "analytics"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."products"
)

select
    product_id,
    initcap(product_name) as product_name,
    price,
    category,
    created_at
from source
  );
[0m23:39:34.126414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:34.127412 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */

  create view "analytics"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."orders"
)

select
    order_id,
    customer_id,
    product_id,
    quantity,
    order_date,
    lower(status) as status
from source
  );
[0m23:39:34.131361 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:34.132491 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:39:34.132491 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:39:34.133469 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
alter table "analytics"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:39:34.138012 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:34.138012 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:39:34.141037 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:39:34.142010 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m23:39:34.145009 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:34.146013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:39:34.146013 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */
alter table "analytics"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:39:34.146013 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:39:34.152153 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:39:34.164664 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:39:34.168684 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:34.169683 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:39:34.169683 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:39:34.170716 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:34.170716 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m23:39:34.174684 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:34.226689 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: COMMIT
[0m23:39:34.227688 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: COMMIT
[0m23:39:34.227688 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:39:34.228687 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:39:34.228687 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:34.229684 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: COMMIT
[0m23:39:34.232555 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:39:34.232555 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:39:34.233562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:39:34.233562 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:34.236080 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:39:34.236080 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:39:34.243081 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."my_first_dbt_model__dbt_backup"
[0m23:39:34.244077 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:39:34.244077 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:34.246097 [debug] [Thread-2 (]: Applying DROP to: "analytics"."public"."stg_customers__dbt_backup"
[0m23:39:34.252784 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.my_first_dbt_model"
[0m23:39:34.253758 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:39:34.256763 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:39:34.257763 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m23:39:34.257763 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_first_dbt_model"} */
drop table if exists "analytics"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:39:34.258778 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */
drop view if exists "analytics"."public"."stg_customers__dbt_backup" cascade
[0m23:39:34.261760 [debug] [Thread-4 (]: Applying DROP to: "analytics"."public"."stg_products__dbt_backup"
[0m23:39:34.261760 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:39:34.262764 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:39:34.264281 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:39:34.267793 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."stg_orders__dbt_backup"
[0m23:39:34.267793 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m23:39:34.268822 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
drop view if exists "analytics"."public"."stg_products__dbt_backup" cascade
[0m23:39:34.270820 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_customers: Close
[0m23:39:34.271791 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:39:34.272793 [debug] [Thread-1 (]: On model.analytics_warehouse.my_first_dbt_model: Close
[0m23:39:34.273822 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
drop view if exists "analytics"."public"."stg_orders__dbt_backup" cascade
[0m23:39:34.276802 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:39:34.279795 [debug] [Thread-4 (]: On model.analytics_warehouse.stg_products: Close
[0m23:39:34.281306 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:39:34.284535 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_orders: Close
[0m23:39:34.285536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E4C0F500>]}
[0m23:39:34.286543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E9292C90>]}
[0m23:39:34.287546 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E97FE510>]}
[0m23:39:34.287546 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E4D4EAB0>]}
[0m23:39:34.288535 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m23:39:34.289538 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.32s]
[0m23:39:34.290535 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.33s]
[0m23:39:34.292534 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_customers
[0m23:39:34.291533 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.33s]
[0m23:39:34.292534 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.my_first_dbt_model
[0m23:39:34.293538 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_orders
[0m23:39:34.294534 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.stg_products
[0m23:39:34.298062 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.my_second_dbt_model
[0m23:39:34.299076 [info ] [Thread-2 (]: 5 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:39:34.300086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_customers, now model.analytics_warehouse.my_second_dbt_model)
[0m23:39:34.300086 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.my_second_dbt_model
[0m23:39:34.305092 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:34.309107 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.my_second_dbt_model
[0m23:39:34.315964 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:34.319979 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:34.320976 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: BEGIN
[0m23:39:34.322015 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:34.339998 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m23:39:34.340997 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:34.340997 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */

  create view "analytics"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "analytics"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:39:34.343995 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:39:34.346992 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:34.346992 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
alter table "analytics"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:39:34.349514 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:39:34.352543 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:39:34.353548 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:34.353548 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: COMMIT
[0m23:39:34.356538 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:39:34.359563 [debug] [Thread-2 (]: Applying DROP to: "analytics"."public"."my_second_dbt_model__dbt_backup"
[0m23:39:34.359563 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.my_second_dbt_model"
[0m23:39:34.360564 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.my_second_dbt_model"} */
drop view if exists "analytics"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:39:34.361542 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:39:34.363564 [debug] [Thread-2 (]: On model.analytics_warehouse.my_second_dbt_model: Close
[0m23:39:34.365066 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfc6c-39a6-45ac-9cfa-73db2f6bda40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E3DA2930>]}
[0m23:39:34.366089 [info ] [Thread-2 (]: 5 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.06s]
[0m23:39:34.367078 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.my_second_dbt_model
[0m23:39:34.368077 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:34.369104 [debug] [MainThread]: On master: BEGIN
[0m23:39:34.369104 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:34.392772 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m23:39:34.392772 [debug] [MainThread]: On master: COMMIT
[0m23:39:34.393785 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:34.394791 [debug] [MainThread]: On master: COMMIT
[0m23:39:34.396108 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:39:34.397638 [debug] [MainThread]: On master: Close
[0m23:39:34.398214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:34.400465 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:39:34.401231 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:39:34.402541 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_first_dbt_model' was properly closed.
[0m23:39:34.403554 [debug] [MainThread]: Connection 'model.analytics_warehouse.my_second_dbt_model' was properly closed.
[0m23:39:34.403554 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_orders' was properly closed.
[0m23:39:34.404557 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_products' was properly closed.
[0m23:39:34.405108 [info ] [MainThread]: 
[0m23:39:34.406783 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m23:39:34.410329 [debug] [MainThread]: Command end result
[0m23:39:34.481448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:39:34.487177 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:39:34.496939 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:39:34.497940 [info ] [MainThread]: 
[0m23:39:34.498447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:34.499796 [info ] [MainThread]: 
[0m23:39:34.500795 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:39:34.501796 [debug] [MainThread]: Command `dbt run` succeeded at 23:39:34.501796 after 3.65 seconds
[0m23:39:34.502796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E78251F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E70295B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E778DC40>]}
[0m23:39:34.502796 [debug] [MainThread]: Flushing usage events
[0m23:39:34.797654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:17.877496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F76EB67B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F77241820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F77241880>]}


============================== 23:45:17.884052 | 41ec1178-f33f-4b7d-bcd1-e40b659a7c9d ==============================
[0m23:45:17.884052 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:45:17.885055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:18.167525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41ec1178-f33f-4b7d-bcd1-e40b659a7c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F772A2C00>]}
[0m23:45:18.228800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41ec1178-f33f-4b7d-bcd1-e40b659a7c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F76BB21E0>]}
[0m23:45:18.231332 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:45:18.801690 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:45:19.102867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m23:45:19.103869 [debug] [MainThread]: Partial parsing: added file: analytics_warehouse://models\intermediate\int_order_details.sql
[0m23:45:19.103869 [debug] [MainThread]: Partial parsing: added file: analytics_warehouse://models\intermediate\int_customer_orders.sql
[0m23:45:19.389098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41ec1178-f33f-4b7d-bcd1-e40b659a7c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F78A46330>]}
[0m23:45:19.471275 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:45:19.479274 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:45:19.534203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41ec1178-f33f-4b7d-bcd1-e40b659a7c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F79058950>]}
[0m23:45:19.535206 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 433 macros
[0m23:45:19.535206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ec1178-f33f-4b7d-bcd1-e40b659a7c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F790B3B90>]}
[0m23:45:19.537232 [info ] [MainThread]: 
[0m23:45:19.538202 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:19.538202 [info ] [MainThread]: 
[0m23:45:19.539203 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:45:19.546222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:45:20.168422 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:45:20.169421 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:45:20.169421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:20.196457 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m23:45:20.198008 [debug] [ThreadPool]: On list_analytics: Close
[0m23:45:20.202131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:45:20.207736 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:45:20.207736 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:45:20.208739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:20.225662 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m23:45:20.225662 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:45:20.225662 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:45:20.229662 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m23:45:20.232182 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:45:20.233190 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:45:20.239203 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:20.240194 [debug] [MainThread]: On master: BEGIN
[0m23:45:20.240194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:20.256796 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m23:45:20.257796 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:20.257796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:45:20.262827 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m23:45:20.265349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ec1178-f33f-4b7d-bcd1-e40b659a7c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F79474E00>]}
[0m23:45:20.265349 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:20.266358 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:20.267357 [debug] [MainThread]: On master: BEGIN
[0m23:45:20.268356 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:45:20.269360 [debug] [MainThread]: On master: COMMIT
[0m23:45:20.269360 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:20.270379 [debug] [MainThread]: On master: COMMIT
[0m23:45:20.271358 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:45:20.271358 [debug] [MainThread]: On master: Close
[0m23:45:20.278528 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.int_customer_orders
[0m23:45:20.279528 [info ] [Thread-1 (]: 1 of 2 START sql view model public.int_customer_orders ......................... [RUN]
[0m23:45:20.279528 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.int_customer_orders'
[0m23:45:20.281044 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.int_customer_orders
[0m23:45:20.290075 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.int_customer_orders"
[0m23:45:20.294087 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.int_customer_orders
[0m23:45:20.336419 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.int_customer_orders"
[0m23:45:20.340424 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:45:20.340424 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: BEGIN
[0m23:45:20.340424 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:45:20.357956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m23:45:20.357956 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:45:20.358985 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */

  create view "analytics"."public"."int_customer_orders__dbt_tmp"
    
    
  as (
    with customers as (
    select * from "analytics"."public"."stg_customers"
),

orders as (
    select * from "analytics"."public"."stg_orders"
)

select
    o.order_id,
    o.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    o.product_id,
    o.quantity,
    o.status,
    o.order_date
from orders o
left join customers c on o.customer_id = c.customer_id;
  );
[0m23:45:20.359958 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: left join customers c on o.customer_id = c.customer_id;
                                                               ^

[0m23:45:20.360983 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: ROLLBACK
[0m23:45:20.361956 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: Close
[0m23:45:20.379490 [debug] [Thread-1 (]: Database Error in model int_customer_orders (models\intermediate\int_customer_orders.sql)
  syntax error at or near ";"
  LINE 26: left join customers c on o.customer_id = c.customer_id;
                                                                 ^
  compiled code at target\run\analytics_warehouse\models\intermediate\int_customer_orders.sql
[0m23:45:20.384012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41ec1178-f33f-4b7d-bcd1-e40b659a7c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F79446D80>]}
[0m23:45:20.384012 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.int_customer_orders ................ [[31mERROR[0m in 0.10s]
[0m23:45:20.385014 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.int_customer_orders
[0m23:45:20.386009 [debug] [Thread-7 (]: Marking all children of 'model.analytics_warehouse.int_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_customer_orders (models\intermediate\int_customer_orders.sql)
  syntax error at or near ";"
  LINE 26: left join customers c on o.customer_id = c.customer_id;
                                                                 ^
  compiled code at target\run\analytics_warehouse\models\intermediate\int_customer_orders.sql.
[0m23:45:20.387035 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.int_order_details
[0m23:45:20.388026 [info ] [Thread-3 (]: 2 of 2 SKIP relation public.int_order_details .................................. [[33mSKIP[0m]
[0m23:45:20.389006 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.int_order_details
[0m23:45:20.390009 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:20.391030 [debug] [MainThread]: On master: BEGIN
[0m23:45:20.392008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:20.419772 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m23:45:20.420784 [debug] [MainThread]: On master: COMMIT
[0m23:45:20.421794 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:20.421794 [debug] [MainThread]: On master: COMMIT
[0m23:45:20.422772 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:45:20.423776 [debug] [MainThread]: On master: Close
[0m23:45:20.424776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:20.424776 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:45:20.425777 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:45:20.425777 [debug] [MainThread]: Connection 'model.analytics_warehouse.int_customer_orders' was properly closed.
[0m23:45:20.426780 [info ] [MainThread]: 
[0m23:45:20.427769 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m23:45:20.428771 [debug] [MainThread]: Command end result
[0m23:45:20.459937 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:45:20.465456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:45:20.476669 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:45:20.476669 [info ] [MainThread]: 
[0m23:45:20.477666 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:45:20.478666 [info ] [MainThread]: 
[0m23:45:20.478666 [error] [MainThread]:   Database Error in model int_customer_orders (models\intermediate\int_customer_orders.sql)
  syntax error at or near ";"
  LINE 26: left join customers c on o.customer_id = c.customer_id;
                                                                 ^
  compiled code at target\run\analytics_warehouse\models\intermediate\int_customer_orders.sql
[0m23:45:20.479666 [info ] [MainThread]: 
[0m23:45:20.479666 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:45:20.484212 [debug] [MainThread]: Command `dbt run` failed at 23:45:20.483226 after 3.14 seconds
[0m23:45:20.485204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F772A2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F774FC2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F77703FE0>]}
[0m23:45:20.486207 [debug] [MainThread]: Flushing usage events
[0m23:45:20.763923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:54.946749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3989E2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3989E24E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3989E17C0>]}


============================== 23:45:54.956291 | 43794556-c8a3-4f1a-9e2c-fdfe81fbeac3 ==============================
[0m23:45:54.956291 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:45:54.957293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:45:55.243340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43794556-c8a3-4f1a-9e2c-fdfe81fbeac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A398E62D80>]}
[0m23:45:55.304755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43794556-c8a3-4f1a-9e2c-fdfe81fbeac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A398E62ED0>]}
[0m23:45:55.306759 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:45:56.028576 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:45:56.338600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:45:56.339631 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\intermediate\int_customer_orders.sql
[0m23:45:56.339631 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\intermediate\int_order_details.sql
[0m23:45:56.640289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43794556-c8a3-4f1a-9e2c-fdfe81fbeac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A39A7798E0>]}
[0m23:45:56.767410 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:45:56.778154 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:45:56.850728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43794556-c8a3-4f1a-9e2c-fdfe81fbeac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A39A29F050>]}
[0m23:45:56.850728 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 433 macros
[0m23:45:56.851751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43794556-c8a3-4f1a-9e2c-fdfe81fbeac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A39A79DBB0>]}
[0m23:45:56.853730 [info ] [MainThread]: 
[0m23:45:56.854727 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:56.854727 [info ] [MainThread]: 
[0m23:45:56.855728 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:45:56.863228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:45:57.450049 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:45:57.450049 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:45:57.451049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:57.484084 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m23:45:57.485108 [debug] [ThreadPool]: On list_analytics: Close
[0m23:45:57.488509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:45:57.495168 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:45:57.496199 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:45:57.496199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:57.514465 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m23:45:57.515478 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:45:57.515478 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:45:57.520475 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m23:45:57.521474 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:45:57.523476 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:45:57.531008 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:57.532228 [debug] [MainThread]: On master: BEGIN
[0m23:45:57.532228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:57.551384 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m23:45:57.551384 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:57.552388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:45:57.566441 [debug] [MainThread]: SQL status: SELECT 4 in 0.014 seconds
[0m23:45:57.569446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43794556-c8a3-4f1a-9e2c-fdfe81fbeac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A39A776FC0>]}
[0m23:45:57.570446 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:57.571449 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:57.572444 [debug] [MainThread]: On master: BEGIN
[0m23:45:57.574442 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:45:57.575447 [debug] [MainThread]: On master: COMMIT
[0m23:45:57.575447 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:57.576442 [debug] [MainThread]: On master: COMMIT
[0m23:45:57.577443 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:45:57.578447 [debug] [MainThread]: On master: Close
[0m23:45:57.587275 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.int_customer_orders
[0m23:45:57.588275 [info ] [Thread-1 (]: 1 of 2 START sql view model public.int_customer_orders ......................... [RUN]
[0m23:45:57.589277 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.int_customer_orders'
[0m23:45:57.589277 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.int_customer_orders
[0m23:45:57.604516 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.int_customer_orders"
[0m23:45:57.609112 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.int_customer_orders
[0m23:45:57.660681 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.int_customer_orders"
[0m23:45:57.665300 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:45:57.666371 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: BEGIN
[0m23:45:57.667031 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:45:57.692774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m23:45:57.693777 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:45:57.693777 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */

  create view "analytics"."public"."int_customer_orders__dbt_tmp"
    
    
  as (
    with customers as (
    select * from "analytics"."public"."stg_customers"
),

orders as (
    select * from "analytics"."public"."stg_orders"
)

select
    o.order_id,
    o.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    o.product_id,
    o.quantity,
    o.status,
    o.order_date
from orders o
left join customers c on o.customer_id = c.customer_id
  );
[0m23:45:57.705394 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:45:57.711406 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:45:57.712421 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */
alter table "analytics"."public"."int_customer_orders__dbt_tmp" rename to "int_customer_orders"
[0m23:45:57.714395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:45:57.728557 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: COMMIT
[0m23:45:57.729574 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:45:57.729574 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: COMMIT
[0m23:45:57.733093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:45:57.739117 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."int_customer_orders__dbt_backup"
[0m23:45:57.744681 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:45:57.745697 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */
drop view if exists "analytics"."public"."int_customer_orders__dbt_backup" cascade
[0m23:45:57.746661 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:45:57.750203 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: Close
[0m23:45:57.754216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43794556-c8a3-4f1a-9e2c-fdfe81fbeac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A395F2F110>]}
[0m23:45:57.755200 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.int_customer_orders .................... [[32mCREATE VIEW[0m in 0.16s]
[0m23:45:57.756205 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.int_customer_orders
[0m23:45:57.757224 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.int_order_details
[0m23:45:57.758205 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_order_details ........................... [RUN]
[0m23:45:57.759327 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.int_order_details'
[0m23:45:57.760326 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.int_order_details
[0m23:45:57.763329 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.int_order_details"
[0m23:45:57.767878 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.int_order_details
[0m23:45:57.775872 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.int_order_details"
[0m23:45:57.778875 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:45:57.778875 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: BEGIN
[0m23:45:57.780148 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:45:57.808601 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m23:45:57.809620 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:45:57.809620 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_order_details"} */

  create view "analytics"."public"."int_order_details__dbt_tmp"
    
    
  as (
    with orders as (
    select * from "analytics"."public"."int_customer_orders"
),

products as (
    select * from "analytics"."public"."stg_products"
)

select
    o.order_id,
    o.customer_id,
    o.first_name,
    o.last_name,
    p.product_name,
    p.category,
    o.quantity,
    p.price,
    o.quantity * p.price as total_price,
    o.status,
    o.order_date
from orders o
left join products p on o.product_id = p.product_id
  );
[0m23:45:57.819784 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m23:45:57.823171 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:45:57.824179 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_order_details"} */
alter table "analytics"."public"."int_order_details__dbt_tmp" rename to "int_order_details"
[0m23:45:57.826185 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:57.828183 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: COMMIT
[0m23:45:57.828183 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:45:57.828183 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: COMMIT
[0m23:45:57.831711 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:45:57.833740 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."int_order_details__dbt_backup"
[0m23:45:57.834739 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:45:57.835739 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_order_details"} */
drop view if exists "analytics"."public"."int_order_details__dbt_backup" cascade
[0m23:45:57.836737 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:45:57.837763 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: Close
[0m23:45:57.839736 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43794556-c8a3-4f1a-9e2c-fdfe81fbeac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A39AC44E30>]}
[0m23:45:57.839736 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_order_details ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:45:57.841738 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.int_order_details
[0m23:45:57.843741 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:57.843741 [debug] [MainThread]: On master: BEGIN
[0m23:45:57.843741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:57.862649 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m23:45:57.862649 [debug] [MainThread]: On master: COMMIT
[0m23:45:57.863654 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:57.863654 [debug] [MainThread]: On master: COMMIT
[0m23:45:57.865159 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:45:57.866170 [debug] [MainThread]: On master: Close
[0m23:45:57.868185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:57.869183 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:45:57.870187 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:45:57.871207 [debug] [MainThread]: Connection 'model.analytics_warehouse.int_customer_orders' was properly closed.
[0m23:45:57.872226 [debug] [MainThread]: Connection 'model.analytics_warehouse.int_order_details' was properly closed.
[0m23:45:57.874203 [info ] [MainThread]: 
[0m23:45:57.875201 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m23:45:57.877226 [debug] [MainThread]: Command end result
[0m23:45:57.911177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:45:57.916710 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:45:57.926967 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:45:57.926967 [info ] [MainThread]: 
[0m23:45:57.926967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:57.928478 [info ] [MainThread]: 
[0m23:45:57.929036 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:45:57.930044 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:57.930044 after 3.20 seconds
[0m23:45:57.931046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A398579C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3982CD310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A398E44EF0>]}
[0m23:45:57.931558 [debug] [MainThread]: Flushing usage events
[0m23:45:58.165737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:51:31.684294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFEC189610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFEE96BEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFEE968CB0>]}


============================== 23:51:31.692586 | 722f00ad-d2c2-4819-b7a9-b961055a2692 ==============================
[0m23:51:31.692586 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:51:31.693121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select marts', 'send_anonymous_usage_stats': 'True'}
[0m23:51:32.072575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '722f00ad-d2c2-4819-b7a9-b961055a2692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFEEB71580>]}
[0m23:51:32.148353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '722f00ad-d2c2-4819-b7a9-b961055a2692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF039FC50>]}
[0m23:51:32.150452 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:51:32.736627 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:51:32.925384 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:51:32.926384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '722f00ad-d2c2-4819-b7a9-b961055a2692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF0924C80>]}
[0m23:51:34.721235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '722f00ad-d2c2-4819-b7a9-b961055a2692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF0AC0E30>]}
[0m23:51:34.804149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:51:34.812140 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:51:34.882866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '722f00ad-d2c2-4819-b7a9-b961055a2692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF03EAA20>]}
[0m23:51:34.883881 [info ] [MainThread]: Found 9 models, 10 data tests, 3 sources, 433 macros
[0m23:51:34.883881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722f00ad-d2c2-4819-b7a9-b961055a2692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF04C5970>]}
[0m23:51:34.887226 [info ] [MainThread]: 
[0m23:51:34.888230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:34.889229 [info ] [MainThread]: 
[0m23:51:34.890229 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:34.901273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:51:35.497953 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:51:35.498990 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:51:35.498990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:35.589073 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.090 seconds
[0m23:51:35.591390 [debug] [ThreadPool]: On list_analytics: Close
[0m23:51:35.594970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:51:35.603144 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:51:35.604143 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:51:35.604143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:35.626188 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m23:51:35.626188 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:51:35.627197 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:51:35.638587 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m23:51:35.641123 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:51:35.643135 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:51:35.652782 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:35.653783 [debug] [MainThread]: On master: BEGIN
[0m23:51:35.653783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:35.672956 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m23:51:35.672956 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:35.673968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:35.688351 [debug] [MainThread]: SQL status: SELECT 8 in 0.014 seconds
[0m23:51:35.692349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722f00ad-d2c2-4819-b7a9-b961055a2692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF04C5520>]}
[0m23:51:35.692349 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:35.694508 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:35.695505 [debug] [MainThread]: On master: BEGIN
[0m23:51:35.696505 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:51:35.698017 [debug] [MainThread]: On master: COMMIT
[0m23:51:35.699032 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:35.700045 [debug] [MainThread]: On master: COMMIT
[0m23:51:35.701044 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:51:35.702484 [debug] [MainThread]: On master: Close
[0m23:51:35.713495 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.customer_lifetime_value
[0m23:51:35.713495 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m23:51:35.715519 [info ] [Thread-1 (]: 1 of 2 START sql table model public.customer_lifetime_value .................... [RUN]
[0m23:51:35.717652 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.customer_lifetime_value'
[0m23:51:35.716656 [info ] [Thread-2 (]: 2 of 2 START sql table model public.daily_sales_summary ........................ [RUN]
[0m23:51:35.718654 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.customer_lifetime_value
[0m23:51:35.718654 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.daily_sales_summary'
[0m23:51:35.730237 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m23:51:35.741264 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.customer_lifetime_value"
[0m23:51:35.743136 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m23:51:35.753879 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m23:51:35.768232 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.customer_lifetime_value
[0m23:51:35.860437 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.customer_lifetime_value"
[0m23:51:35.860437 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.daily_sales_summary"
[0m23:51:35.864484 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:51:35.865500 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:51:35.865500 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: BEGIN
[0m23:51:35.866513 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: BEGIN
[0m23:51:35.866513 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:51:35.867508 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:51:35.885867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m23:51:35.886872 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m23:51:35.886872 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:51:35.887894 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:51:35.887894 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.customer_lifetime_value"} */

  
    

  create  table "analytics"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    customer_id,
    first_name,
    last_name,
    email,
    count(distinct order_id) as total_orders,
    sum(total_price) as total_revenue,
    min(order_date) as first_order_date,
    max(order_date) as last_order_date
from order_details
group by customer_id, first_name, last_name, email
order by total_revenue desc
  );
  
[0m23:51:35.888894 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */

  
    

  create  table "analytics"."public"."daily_sales_summary__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    order_date,
    category,
    status,
    count(distinct order_id) as total_orders,
    sum(quantity) as total_items_sold,
    sum(total_price) as total_revenue
from order_details
group by order_date, category, status
order by order_date, category
  );
  
[0m23:51:35.891874 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "email" does not exist
LINE 20:     email,
             ^

[0m23:51:35.891874 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: ROLLBACK
[0m23:51:35.893874 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: Close
[0m23:51:35.911408 [debug] [Thread-1 (]: Database Error in model customer_lifetime_value (models\marts\customer_lifetime_value.sql)
  column "email" does not exist
  LINE 20:     email,
               ^
  compiled code at target\run\analytics_warehouse\models\marts\customer_lifetime_value.sql
[0m23:51:35.915616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722f00ad-d2c2-4819-b7a9-b961055a2692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF0A01D30>]}
[0m23:51:35.915616 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.customer_lifetime_value ........... [[31mERROR[0m in 0.19s]
[0m23:51:35.917627 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.customer_lifetime_value
[0m23:51:35.918630 [debug] [Thread-7 (]: Marking all children of 'model.analytics_warehouse.customer_lifetime_value' to be skipped because of status 'error'.  Reason: Database Error in model customer_lifetime_value (models\marts\customer_lifetime_value.sql)
  column "email" does not exist
  LINE 20:     email,
               ^
  compiled code at target\run\analytics_warehouse\models\marts\customer_lifetime_value.sql.
[0m23:51:35.949705 [debug] [Thread-2 (]: SQL status: SELECT 933 in 0.061 seconds
[0m23:51:35.961718 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:51:35.961718 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary__dbt_tmp" rename to "daily_sales_summary"
[0m23:51:35.963696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:35.979292 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m23:51:35.979292 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:51:35.980303 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m23:51:35.985639 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m23:51:35.992669 [debug] [Thread-2 (]: Applying DROP to: "analytics"."public"."daily_sales_summary__dbt_backup"
[0m23:51:35.998754 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:51:35.998754 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
drop table if exists "analytics"."public"."daily_sales_summary__dbt_backup" cascade
[0m23:51:36.000763 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:51:36.004762 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: Close
[0m23:51:36.005764 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722f00ad-d2c2-4819-b7a9-b961055a2692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFEC37F290>]}
[0m23:51:36.008234 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.daily_sales_summary ................... [[32mSELECT 933[0m in 0.29s]
[0m23:51:36.009440 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m23:51:36.011451 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:36.011451 [debug] [MainThread]: On master: BEGIN
[0m23:51:36.011451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:36.031487 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m23:51:36.032500 [debug] [MainThread]: On master: COMMIT
[0m23:51:36.032500 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:36.033497 [debug] [MainThread]: On master: COMMIT
[0m23:51:36.035837 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:51:36.036849 [debug] [MainThread]: On master: Close
[0m23:51:36.038854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:36.038854 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:51:36.038854 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:51:36.040352 [debug] [MainThread]: Connection 'model.analytics_warehouse.customer_lifetime_value' was properly closed.
[0m23:51:36.040352 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m23:51:36.041361 [info ] [MainThread]: 
[0m23:51:36.043088 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m23:51:36.046635 [debug] [MainThread]: Command end result
[0m23:51:36.088996 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:51:36.095356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:51:36.106522 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:51:36.106522 [info ] [MainThread]: 
[0m23:51:36.107531 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:51:36.108534 [info ] [MainThread]: 
[0m23:51:36.109531 [error] [MainThread]:   Database Error in model customer_lifetime_value (models\marts\customer_lifetime_value.sql)
  column "email" does not exist
  LINE 20:     email,
               ^
  compiled code at target\run\analytics_warehouse\models\marts\customer_lifetime_value.sql
[0m23:51:36.110531 [info ] [MainThread]: 
[0m23:51:36.110531 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:51:36.112533 [debug] [MainThread]: Command `dbt run` failed at 23:51:36.112533 after 4.94 seconds
[0m23:51:36.112533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFEEA8E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF086C0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFEF0C1D30>]}
[0m23:51:36.113530 [debug] [MainThread]: Flushing usage events
[0m23:51:36.444555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:25.200915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A019B757F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01CA54CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01CA55850>]}


============================== 23:54:25.207918 | fac5fb3e-8d6c-4323-8fab-4dafa571e8a9 ==============================
[0m23:54:25.207918 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:54:25.208920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m23:54:25.485180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fac5fb3e-8d6c-4323-8fab-4dafa571e8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01CB0BF80>]}
[0m23:54:25.584511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fac5fb3e-8d6c-4323-8fab-4dafa571e8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01C62C6E0>]}
[0m23:54:25.587514 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:54:26.268796 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:54:26.574653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:54:26.575657 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\intermediate\int_order_details.sql
[0m23:54:26.859696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fac5fb3e-8d6c-4323-8fab-4dafa571e8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E379FD0>]}
[0m23:54:26.940439 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:54:26.948982 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:54:27.004890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fac5fb3e-8d6c-4323-8fab-4dafa571e8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E375700>]}
[0m23:54:27.005890 [info ] [MainThread]: Found 9 models, 10 data tests, 3 sources, 433 macros
[0m23:54:27.006889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fac5fb3e-8d6c-4323-8fab-4dafa571e8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E278BF0>]}
[0m23:54:27.007897 [info ] [MainThread]: 
[0m23:54:27.008892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:27.008892 [info ] [MainThread]: 
[0m23:54:27.010399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:54:27.018613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:54:27.616661 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:54:27.616661 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:54:27.617664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:27.654325 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.037 seconds
[0m23:54:27.656321 [debug] [ThreadPool]: On list_analytics: Close
[0m23:54:27.660326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:54:27.666702 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:54:27.666702 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:54:27.666702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:27.684605 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m23:54:27.684605 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:54:27.685612 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:54:27.690605 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m23:54:27.691607 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:54:27.692605 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:54:27.700749 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:27.700749 [debug] [MainThread]: On master: BEGIN
[0m23:54:27.701752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:27.718572 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m23:54:27.718572 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:27.719581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:54:27.724574 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m23:54:27.726595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fac5fb3e-8d6c-4323-8fab-4dafa571e8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E7612B0>]}
[0m23:54:27.727603 [debug] [MainThread]: On master: ROLLBACK
[0m23:54:27.728113 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:27.729119 [debug] [MainThread]: On master: BEGIN
[0m23:54:27.730119 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:54:27.731119 [debug] [MainThread]: On master: COMMIT
[0m23:54:27.731119 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:27.731119 [debug] [MainThread]: On master: COMMIT
[0m23:54:27.733280 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:54:27.733280 [debug] [MainThread]: On master: Close
[0m23:54:27.740279 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.int_customer_orders
[0m23:54:27.741302 [info ] [Thread-1 (]: 1 of 2 START sql view model public.int_customer_orders ......................... [RUN]
[0m23:54:27.742283 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.int_customer_orders'
[0m23:54:27.742283 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.int_customer_orders
[0m23:54:27.753833 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.int_customer_orders"
[0m23:54:27.757844 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.int_customer_orders
[0m23:54:27.797802 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.int_customer_orders"
[0m23:54:27.801102 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:54:27.801102 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: BEGIN
[0m23:54:27.802132 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:54:27.820154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m23:54:27.821174 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:54:27.821174 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */

  create view "analytics"."public"."int_customer_orders__dbt_tmp"
    
    
  as (
    with customers as (
    select * from "analytics"."public"."stg_customers"
),

orders as (
    select * from "analytics"."public"."stg_orders"
)

select
    o.order_id,
    o.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    o.product_id,
    o.quantity,
    o.status,
    o.order_date
from orders o
left join customers c on o.customer_id = c.customer_id
  );
[0m23:54:27.832240 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:54:27.839408 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:54:27.839408 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */
alter table "analytics"."public"."int_customer_orders" rename to "int_customer_orders__dbt_backup"
[0m23:54:27.842375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:54:27.846376 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:54:27.846376 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */
alter table "analytics"."public"."int_customer_orders__dbt_tmp" rename to "int_customer_orders"
[0m23:54:27.848735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:27.866310 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: COMMIT
[0m23:54:27.866310 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:54:27.867323 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: COMMIT
[0m23:54:27.870306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:54:27.878812 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."int_customer_orders__dbt_backup"
[0m23:54:27.889534 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:54:27.889534 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */
drop view if exists "analytics"."public"."int_customer_orders__dbt_backup" cascade
[0m23:54:27.898051 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:54:27.902376 [debug] [Thread-1 (]: On model.analytics_warehouse.int_customer_orders: Close
[0m23:54:27.907378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac5fb3e-8d6c-4323-8fab-4dafa571e8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E73CFB0>]}
[0m23:54:27.908391 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.int_customer_orders .................... [[32mCREATE VIEW[0m in 0.16s]
[0m23:54:27.909377 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.int_customer_orders
[0m23:54:27.910375 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.int_order_details
[0m23:54:27.911386 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_order_details ........................... [RUN]
[0m23:54:27.912380 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.int_order_details'
[0m23:54:27.913382 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.int_order_details
[0m23:54:27.923219 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.int_order_details"
[0m23:54:27.928703 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.int_order_details
[0m23:54:27.936228 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.int_order_details"
[0m23:54:27.939238 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:54:27.940244 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: BEGIN
[0m23:54:27.941233 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:54:27.966069 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m23:54:27.966069 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:54:27.967078 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_order_details"} */

  create view "analytics"."public"."int_order_details__dbt_tmp"
    
    
  as (
    with orders as (
    select * from "analytics"."public"."int_customer_orders"
),

products as (
    select * from "analytics"."public"."stg_products"
)

select
    o.order_id,
    o.customer_id,
    o.first_name,
    o.last_name,
    o.email,
    p.product_name,
    p.category,
    o.quantity,
    p.price,
    o.quantity * p.price as total_price,
    o.status,
    o.order_date
from orders o
left join products p on o.product_id = p.product_id
  );
[0m23:54:27.972076 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:54:27.975079 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:54:27.976077 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_order_details"} */
alter table "analytics"."public"."int_order_details__dbt_tmp" rename to "int_order_details"
[0m23:54:27.978081 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:27.979918 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: COMMIT
[0m23:54:27.979918 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:54:27.980635 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: COMMIT
[0m23:54:27.984036 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:54:27.987282 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."int_order_details__dbt_backup"
[0m23:54:27.988362 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:54:27.988907 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_order_details"} */
drop view if exists "analytics"."public"."int_order_details__dbt_backup" cascade
[0m23:54:27.990550 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:54:27.992716 [debug] [Thread-3 (]: On model.analytics_warehouse.int_order_details: Close
[0m23:54:27.994262 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac5fb3e-8d6c-4323-8fab-4dafa571e8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E7FABA0>]}
[0m23:54:27.995085 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_order_details ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:54:27.996768 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.int_order_details
[0m23:54:27.999246 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:27.999755 [debug] [MainThread]: On master: BEGIN
[0m23:54:28.000354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:28.029342 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m23:54:28.029911 [debug] [MainThread]: On master: COMMIT
[0m23:54:28.030974 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:28.030974 [debug] [MainThread]: On master: COMMIT
[0m23:54:28.033183 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:54:28.033183 [debug] [MainThread]: On master: Close
[0m23:54:28.034197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:28.035413 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:54:28.035413 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:54:28.036431 [debug] [MainThread]: Connection 'model.analytics_warehouse.int_customer_orders' was properly closed.
[0m23:54:28.036431 [debug] [MainThread]: Connection 'model.analytics_warehouse.int_order_details' was properly closed.
[0m23:54:28.037425 [info ] [MainThread]: 
[0m23:54:28.038566 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m23:54:28.039650 [debug] [MainThread]: Command end result
[0m23:54:28.083160 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:54:28.090476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:54:28.098005 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:54:28.099015 [info ] [MainThread]: 
[0m23:54:28.100041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:28.101056 [info ] [MainThread]: 
[0m23:54:28.102051 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:54:28.104100 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:28.104100 after 3.35 seconds
[0m23:54:28.104100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A019B757F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01BFBE480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01BFBD5B0>]}
[0m23:54:28.105130 [debug] [MainThread]: Flushing usage events
[0m23:54:28.341413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:49.394809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7A83CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7CD5CB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7CD5D790>]}


============================== 23:54:49.400971 | 4013cd97-8c92-49ce-a287-f119c4c622b5 ==============================
[0m23:54:49.400971 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:54:49.401983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:54:49.702963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4013cd97-8c92-49ce-a287-f119c4c622b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7E9B7200>]}
[0m23:54:49.764286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4013cd97-8c92-49ce-a287-f119c4c622b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7D3D7E90>]}
[0m23:54:49.766664 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:54:50.387166 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:54:50.864273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:50.867423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:50.926800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4013cd97-8c92-49ce-a287-f119c4c622b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7EA53D10>]}
[0m23:54:51.029611 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:54:51.041178 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:54:51.104484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4013cd97-8c92-49ce-a287-f119c4c622b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7EB260F0>]}
[0m23:54:51.105482 [info ] [MainThread]: Found 9 models, 10 data tests, 3 sources, 433 macros
[0m23:54:51.106459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4013cd97-8c92-49ce-a287-f119c4c622b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7EF47470>]}
[0m23:54:51.108486 [info ] [MainThread]: 
[0m23:54:51.108486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:51.109457 [info ] [MainThread]: 
[0m23:54:51.110460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:54:51.119010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:54:52.144650 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:54:52.145638 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:54:52.146687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:52.198043 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.051 seconds
[0m23:54:52.200595 [debug] [ThreadPool]: On list_analytics: Close
[0m23:54:52.204566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:54:52.211196 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:54:52.211196 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:54:52.212192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:52.230359 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m23:54:52.231379 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:54:52.232905 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:54:52.237917 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m23:54:52.238918 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:54:52.239919 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:54:52.250042 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:52.250042 [debug] [MainThread]: On master: BEGIN
[0m23:54:52.251063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:52.273902 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m23:54:52.274457 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:52.274457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:54:52.279000 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m23:54:52.285560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4013cd97-8c92-49ce-a287-f119c4c622b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7EAA8290>]}
[0m23:54:52.286564 [debug] [MainThread]: On master: ROLLBACK
[0m23:54:52.288846 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:52.288846 [debug] [MainThread]: On master: BEGIN
[0m23:54:52.291859 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:54:52.292856 [debug] [MainThread]: On master: COMMIT
[0m23:54:52.292856 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:52.293859 [debug] [MainThread]: On master: COMMIT
[0m23:54:52.295859 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:54:52.296860 [debug] [MainThread]: On master: Close
[0m23:54:52.317263 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.customer_lifetime_value
[0m23:54:52.319288 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m23:54:52.322324 [info ] [Thread-1 (]: 1 of 2 START sql table model public.customer_lifetime_value .................... [RUN]
[0m23:54:52.326297 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.customer_lifetime_value'
[0m23:54:52.327287 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.customer_lifetime_value
[0m23:54:52.324293 [info ] [Thread-2 (]: 2 of 2 START sql table model public.daily_sales_summary ........................ [RUN]
[0m23:54:52.334860 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.daily_sales_summary'
[0m23:54:52.341627 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m23:54:52.347773 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.customer_lifetime_value"
[0m23:54:52.357874 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m23:54:52.368818 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.customer_lifetime_value
[0m23:54:52.385258 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m23:54:52.549193 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.daily_sales_summary"
[0m23:54:52.553195 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.customer_lifetime_value"
[0m23:54:52.558885 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:54:52.558885 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: BEGIN
[0m23:54:52.559898 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:54:52.560950 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:54:52.560950 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: BEGIN
[0m23:54:52.563508 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:54:52.595422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m23:54:52.596471 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:54:52.597360 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.customer_lifetime_value"} */

  
    

  create  table "analytics"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    customer_id,
    first_name,
    last_name,
    email,
    count(distinct order_id) as total_orders,
    sum(total_price) as total_revenue,
    min(order_date) as first_order_date,
    max(order_date) as last_order_date
from order_details
group by customer_id, first_name, last_name, email
order by total_revenue desc
  );
  
[0m23:54:52.602196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.038 seconds
[0m23:54:52.603192 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:54:52.604186 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */

  
    

  create  table "analytics"."public"."daily_sales_summary__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    order_date,
    category,
    status,
    count(distinct order_id) as total_orders,
    sum(quantity) as total_items_sold,
    sum(total_price) as total_revenue
from order_details
group by order_date, category, status
order by order_date, category
  );
  
[0m23:54:52.642029 [debug] [Thread-1 (]: SQL status: SELECT 436 in 0.041 seconds
[0m23:54:52.650000 [debug] [Thread-2 (]: SQL status: SELECT 933 in 0.045 seconds
[0m23:54:52.673429 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:54:52.674534 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:54:52.675545 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.customer_lifetime_value"} */
alter table "analytics"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m23:54:52.676255 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary" rename to "daily_sales_summary__dbt_backup"
[0m23:54:52.678952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:54:52.680260 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:54:52.709123 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:54:52.710126 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary__dbt_tmp" rename to "daily_sales_summary"
[0m23:54:52.723941 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m23:54:52.722918 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: COMMIT
[0m23:54:52.731612 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m23:54:52.733634 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:54:52.735654 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: COMMIT
[0m23:54:52.734647 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:54:52.737647 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m23:54:52.740645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:54:52.748779 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m23:54:52.762901 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."customer_lifetime_value__dbt_backup"
[0m23:54:52.763895 [debug] [Thread-2 (]: Applying DROP to: "analytics"."public"."daily_sales_summary__dbt_backup"
[0m23:54:52.778873 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:54:52.785401 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
drop table if exists "analytics"."public"."daily_sales_summary__dbt_backup" cascade
[0m23:54:52.784405 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:54:52.787416 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.customer_lifetime_value"} */
drop table if exists "analytics"."public"."customer_lifetime_value__dbt_backup" cascade
[0m23:54:52.790418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:54:52.794419 [debug] [Thread-1 (]: On model.analytics_warehouse.customer_lifetime_value: Close
[0m23:54:52.805204 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.018 seconds
[0m23:54:52.808208 [debug] [Thread-2 (]: On model.analytics_warehouse.daily_sales_summary: Close
[0m23:54:52.808208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4013cd97-8c92-49ce-a287-f119c4c622b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7AA5F230>]}
[0m23:54:52.810205 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4013cd97-8c92-49ce-a287-f119c4c622b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7F8CBD40>]}
[0m23:54:52.811204 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 436[0m in 0.47s]
[0m23:54:52.819775 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.customer_lifetime_value
[0m23:54:52.812205 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.daily_sales_summary ................... [[32mSELECT 933[0m in 0.47s]
[0m23:54:52.822791 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m23:54:52.825198 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:52.826211 [debug] [MainThread]: On master: BEGIN
[0m23:54:52.827207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:52.863492 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:54:52.865018 [debug] [MainThread]: On master: COMMIT
[0m23:54:52.867107 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:52.868049 [debug] [MainThread]: On master: COMMIT
[0m23:54:52.873676 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m23:54:52.874686 [debug] [MainThread]: On master: Close
[0m23:54:52.875290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:52.876306 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:54:52.877603 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:54:52.877603 [debug] [MainThread]: Connection 'model.analytics_warehouse.customer_lifetime_value' was properly closed.
[0m23:54:52.878623 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m23:54:52.879202 [info ] [MainThread]: 
[0m23:54:52.881729 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m23:54:52.885759 [debug] [MainThread]: Command end result
[0m23:54:52.959919 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:54:52.972727 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:54:52.991341 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:54:52.992040 [info ] [MainThread]: 
[0m23:54:52.994166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:52.995925 [info ] [MainThread]: 
[0m23:54:52.997085 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:54:53.002953 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:53.002099 after 3.85 seconds
[0m23:54:53.004085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7EC9FAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7B41DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7D24F530>]}
[0m23:54:53.004634 [debug] [MainThread]: Flushing usage events
[0m23:54:53.268543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:57.048985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B048169F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0426F8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0426D9A0>]}


============================== 23:57:57.056010 | 38d4b518-cadc-44f5-8c8c-66257d1ac0a3 ==============================
[0m23:57:57.056010 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:57:57.056010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:57:57.345694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38d4b518-cadc-44f5-8c8c-66257d1ac0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04E66F30>]}
[0m23:57:57.407691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38d4b518-cadc-44f5-8c8c-66257d1ac0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B048F6BA0>]}
[0m23:57:57.409732 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:57:57.983197 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:57:58.286433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:57:58.287433 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\src\schema.yml
[0m23:57:58.558931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38d4b518-cadc-44f5-8c8c-66257d1ac0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B066F6D80>]}
[0m23:57:58.642495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:57:58.650025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:57:58.729509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38d4b518-cadc-44f5-8c8c-66257d1ac0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B066F5F70>]}
[0m23:57:58.729509 [info ] [MainThread]: Found 9 models, 15 data tests, 3 sources, 433 macros
[0m23:57:58.731019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38d4b518-cadc-44f5-8c8c-66257d1ac0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B05FC0770>]}
[0m23:57:58.734070 [info ] [MainThread]: 
[0m23:57:58.735042 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:57:58.735042 [info ] [MainThread]: 
[0m23:57:58.736038 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:58.744052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:57:59.406613 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:57:59.406613 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:57:59.407611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:59.434258 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m23:57:59.435263 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:57:59.435263 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:57:59.439261 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m23:57:59.441255 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:57:59.442262 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:57:59.449802 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:59.450803 [debug] [MainThread]: On master: BEGIN
[0m23:57:59.450803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:59.467452 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m23:57:59.467452 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:59.468471 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:57:59.474986 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m23:57:59.477967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38d4b518-cadc-44f5-8c8c-66257d1ac0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B05F5D2B0>]}
[0m23:57:59.477967 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:59.479958 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:59.479958 [debug] [MainThread]: On master: BEGIN
[0m23:57:59.482067 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:57:59.482067 [debug] [MainThread]: On master: COMMIT
[0m23:57:59.483105 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:59.483105 [debug] [MainThread]: On master: COMMIT
[0m23:57:59.484078 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:57:59.485083 [debug] [MainThread]: On master: Close
[0m23:57:59.492075 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m23:57:59.493079 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897
[0m23:57:59.493079 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m23:57:59.494077 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m23:57:59.493079 [info ] [Thread-1 (]: 1 of 15 START test not_null_customer_lifetime_value_customer_id ................ [RUN]
[0m23:57:59.495079 [info ] [Thread-2 (]: 2 of 15 START test not_null_customer_lifetime_value_total_revenue .............. [RUN]
[0m23:57:59.495079 [info ] [Thread-3 (]: 3 of 15 START test not_null_daily_sales_summary_order_date ..................... [RUN]
[0m23:57:59.496074 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a'
[0m23:57:59.496074 [info ] [Thread-4 (]: 4 of 15 START test not_null_daily_sales_summary_total_revenue .................. [RUN]
[0m23:57:59.497079 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897'
[0m23:57:59.498078 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2'
[0m23:57:59.498078 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m23:57:59.499178 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf'
[0m23:57:59.500156 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897
[0m23:57:59.500156 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m23:57:59.519375 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m23:57:59.528384 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m23:57:59.534925 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"
[0m23:57:59.539918 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"
[0m23:57:59.544919 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"
[0m23:57:59.552530 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897
[0m23:57:59.568311 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m23:57:59.572869 [debug] [Thread-2 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"
[0m23:57:59.573875 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m23:57:59.576877 [debug] [Thread-3 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"
[0m23:57:59.579878 [debug] [Thread-4 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"
[0m23:57:59.581385 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m23:57:59.585519 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m23:57:59.590866 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"
[0m23:57:59.591862 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2: BEGIN
[0m23:57:59.592863 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:57:59.593860 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m23:57:59.594866 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a: BEGIN
[0m23:57:59.595865 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"
[0m23:57:59.599390 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf: BEGIN
[0m23:57:59.598375 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:57:59.600399 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:57:59.596864 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"
[0m23:57:59.603832 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897: BEGIN
[0m23:57:59.604852 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:57:59.619002 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m23:57:59.620000 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"
[0m23:57:59.620999 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "analytics"."public"."daily_sales_summary"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m23:57:59.626080 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:57:59.633631 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2: ROLLBACK
[0m23:57:59.635854 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2: Close
[0m23:57:59.635854 [debug] [Thread-4 (]: SQL status: BEGIN in 0.036 seconds
[0m23:57:59.636870 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"
[0m23:57:59.640115 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "analytics"."public"."daily_sales_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m23:57:59.639005 [info ] [Thread-3 (]: 3 of 15 PASS not_null_daily_sales_summary_order_date ........................... [[32mPASS[0m in 0.14s]
[0m23:57:59.643474 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m23:57:59.643474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m23:57:59.644851 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:57:59.645866 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m23:57:59.646890 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:57:59.648915 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "analytics"."public"."customer_lifetime_value"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m23:57:59.652080 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf: ROLLBACK
[0m23:57:59.647901 [info ] [Thread-3 (]: 5 of 15 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m23:57:59.653087 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2, now test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710)
[0m23:57:59.654090 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf: Close
[0m23:57:59.654090 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:57:59.663089 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:57:59.664598 [debug] [Thread-2 (]: SQL status: BEGIN in 0.060 seconds
[0m23:57:59.665609 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:57:59.661089 [info ] [Thread-4 (]: 4 of 15 PASS not_null_daily_sales_summary_total_revenue ........................ [[32mPASS[0m in 0.16s]
[0m23:57:59.666609 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"
[0m23:57:59.670614 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a: ROLLBACK
[0m23:57:59.671616 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m23:57:59.673131 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "analytics"."public"."customer_lifetime_value"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m23:57:59.676155 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778
[0m23:57:59.677156 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a: Close
[0m23:57:59.680154 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:57:59.683683 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897: ROLLBACK
[0m23:57:59.686683 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:57:59.693949 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897: Close
[0m23:57:59.680154 [info ] [Thread-4 (]: 6 of 15 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m23:57:59.695947 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf, now test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778)
[0m23:57:59.685684 [info ] [Thread-1 (]: 1 of 15 PASS not_null_customer_lifetime_value_customer_id ...................... [[32mPASS[0m in 0.19s]
[0m23:57:59.692951 [debug] [Thread-3 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:57:59.699465 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778
[0m23:57:59.700940 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m23:57:59.696947 [info ] [Thread-2 (]: 2 of 15 PASS not_null_customer_lifetime_value_total_revenue .................... [[32mPASS[0m in 0.20s]
[0m23:57:59.710019 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778"
[0m23:57:59.711260 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:57:59.712274 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897
[0m23:57:59.714784 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:59.713273 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m23:57:59.716810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a, now test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m23:57:59.719016 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:57:59.715796 [info ] [Thread-2 (]: 8 of 15 START test not_null_stg_orders_order_id ................................ [RUN]
[0m23:57:59.728044 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:57:59.729041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897, now test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64)
[0m23:57:59.730195 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778
[0m23:57:59.732220 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:59.741545 [debug] [Thread-4 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778"
[0m23:57:59.747877 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:57:59.749376 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:57:59.751174 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m23:57:59.753322 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:57:59.755341 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:57:59.761221 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:57:59.763218 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778"
[0m23:57:59.763218 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m23:57:59.765742 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:57:59.766745 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:59.771498 [debug] [Thread-2 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:57:59.774022 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:57:59.775024 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m23:57:59.776023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:59.777392 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:57:59.779410 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:57:59.780650 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:57:59.782194 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m23:57:59.783695 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:57:59.784710 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "analytics"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:57:59.802692 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:57:59.804685 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m23:57:59.807813 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:57:59.811919 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m23:57:59.812925 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778"
[0m23:57:59.814435 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "analytics"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:57:59.816456 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:57:59.819460 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m23:57:59.808878 [error] [Thread-3 (]: 5 of 15 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.16s]
[0m23:57:59.821480 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:57:59.822493 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778: Close
[0m23:57:59.822493 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m23:57:59.828670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m23:57:59.829680 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:57:59.831200 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "analytics"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m23:57:59.824489 [info ] [Thread-4 (]: 6 of 15 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.13s]
[0m23:57:59.837745 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778
[0m23:57:59.825495 [info ] [Thread-3 (]: 9 of 15 START test not_null_stg_products_product_id ............................ [RUN]
[0m23:57:59.838758 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:57:59.840047 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m23:57:59.842066 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_my_first_dbt_model_id.5fb22c2710, now test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3)
[0m23:57:59.845059 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m23:57:59.847061 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m23:57:59.856111 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m23:57:59.858110 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m23:57:59.862605 [debug] [Thread-2 (]: SQL status: BEGIN in 0.083 seconds
[0m23:57:59.863603 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:57:59.865125 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "analytics"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m23:57:59.870393 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:57:59.846061 [info ] [Thread-4 (]: 10 of 15 START test unique_customer_lifetime_value_customer_id ................. [RUN]
[0m23:57:59.873865 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m23:57:59.874877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_my_second_dbt_model_id.151b76d778, now test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9)
[0m23:57:59.876749 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m23:57:59.877896 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m23:57:59.878913 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m23:57:59.859110 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.14s]
[0m23:57:59.897006 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m23:57:59.899035 [debug] [Thread-3 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m23:57:59.901032 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:57:59.902544 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321
[0m23:57:59.898020 [info ] [Thread-2 (]: 8 of 15 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.17s]
[0m23:57:59.906282 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:59.906813 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493
[0m23:57:59.907805 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m23:57:59.904457 [info ] [Thread-1 (]: 11 of 15 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m23:57:59.909627 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m23:57:59.909049 [info ] [Thread-2 (]: 12 of 15 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m23:57:59.910861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321)
[0m23:57:59.911949 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:57:59.911949 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m23:57:59.913423 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64, now test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493)
[0m23:57:59.913962 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321
[0m23:57:59.923548 [debug] [Thread-4 (]: Writing runtime sql for node "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m23:57:59.924547 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493
[0m23:57:59.932121 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321"
[0m23:57:59.942775 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493"
[0m23:57:59.943787 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m23:57:59.945049 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9: BEGIN
[0m23:57:59.946062 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:57:59.947062 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m23:57:59.948573 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m23:57:59.949585 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "analytics"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m23:57:59.954982 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:57:59.957969 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m23:57:59.960293 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3: Close
[0m23:57:59.961298 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321
[0m23:57:59.967467 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321"
[0m23:57:59.971472 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493
[0m23:57:59.962467 [info ] [Thread-3 (]: 9 of 15 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.12s]
[0m23:57:59.977116 [debug] [Thread-2 (]: Writing runtime sql for node "test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493"
[0m23:57:59.978165 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m23:57:59.979178 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m23:57:59.980175 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321"
[0m23:57:59.982701 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m23:57:59.983714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:59.981687 [info ] [Thread-3 (]: 13 of 15 START test unique_stg_customers_customer_id ........................... [RUN]
[0m23:57:59.986719 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3, now test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada)
[0m23:57:59.987768 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m23:58:00.003373 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m23:58:00.006970 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m23:58:00.007561 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m23:58:00.009575 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493"
[0m23:58:00.010585 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "analytics"."public"."customer_lifetime_value"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:58:00.011581 [debug] [Thread-2 (]: On test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m23:58:00.013578 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:58:00.020555 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:58:00.022159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:58:00.025708 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9: ROLLBACK
[0m23:58:00.026637 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m23:58:00.027175 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321"
[0m23:58:00.099632 [debug] [Thread-3 (]: Writing runtime sql for node "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m23:58:00.100638 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9: Close
[0m23:58:00.100638 [debug] [Thread-2 (]: SQL status: BEGIN in 0.088 seconds
[0m23:58:00.101641 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "analytics"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:58:00.102640 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493"
[0m23:58:00.104798 [debug] [Thread-2 (]: On test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "analytics"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:58:00.103646 [info ] [Thread-4 (]: 10 of 15 PASS unique_customer_lifetime_value_customer_id ....................... [[32mPASS[0m in 0.23s]
[0m23:58:00.107283 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:58:00.107283 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m23:58:00.109296 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m23:58:00.110293 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:58:00.111296 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m23:58:00.112298 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m23:58:00.114316 [debug] [Thread-2 (]: On test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m23:58:00.114316 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:58:00.116442 [debug] [Thread-3 (]: On test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m23:58:00.115430 [info ] [Thread-4 (]: 14 of 15 START test unique_stg_orders_order_id ................................. [RUN]
[0m23:58:00.119438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:58:00.121453 [debug] [Thread-2 (]: On test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m23:58:00.124452 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9, now test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a)
[0m23:58:00.122449 [info ] [Thread-1 (]: 11 of 15 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.21s]
[0m23:58:00.125450 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m23:58:00.128454 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321
[0m23:58:00.126453 [info ] [Thread-2 (]: 12 of 15 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.21s]
[0m23:58:00.137302 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m23:58:00.141705 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m23:58:00.143694 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493
[0m23:58:00.143694 [info ] [Thread-1 (]: 15 of 15 START test unique_stg_products_product_id ............................. [RUN]
[0m23:58:00.146691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_my_first_dbt_model_id.16e066b321, now test.analytics_warehouse.unique_stg_products_product_id.7d950a1467)
[0m23:58:00.147693 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m23:58:00.158790 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m23:58:00.160306 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m23:58:00.161631 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m23:58:00.165152 [debug] [Thread-4 (]: Writing runtime sql for node "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m23:58:00.166166 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m23:58:00.167163 [debug] [Thread-3 (]: On test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:58:00.169965 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m23:58:00.173992 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m23:58:00.175439 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:58:00.177432 [debug] [Thread-3 (]: On test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m23:58:00.178426 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m23:58:00.178426 [debug] [Thread-3 (]: On test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada: Close
[0m23:58:00.179760 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:58:00.179760 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:58:00.185308 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m23:58:00.186303 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_stg_products_product_id.7d950a1467: BEGIN
[0m23:58:00.183302 [info ] [Thread-3 (]: 13 of 15 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.20s]
[0m23:58:00.187304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:00.190477 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m23:58:00.211133 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m23:58:00.212138 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m23:58:00.212138 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:58:00.217667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m23:58:00.218684 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m23:58:00.219666 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:58:00.219666 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:58:00.221670 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m23:58:00.223670 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a: Close
[0m23:58:00.226665 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:58:00.225666 [info ] [Thread-4 (]: 14 of 15 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.10s]
[0m23:58:00.228694 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m23:58:00.229664 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m23:58:00.229664 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_stg_products_product_id.7d950a1467: Close
[0m23:58:00.232189 [info ] [Thread-1 (]: 15 of 15 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m23:58:00.234201 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m23:58:00.236358 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:00.237362 [debug] [MainThread]: On master: BEGIN
[0m23:58:00.238359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:00.260435 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m23:58:00.261506 [debug] [MainThread]: On master: COMMIT
[0m23:58:00.262522 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:00.262522 [debug] [MainThread]: On master: COMMIT
[0m23:58:00.265035 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:58:00.266049 [debug] [MainThread]: On master: Close
[0m23:58:00.267046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:00.268050 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:58:00.270055 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m23:58:00.271074 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m23:58:00.272048 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m23:58:00.273218 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m23:58:00.274233 [info ] [MainThread]: 
[0m23:58:00.275395 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m23:58:00.279885 [debug] [MainThread]: Command end result
[0m23:58:00.322665 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:58:00.327668 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:58:00.336201 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:58:00.337202 [info ] [MainThread]: 
[0m23:58:00.338197 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:58:00.338197 [info ] [MainThread]: 
[0m23:58:00.339222 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:58:00.340196 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:58:00.340196 [info ] [MainThread]: 
[0m23:58:00.341196 [info ] [MainThread]:   compiled code at target\compiled\analytics_warehouse\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:58:00.341196 [info ] [MainThread]: 
[0m23:58:00.342197 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m23:58:00.344209 [debug] [MainThread]: Command `dbt test` failed at 23:58:00.343202 after 3.78 seconds
[0m23:58:00.344209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B048169F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04C036B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04D644A0>]}
[0m23:58:00.345209 [debug] [MainThread]: Flushing usage events
[0m23:58:00.593098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:06.304179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E20949B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E20675C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1FA750D0>]}


============================== 23:59:06.310177 | f5c53e7c-9c15-4ebb-80b4-873e8729b768 ==============================
[0m23:59:06.310177 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:59:06.311186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:06.506249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5c53e7c-9c15-4ebb-80b4-873e8729b768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E206A3740>]}
[0m23:59:06.628738 [debug] [MainThread]: Command `dbt clean` succeeded at 23:59:06.628738 after 0.61 seconds
[0m23:59:06.628738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E208B9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E20984B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E20984290>]}
[0m23:59:06.629741 [debug] [MainThread]: Flushing usage events
[0m23:59:06.914371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:16.145851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454C1498E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454C1FA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454C1FBA40>]}


============================== 23:59:16.155390 | dd72238b-31e0-428d-827f-bac86ddfa2dd ==============================
[0m23:59:16.155390 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:59:16.156387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:59:16.455199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454D82C7D0>]}
[0m23:59:16.536581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454C6B7AD0>]}
[0m23:59:16.539565 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:59:17.059484 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:59:17.063482 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:59:17.064481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454D96ACC0>]}
[0m23:59:18.572934 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m23:59:18.593319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454E05D7C0>]}
[0m23:59:18.729206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:59:18.739988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:59:18.798745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454DF4A4E0>]}
[0m23:59:18.799760 [info ] [MainThread]: Found 7 models, 11 data tests, 3 sources, 433 macros
[0m23:59:18.799760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245462E2FC0>]}
[0m23:59:18.802753 [info ] [MainThread]: 
[0m23:59:18.802753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:18.803757 [info ] [MainThread]: 
[0m23:59:18.804755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:18.809753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m23:59:19.388842 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m23:59:19.389842 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:59:19.389842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:19.424020 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.034 seconds
[0m23:59:19.426046 [debug] [ThreadPool]: On list_analytics: Close
[0m23:59:19.428018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:59:19.437617 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:59:19.437617 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:59:19.437617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:19.455151 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m23:59:19.456159 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:59:19.456159 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:59:19.460154 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m23:59:19.461156 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:59:19.462152 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:59:19.469672 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:19.470674 [debug] [MainThread]: On master: BEGIN
[0m23:59:19.470674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:19.489143 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m23:59:19.489143 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:19.490147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:19.494170 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m23:59:19.496171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245498ED1F0>]}
[0m23:59:19.496171 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:19.498713 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:19.498713 [debug] [MainThread]: On master: BEGIN
[0m23:59:19.500724 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:59:19.500724 [debug] [MainThread]: On master: COMMIT
[0m23:59:19.501732 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:19.501732 [debug] [MainThread]: On master: COMMIT
[0m23:59:19.502727 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:59:19.502727 [debug] [MainThread]: On master: Close
[0m23:59:19.510188 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.stg_customers
[0m23:59:19.511213 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_orders
[0m23:59:19.511213 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_products
[0m23:59:19.512213 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m23:59:19.513191 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m23:59:19.514699 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m23:59:19.513191 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_products ................................ [RUN]
[0m23:59:19.515710 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m23:59:19.515710 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m23:59:19.516707 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m23:59:19.516707 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m23:59:19.528234 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m23:59:19.529234 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_products
[0m23:59:19.533395 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m23:59:19.538441 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m23:59:19.546363 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_orders
[0m23:59:19.546363 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_products
[0m23:59:19.548079 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.stg_customers
[0m23:59:19.626135 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.stg_products"
[0m23:59:19.629116 [debug] [Thread-2 (]: Writing runtime sql for node "model.analytics_warehouse.stg_orders"
[0m23:59:19.630138 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.stg_customers"
[0m23:59:19.637145 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:59:19.637145 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:59:19.638511 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:59:19.638511 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_products: BEGIN
[0m23:59:19.639519 [debug] [Thread-1 (]: On model.analytics_warehouse.stg_customers: BEGIN
[0m23:59:19.639519 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_orders: BEGIN
[0m23:59:19.640861 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:59:19.640861 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:59:19.641872 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:59:19.666689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m23:59:19.667685 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:59:19.667685 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m23:59:19.669154 [debug] [Thread-1 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */

  create view "analytics"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."customers"
)

select
    customer_id,
    lower(first_name) as first_name,
    lower(last_name) as last_name,
    lower(email) as email,
    created_at,
    updated_at
from source
  );
[0m23:59:19.670166 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:59:19.670166 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */

  create view "analytics"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."products"
)

select
    product_id,
    initcap(product_name) as product_name,
    price,
    category,
    created_at
from source
  );
[0m23:59:19.681365 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m23:59:19.681875 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m23:59:19.691453 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:59:19.694482 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:59:19.695466 [debug] [Thread-2 (]: SQL status: BEGIN in 0.054 seconds
[0m23:59:19.695466 [debug] [Thread-1 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */
alter table "analytics"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:59:19.696459 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m23:59:19.696459 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:59:19.696459 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */

  create view "analytics"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "analytics"."raw"."orders"
)

select
    order_id,
    customer_id,
    product_id,
    quantity,
    order_date,
    lower(status) as status
from source
  );
[0m23:59:19.699242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:59:19.700251 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:59:19.703251 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:59:19.704250 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:59:19.707254 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:59:19.707254 [debug] [Thread-1 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */
alter table "analytics"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:59:19.710254 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:59:19.711253 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
alter table "analytics"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m23:59:19.711253 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:59:19.713249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:59:19.713249 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:59:19.714758 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:59:19.739901 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:59:19.742903 [debug] [Thread-1 (]: On model.analytics_warehouse.stg_customers: COMMIT
[0m23:59:19.745927 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:59:19.746900 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:59:19.746900 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:59:19.746900 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
alter table "analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:59:19.747899 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_products: COMMIT
[0m23:59:19.747899 [debug] [Thread-1 (]: On model.analytics_warehouse.stg_customers: COMMIT
[0m23:59:19.750246 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:59:19.753797 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:59:19.754814 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:59:19.755811 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_orders: COMMIT
[0m23:59:19.755811 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m23:59:19.757282 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:59:19.766626 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."stg_products__dbt_backup"
[0m23:59:19.767629 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m23:59:19.769629 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_customers__dbt_backup"
[0m23:59:19.775654 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.stg_products"
[0m23:59:19.778656 [debug] [Thread-2 (]: Applying DROP to: "analytics"."public"."stg_orders__dbt_backup"
[0m23:59:19.779629 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.stg_customers"
[0m23:59:19.779629 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_products"} */
drop view if exists "analytics"."public"."stg_products__dbt_backup" cascade
[0m23:59:19.781136 [debug] [Thread-2 (]: Using postgres connection "model.analytics_warehouse.stg_orders"
[0m23:59:19.782146 [debug] [Thread-1 (]: On model.analytics_warehouse.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_customers"} */
drop view if exists "analytics"."public"."stg_customers__dbt_backup" cascade
[0m23:59:19.782146 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.stg_orders"} */
drop view if exists "analytics"."public"."stg_orders__dbt_backup" cascade
[0m23:59:19.788557 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:59:19.792560 [debug] [Thread-3 (]: On model.analytics_warehouse.stg_products: Close
[0m23:59:19.792560 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m23:59:19.795562 [debug] [Thread-1 (]: On model.analytics_warehouse.stg_customers: Close
[0m23:59:19.796558 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.014 seconds
[0m23:59:19.800100 [debug] [Thread-2 (]: On model.analytics_warehouse.stg_orders: Close
[0m23:59:19.804098 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245498ED1F0>]}
[0m23:59:19.805100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454E402180>]}
[0m23:59:19.805100 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454BB43B90>]}
[0m23:59:19.806096 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m23:59:19.808094 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m23:59:19.809096 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_products
[0m23:59:19.809096 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.29s]
[0m23:59:19.810094 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.stg_customers
[0m23:59:19.811093 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_orders
[0m23:59:19.812093 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.int_customer_orders
[0m23:59:19.812093 [info ] [Thread-4 (]: 4 of 7 START sql view model public.int_customer_orders ......................... [RUN]
[0m23:59:19.813118 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.analytics_warehouse.int_customer_orders'
[0m23:59:19.814630 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.int_customer_orders
[0m23:59:19.822323 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.int_customer_orders"
[0m23:59:19.827283 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.int_customer_orders
[0m23:59:19.835047 [debug] [Thread-4 (]: Writing runtime sql for node "model.analytics_warehouse.int_customer_orders"
[0m23:59:19.839081 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:59:19.840073 [debug] [Thread-4 (]: On model.analytics_warehouse.int_customer_orders: BEGIN
[0m23:59:19.841090 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:59:19.860498 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m23:59:19.860498 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:59:19.861537 [debug] [Thread-4 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */

  create view "analytics"."public"."int_customer_orders__dbt_tmp"
    
    
  as (
    with customers as (
    select * from "analytics"."public"."stg_customers"
),

orders as (
    select * from "analytics"."public"."stg_orders"
)

select
    o.order_id,
    o.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    o.product_id,
    o.quantity,
    o.status,
    o.order_date
from orders o
left join customers c on o.customer_id = c.customer_id
  );
[0m23:59:19.866630 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:59:19.869628 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:59:19.869628 [debug] [Thread-4 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */
alter table "analytics"."public"."int_customer_orders__dbt_tmp" rename to "int_customer_orders"
[0m23:59:19.871629 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:19.872630 [debug] [Thread-4 (]: On model.analytics_warehouse.int_customer_orders: COMMIT
[0m23:59:19.873628 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:59:19.873628 [debug] [Thread-4 (]: On model.analytics_warehouse.int_customer_orders: COMMIT
[0m23:59:19.876628 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:59:19.878626 [debug] [Thread-4 (]: Applying DROP to: "analytics"."public"."int_customer_orders__dbt_backup"
[0m23:59:19.879629 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.int_customer_orders"
[0m23:59:19.879629 [debug] [Thread-4 (]: On model.analytics_warehouse.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_customer_orders"} */
drop view if exists "analytics"."public"."int_customer_orders__dbt_backup" cascade
[0m23:59:19.881139 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:59:19.883178 [debug] [Thread-4 (]: On model.analytics_warehouse.int_customer_orders: Close
[0m23:59:19.884146 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454E4A56D0>]}
[0m23:59:19.885149 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.int_customer_orders .................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:59:19.886151 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.int_customer_orders
[0m23:59:19.887419 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.int_order_details
[0m23:59:19.887419 [info ] [Thread-1 (]: 5 of 7 START sql view model public.int_order_details ........................... [RUN]
[0m23:59:19.888395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_customers, now model.analytics_warehouse.int_order_details)
[0m23:59:19.889399 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.int_order_details
[0m23:59:19.892394 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.int_order_details"
[0m23:59:19.895396 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.int_order_details
[0m23:59:19.899986 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.int_order_details"
[0m23:59:19.904996 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:59:19.906025 [debug] [Thread-1 (]: On model.analytics_warehouse.int_order_details: BEGIN
[0m23:59:19.907034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:19.929379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m23:59:19.930381 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:59:19.930381 [debug] [Thread-1 (]: On model.analytics_warehouse.int_order_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_order_details"} */

  create view "analytics"."public"."int_order_details__dbt_tmp"
    
    
  as (
    with orders as (
    select * from "analytics"."public"."int_customer_orders"
),

products as (
    select * from "analytics"."public"."stg_products"
)

select
    o.order_id,
    o.customer_id,
    o.first_name,
    o.last_name,
    o.email,
    p.product_name,
    p.category,
    o.quantity,
    p.price,
    o.quantity * p.price as total_price,
    o.status,
    o.order_date
from orders o
left join products p on o.product_id = p.product_id
  );
[0m23:59:19.944315 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m23:59:19.950029 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:59:19.951138 [debug] [Thread-1 (]: On model.analytics_warehouse.int_order_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_order_details"} */
alter table "analytics"."public"."int_order_details__dbt_tmp" rename to "int_order_details"
[0m23:59:19.953155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:19.954178 [debug] [Thread-1 (]: On model.analytics_warehouse.int_order_details: COMMIT
[0m23:59:19.955178 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:59:19.955178 [debug] [Thread-1 (]: On model.analytics_warehouse.int_order_details: COMMIT
[0m23:59:19.958152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:59:19.960178 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."int_order_details__dbt_backup"
[0m23:59:19.961178 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.int_order_details"
[0m23:59:19.961178 [debug] [Thread-1 (]: On model.analytics_warehouse.int_order_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.int_order_details"} */
drop view if exists "analytics"."public"."int_order_details__dbt_backup" cascade
[0m23:59:19.962149 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:59:19.963174 [debug] [Thread-1 (]: On model.analytics_warehouse.int_order_details: Close
[0m23:59:19.965703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454E497AD0>]}
[0m23:59:19.966717 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.int_order_details ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:59:19.967723 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.int_order_details
[0m23:59:19.968735 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.customer_lifetime_value
[0m23:59:19.968735 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m23:59:19.969712 [info ] [Thread-3 (]: 6 of 7 START sql table model public.customer_lifetime_value .................... [RUN]
[0m23:59:19.970712 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_products, now model.analytics_warehouse.customer_lifetime_value)
[0m23:59:19.970712 [info ] [Thread-4 (]: 7 of 7 START sql table model public.daily_sales_summary ........................ [RUN]
[0m23:59:19.971712 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.customer_lifetime_value
[0m23:59:19.971712 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.int_customer_orders, now model.analytics_warehouse.daily_sales_summary)
[0m23:59:19.975714 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.customer_lifetime_value"
[0m23:59:19.975714 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m23:59:19.979732 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m23:59:19.985257 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.customer_lifetime_value
[0m23:59:19.991781 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m23:59:20.038233 [debug] [Thread-3 (]: Writing runtime sql for node "model.analytics_warehouse.customer_lifetime_value"
[0m23:59:20.042252 [debug] [Thread-4 (]: Writing runtime sql for node "model.analytics_warehouse.daily_sales_summary"
[0m23:59:20.046235 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:59:20.046235 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:59:20.047747 [debug] [Thread-3 (]: On model.analytics_warehouse.customer_lifetime_value: BEGIN
[0m23:59:20.048757 [debug] [Thread-4 (]: On model.analytics_warehouse.daily_sales_summary: BEGIN
[0m23:59:20.048757 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:20.049757 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:20.067660 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m23:59:20.068655 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:59:20.069652 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m23:59:20.069652 [debug] [Thread-3 (]: On model.analytics_warehouse.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.customer_lifetime_value"} */

  
    

  create  table "analytics"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    customer_id,
    first_name,
    last_name,
    email,
    count(distinct order_id) as total_orders,
    sum(total_price) as total_revenue,
    min(order_date) as first_order_date,
    max(order_date) as last_order_date
from order_details
group by customer_id, first_name, last_name, email
order by total_revenue desc
  );
  
[0m23:59:20.070673 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:59:20.070673 [debug] [Thread-4 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */

  
    

  create  table "analytics"."public"."daily_sales_summary__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    order_date,
    category,
    status,
    count(distinct order_id) as total_orders,
    sum(quantity) as total_items_sold,
    sum(total_price) as total_revenue
from order_details
group by order_date, category, status
order by order_date, category
  );
  
[0m23:59:20.092910 [debug] [Thread-4 (]: SQL status: SELECT 933 in 0.022 seconds
[0m23:59:20.101960 [debug] [Thread-3 (]: SQL status: SELECT 436 in 0.031 seconds
[0m23:59:20.100959 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:59:20.104986 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:59:20.105961 [debug] [Thread-4 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary" rename to "daily_sales_summary__dbt_backup"
[0m23:59:20.105961 [debug] [Thread-3 (]: On model.analytics_warehouse.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.customer_lifetime_value"} */
alter table "analytics"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m23:59:20.107969 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:20.108963 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:59:20.111977 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:59:20.116507 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:59:20.116507 [debug] [Thread-3 (]: On model.analytics_warehouse.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.customer_lifetime_value"} */
alter table "analytics"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m23:59:20.117484 [debug] [Thread-4 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary__dbt_tmp" rename to "daily_sales_summary"
[0m23:59:20.118487 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:20.119505 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:59:20.121499 [debug] [Thread-4 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m23:59:20.122485 [debug] [Thread-3 (]: On model.analytics_warehouse.customer_lifetime_value: COMMIT
[0m23:59:20.123483 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:59:20.123483 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:59:20.124483 [debug] [Thread-4 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m23:59:20.124483 [debug] [Thread-3 (]: On model.analytics_warehouse.customer_lifetime_value: COMMIT
[0m23:59:20.128101 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:59:20.132425 [debug] [Thread-3 (]: Applying DROP to: "analytics"."public"."customer_lifetime_value__dbt_backup"
[0m23:59:20.132425 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m23:59:20.137718 [debug] [Thread-3 (]: Using postgres connection "model.analytics_warehouse.customer_lifetime_value"
[0m23:59:20.141861 [debug] [Thread-4 (]: Applying DROP to: "analytics"."public"."daily_sales_summary__dbt_backup"
[0m23:59:20.142861 [debug] [Thread-3 (]: On model.analytics_warehouse.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.customer_lifetime_value"} */
drop table if exists "analytics"."public"."customer_lifetime_value__dbt_backup" cascade
[0m23:59:20.143864 [debug] [Thread-4 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m23:59:20.144863 [debug] [Thread-4 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
drop table if exists "analytics"."public"."daily_sales_summary__dbt_backup" cascade
[0m23:59:20.149978 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:59:20.151984 [debug] [Thread-3 (]: On model.analytics_warehouse.customer_lifetime_value: Close
[0m23:59:20.152983 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454E4BB770>]}
[0m23:59:20.154271 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m23:59:20.158300 [debug] [Thread-4 (]: On model.analytics_warehouse.daily_sales_summary: Close
[0m23:59:20.155283 [info ] [Thread-3 (]: 6 of 7 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 436[0m in 0.18s]
[0m23:59:20.159282 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.customer_lifetime_value
[0m23:59:20.160289 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd72238b-31e0-428d-827f-bac86ddfa2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454E23D250>]}
[0m23:59:20.162282 [info ] [Thread-4 (]: 7 of 7 OK created sql table model public.daily_sales_summary ................... [[32mSELECT 933[0m in 0.19s]
[0m23:59:20.164795 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m23:59:20.171285 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:20.171285 [debug] [MainThread]: On master: BEGIN
[0m23:59:20.172298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:20.205502 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m23:59:20.206676 [debug] [MainThread]: On master: COMMIT
[0m23:59:20.206676 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:20.206676 [debug] [MainThread]: On master: COMMIT
[0m23:59:20.208668 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:59:20.208668 [debug] [MainThread]: On master: Close
[0m23:59:20.209673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:20.210667 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m23:59:20.210667 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:59:20.211669 [debug] [MainThread]: Connection 'model.analytics_warehouse.int_order_details' was properly closed.
[0m23:59:20.211669 [debug] [MainThread]: Connection 'model.analytics_warehouse.stg_orders' was properly closed.
[0m23:59:20.212667 [debug] [MainThread]: Connection 'model.analytics_warehouse.customer_lifetime_value' was properly closed.
[0m23:59:20.212667 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m23:59:20.212667 [info ] [MainThread]: 
[0m23:59:20.213673 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m23:59:20.218251 [debug] [MainThread]: Command end result
[0m23:59:20.257621 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:59:20.266870 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:59:20.277835 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:59:20.279107 [info ] [MainThread]: 
[0m23:59:20.279107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:20.280410 [info ] [MainThread]: 
[0m23:59:20.281418 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:59:20.283721 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:20.283721 after 4.37 seconds
[0m23:59:20.283721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454B40EDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454994F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002454BB780E0>]}
[0m23:59:20.284724 [debug] [MainThread]: Flushing usage events
[0m23:59:20.587773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:34.170265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0746EFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0761680E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D076168080>]}


============================== 23:59:34.179341 | a53107b7-a69c-43e9-9e04-75db5d90a71b ==============================
[0m23:59:34.179341 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:59:34.181357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m23:59:34.481250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a53107b7-a69c-43e9-9e04-75db5d90a71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D076A6B4A0>]}
[0m23:59:34.547053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a53107b7-a69c-43e9-9e04-75db5d90a71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D074196510>]}
[0m23:59:34.553457 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:59:35.116692 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:59:35.432539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:35.433576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:35.438576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m23:59:35.488073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a53107b7-a69c-43e9-9e04-75db5d90a71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D077DB6CF0>]}
[0m23:59:35.610278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:59:35.621858 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:59:35.712777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a53107b7-a69c-43e9-9e04-75db5d90a71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D078406600>]}
[0m23:59:35.712777 [info ] [MainThread]: Found 7 models, 11 data tests, 3 sources, 433 macros
[0m23:59:35.715304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a53107b7-a69c-43e9-9e04-75db5d90a71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0782E1580>]}
[0m23:59:35.719341 [info ] [MainThread]: 
[0m23:59:35.722315 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:35.724323 [info ] [MainThread]: 
[0m23:59:35.728350 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:35.746543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m23:59:36.398854 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:59:36.399846 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m23:59:36.399846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:36.437168 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m23:59:36.437168 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m23:59:36.438192 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:59:36.442166 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m23:59:36.443168 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m23:59:36.445163 [debug] [ThreadPool]: On list_analytics_public: Close
[0m23:59:36.452509 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:36.453548 [debug] [MainThread]: On master: BEGIN
[0m23:59:36.453548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:36.468702 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m23:59:36.469740 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:36.469740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:36.473710 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m23:59:36.476730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a53107b7-a69c-43e9-9e04-75db5d90a71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D077D998B0>]}
[0m23:59:36.477728 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:36.478711 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:36.478711 [debug] [MainThread]: On master: BEGIN
[0m23:59:36.481224 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:36.482235 [debug] [MainThread]: On master: COMMIT
[0m23:59:36.483235 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:36.483235 [debug] [MainThread]: On master: COMMIT
[0m23:59:36.485253 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:59:36.485253 [debug] [MainThread]: On master: Close
[0m23:59:36.493529 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m23:59:36.493529 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897
[0m23:59:36.494565 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m23:59:36.495538 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m23:59:36.494565 [info ] [Thread-1 (]: 1 of 11 START test not_null_customer_lifetime_value_customer_id ................ [RUN]
[0m23:59:36.495538 [info ] [Thread-2 (]: 2 of 11 START test not_null_customer_lifetime_value_total_revenue .............. [RUN]
[0m23:59:36.496543 [info ] [Thread-3 (]: 3 of 11 START test not_null_daily_sales_summary_order_date ..................... [RUN]
[0m23:59:36.498052 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a'
[0m23:59:36.496543 [info ] [Thread-4 (]: 4 of 11 START test not_null_daily_sales_summary_total_revenue .................. [RUN]
[0m23:59:36.499061 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897'
[0m23:59:36.499061 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2'
[0m23:59:36.500091 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m23:59:36.500091 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf'
[0m23:59:36.501083 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897
[0m23:59:36.501083 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m23:59:36.512594 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m23:59:36.531214 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m23:59:36.539827 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"
[0m23:59:36.543828 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"
[0m23:59:36.550246 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"
[0m23:59:36.556381 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897
[0m23:59:36.567909 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m23:59:36.579300 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m23:59:36.579300 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m23:59:36.597905 [debug] [Thread-4 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"
[0m23:59:36.598921 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m23:59:36.603956 [debug] [Thread-2 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"
[0m23:59:36.605933 [debug] [Thread-3 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"
[0m23:59:36.613748 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"
[0m23:59:36.614756 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"
[0m23:59:36.615765 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m23:59:36.615765 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"
[0m23:59:36.616777 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2: BEGIN
[0m23:59:36.616777 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf: BEGIN
[0m23:59:36.617771 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a: BEGIN
[0m23:59:36.617771 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897: BEGIN
[0m23:59:36.617771 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:59:36.618771 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:59:36.618771 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:59:36.619774 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:59:36.646038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m23:59:36.647037 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m23:59:36.648049 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "analytics"."public"."customer_lifetime_value"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m23:59:36.650567 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:59:36.658090 [debug] [Thread-4 (]: SQL status: BEGIN in 0.039 seconds
[0m23:59:36.657090 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a: ROLLBACK
[0m23:59:36.659087 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"
[0m23:59:36.660342 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "analytics"."public"."daily_sales_summary"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m23:59:36.660342 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a: Close
[0m23:59:36.661692 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m23:59:36.662706 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"
[0m23:59:36.664706 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "analytics"."public"."customer_lifetime_value"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m23:59:36.663706 [info ] [Thread-1 (]: 1 of 11 PASS not_null_customer_lifetime_value_customer_id ...................... [[32mPASS[0m in 0.17s]
[0m23:59:36.666239 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m23:59:36.667253 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:59:36.669276 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:59:36.670248 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:59:36.670248 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m23:59:36.673251 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897: ROLLBACK
[0m23:59:36.668248 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m23:59:36.676534 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf: ROLLBACK
[0m23:59:36.677538 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"
[0m23:59:36.679551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a, now test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m23:59:36.680123 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897: Close
[0m23:59:36.681130 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "analytics"."public"."daily_sales_summary"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m23:59:36.682565 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf: Close
[0m23:59:36.683584 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:59:36.686597 [info ] [Thread-2 (]: 2 of 11 PASS not_null_customer_lifetime_value_total_revenue .................... [[32mPASS[0m in 0.19s]
[0m23:59:36.707950 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.023 seconds
[0m23:59:36.708910 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897
[0m23:59:36.697654 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:59:36.706898 [info ] [Thread-4 (]: 4 of 11 PASS not_null_daily_sales_summary_total_revenue ........................ [[32mPASS[0m in 0.20s]
[0m23:59:36.712936 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2: ROLLBACK
[0m23:59:36.715344 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m23:59:36.716357 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m23:59:36.719353 [debug] [Thread-3 (]: On test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2: Close
[0m23:59:36.718361 [info ] [Thread-2 (]: 6 of 11 START test not_null_stg_orders_order_id ................................ [RUN]
[0m23:59:36.720367 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m23:59:36.722372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_customer_lifetime_value_total_revenue.70db760897, now test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64)
[0m23:59:36.723368 [info ] [Thread-4 (]: 7 of 11 START test not_null_stg_products_product_id ............................ [RUN]
[0m23:59:36.726724 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m23:59:36.726724 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf, now test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3)
[0m23:59:36.725374 [info ] [Thread-3 (]: 3 of 11 PASS not_null_daily_sales_summary_order_date ........................... [[32mPASS[0m in 0.23s]
[0m23:59:36.727864 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:59:36.735424 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:59:36.736426 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m23:59:36.737425 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m23:59:36.746079 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:59:36.758133 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m23:59:36.758718 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m23:59:36.761300 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m23:59:36.760287 [info ] [Thread-3 (]: 8 of 11 START test unique_customer_lifetime_value_customer_id .................. [RUN]
[0m23:59:36.768652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2, now test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9)
[0m23:59:36.770895 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m23:59:36.767628 [debug] [Thread-2 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:59:36.782347 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m23:59:36.785349 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m23:59:36.789568 [debug] [Thread-4 (]: Writing runtime sql for node "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m23:59:36.790548 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:59:36.790548 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m23:59:36.791546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:36.792847 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:59:36.792847 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m23:59:36.793875 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:59:36.800122 [debug] [Thread-3 (]: Writing runtime sql for node "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m23:59:36.801153 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m23:59:36.804146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:36.805140 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m23:59:36.805140 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:36.811285 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m23:59:36.812441 [debug] [Thread-3 (]: On test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9: BEGIN
[0m23:59:36.813453 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:59:36.822064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m23:59:36.823424 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:59:36.824436 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "analytics"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m23:59:36.827555 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:59:36.829557 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m23:59:36.833075 [debug] [Thread-1 (]: On test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m23:59:36.834074 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.16s]
[0m23:59:36.839215 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:59:36.839215 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m23:59:36.841214 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m23:59:36.842213 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m23:59:36.843219 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "analytics"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m23:59:36.845428 [debug] [Thread-2 (]: SQL status: BEGIN in 0.041 seconds
[0m23:59:36.840219 [info ] [Thread-1 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m23:59:36.848970 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:59:36.850962 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:59:36.853492 [debug] [Thread-3 (]: SQL status: BEGIN in 0.040 seconds
[0m23:59:36.855510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada)
[0m23:59:36.857705 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m23:59:36.858707 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "analytics"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m23:59:36.858707 [debug] [Thread-3 (]: Using postgres connection "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m23:59:36.859708 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m23:59:36.860706 [debug] [Thread-3 (]: On test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "analytics"."public"."customer_lifetime_value"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:59:36.861704 [debug] [Thread-4 (]: On test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3: Close
[0m23:59:36.867843 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m23:59:36.868845 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:59:36.872832 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m23:59:36.873832 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:59:36.876862 [debug] [Thread-3 (]: On test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9: ROLLBACK
[0m23:59:36.874836 [info ] [Thread-4 (]: 7 of 11 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.15s]
[0m23:59:36.876862 [debug] [Thread-2 (]: On test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m23:59:36.877971 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m23:59:36.878978 [debug] [Thread-3 (]: On test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9: Close
[0m23:59:36.879984 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m23:59:36.879984 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m23:59:36.890344 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m23:59:36.887972 [info ] [Thread-2 (]: 6 of 11 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.17s]
[0m23:59:36.887972 [info ] [Thread-3 (]: 8 of 11 PASS unique_customer_lifetime_value_customer_id ........................ [[32mPASS[0m in 0.12s]
[0m23:59:36.893347 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m23:59:36.891345 [info ] [Thread-4 (]: 10 of 11 START test unique_stg_orders_order_id ................................. [RUN]
[0m23:59:36.894851 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m23:59:36.895239 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m23:59:36.895747 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3, now test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a)
[0m23:59:36.896756 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m23:59:36.903290 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m23:59:36.896756 [info ] [Thread-2 (]: 11 of 11 START test unique_stg_products_product_id ............................. [RUN]
[0m23:59:36.906315 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m23:59:36.906315 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m23:59:36.907287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64, now test.analytics_warehouse.unique_stg_products_product_id.7d950a1467)
[0m23:59:36.907796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:36.908805 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m23:59:36.918498 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m23:59:36.920497 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m23:59:36.925509 [debug] [Thread-4 (]: Writing runtime sql for node "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m23:59:36.926507 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m23:59:36.929509 [debug] [Thread-2 (]: Writing runtime sql for node "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m23:59:36.932031 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m23:59:36.933059 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:59:36.935361 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:59:36.937394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m23:59:36.938396 [debug] [Thread-1 (]: Using postgres connection "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m23:59:36.939564 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:59:36.941582 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m23:59:36.941582 [debug] [Thread-2 (]: On test.analytics_warehouse.unique_stg_products_product_id.7d950a1467: BEGIN
[0m23:59:36.943068 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:59:36.944079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:59:36.946118 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m23:59:36.949984 [debug] [Thread-1 (]: On test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada: Close
[0m23:59:36.952002 [info ] [Thread-1 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.10s]
[0m23:59:36.954994 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m23:59:36.964511 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m23:59:36.965542 [debug] [Thread-4 (]: Using postgres connection "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m23:59:36.966561 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:59:36.971697 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:59:36.973698 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m23:59:36.975697 [debug] [Thread-4 (]: On test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a: Close
[0m23:59:36.976694 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m23:59:36.976694 [debug] [Thread-2 (]: Using postgres connection "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m23:59:36.978705 [debug] [Thread-2 (]: On test.analytics_warehouse.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:59:36.978705 [info ] [Thread-4 (]: 10 of 11 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.08s]
[0m23:59:36.979711 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m23:59:36.983326 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:59:36.985347 [debug] [Thread-2 (]: On test.analytics_warehouse.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m23:59:36.987345 [debug] [Thread-2 (]: On test.analytics_warehouse.unique_stg_products_product_id.7d950a1467: Close
[0m23:59:36.989542 [info ] [Thread-2 (]: 11 of 11 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.08s]
[0m23:59:36.991717 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m23:59:36.993713 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:36.993713 [debug] [MainThread]: On master: BEGIN
[0m23:59:36.994745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:37.017863 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m23:59:37.018867 [debug] [MainThread]: On master: COMMIT
[0m23:59:37.018867 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:37.020864 [debug] [MainThread]: On master: COMMIT
[0m23:59:37.021858 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:59:37.022865 [debug] [MainThread]: On master: Close
[0m23:59:37.023863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:37.023863 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m23:59:37.024872 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m23:59:37.024872 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m23:59:37.025857 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9' was properly closed.
[0m23:59:37.025857 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m23:59:37.025857 [info ] [MainThread]: 
[0m23:59:37.026858 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m23:59:37.028871 [debug] [MainThread]: Command end result
[0m23:59:37.061622 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m23:59:37.069153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m23:59:37.079144 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m23:59:37.079144 [info ] [MainThread]: 
[0m23:59:37.080142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:37.081652 [info ] [MainThread]: 
[0m23:59:37.082668 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m23:59:37.084696 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:37.084696 after 3.14 seconds
[0m23:59:37.085701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0758FEDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D076A69610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D077C7D1C0>]}
[0m23:59:37.086666 [debug] [MainThread]: Flushing usage events
[0m23:59:37.321774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:02:43.119851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024064EEAF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240680FC500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240680FECF0>]}


============================== 00:02:43.131542 | fd396694-912c-46f4-bff9-1a0735b32b86 ==============================
[0m00:02:43.131542 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:02:43.138452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:02:43.639521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd396694-912c-46f4-bff9-1a0735b32b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024067E02750>]}
[0m00:02:43.703228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd396694-912c-46f4-bff9-1a0735b32b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240686DEBA0>]}
[0m00:02:43.706213 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:02:44.222469 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:02:44.525733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:02:44.526730 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\src\schema.yml
[0m00:02:44.993610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m00:02:45.010873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd396694-912c-46f4-bff9-1a0735b32b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002406A1D82C0>]}
[0m00:02:45.079849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd396694-912c-46f4-bff9-1a0735b32b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002406A3489E0>]}
[0m00:02:45.079849 [info ] [MainThread]: Found 7 models, 8 data tests, 3 sources, 433 macros
[0m00:02:45.081357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd396694-912c-46f4-bff9-1a0735b32b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024069C7D310>]}
[0m00:02:45.085676 [info ] [MainThread]: 
[0m00:02:45.086183 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:02:45.087194 [info ] [MainThread]: 
[0m00:02:45.089588 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:02:45.096417 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m00:02:45.990938 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:02:45.991938 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m00:02:45.991938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:46.021305 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m00:02:46.022330 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:02:46.022330 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:02:46.030306 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m00:02:46.032440 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m00:02:46.034450 [debug] [ThreadPool]: On list_analytics_public: Close
[0m00:02:46.042447 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:46.043448 [debug] [MainThread]: On master: BEGIN
[0m00:02:46.043448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:02:46.066491 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m00:02:46.066491 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:46.067493 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:02:46.071497 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m00:02:46.074601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd396694-912c-46f4-bff9-1a0735b32b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002406A3497F0>]}
[0m00:02:46.075601 [debug] [MainThread]: On master: ROLLBACK
[0m00:02:46.076602 [debug] [MainThread]: On master: Close
[0m00:02:46.086980 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.stg_customers
[0m00:02:46.086980 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_orders
[0m00:02:46.087984 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_products
[0m00:02:46.088980 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m00:02:46.088980 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m00:02:46.089987 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m00:02:46.090980 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m00:02:46.091487 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m00:02:46.091487 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_products
[0m00:02:46.099023 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m00:02:46.103032 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m00:02:46.106031 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m00:02:46.110033 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.stg_customers
[0m00:02:46.110033 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_orders
[0m00:02:46.111032 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_products
[0m00:02:46.112033 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.stg_customers
[0m00:02:46.113060 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_orders
[0m00:02:46.114590 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_products
[0m00:02:46.115864 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.int_customer_orders
[0m00:02:46.115864 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:02:46.116874 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.analytics_warehouse.int_customer_orders'
[0m00:02:46.117872 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:02:46.117872 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:02:46.117872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_customers, now test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m00:02:46.118873 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.int_customer_orders
[0m00:02:46.118873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_orders, now test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64)
[0m00:02:46.119881 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_products, now test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada)
[0m00:02:46.119881 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:02:46.122873 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.int_customer_orders"
[0m00:02:46.123883 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:02:46.124875 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:02:46.139405 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:02:46.144405 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:02:46.151959 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m00:02:46.152957 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.int_customer_orders
[0m00:02:46.153952 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.int_customer_orders
[0m00:02:46.154956 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:02:46.155955 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.int_customer_orders, now test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a)
[0m00:02:46.156950 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:02:46.161955 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m00:02:46.161955 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:02:46.162953 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:02:46.162953 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:02:46.164462 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:02:46.165778 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:02:46.167790 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:02:46.167790 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:02:46.168812 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:02:46.168812 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:02:46.169806 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.int_order_details
[0m00:02:46.170787 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:02:46.170787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64, now test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3)
[0m00:02:46.171786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada, now test.analytics_warehouse.unique_stg_products_product_id.7d950a1467)
[0m00:02:46.172787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.analytics_warehouse.int_order_details)
[0m00:02:46.172787 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:02:46.173788 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:02:46.173788 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.int_order_details
[0m00:02:46.178786 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m00:02:46.184310 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m00:02:46.187833 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.int_order_details"
[0m00:02:46.191835 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.int_order_details
[0m00:02:46.191835 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:02:46.192834 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:02:46.193833 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.int_order_details
[0m00:02:46.194832 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:02:46.195834 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:02:46.196833 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.customer_lifetime_value
[0m00:02:46.196833 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m00:02:46.197836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a, now model.analytics_warehouse.customer_lifetime_value)
[0m00:02:46.198920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.int_order_details, now model.analytics_warehouse.daily_sales_summary)
[0m00:02:46.198920 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.customer_lifetime_value
[0m00:02:46.199920 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m00:02:46.201919 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.customer_lifetime_value"
[0m00:02:46.205932 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m00:02:46.209918 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.customer_lifetime_value
[0m00:02:46.210426 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m00:02:46.211439 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.customer_lifetime_value
[0m00:02:46.212464 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m00:02:46.213437 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:02:46.213437 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:02:46.214438 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_stg_products_product_id.7d950a1467, now test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a)
[0m00:02:46.215583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3, now test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9)
[0m00:02:46.215583 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:02:46.216592 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:02:46.220594 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m00:02:46.225600 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m00:02:46.236111 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:02:46.228593 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:02:46.237353 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:02:46.238367 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:02:46.240594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:46.240594 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m00:02:46.240594 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m00:02:46.241605 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9' was properly closed.
[0m00:02:46.241605 [debug] [MainThread]: Connection 'test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a' was properly closed.
[0m00:02:46.241605 [debug] [MainThread]: Connection 'model.analytics_warehouse.customer_lifetime_value' was properly closed.
[0m00:02:46.243603 [debug] [MainThread]: Command end result
[0m00:02:46.343724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:02:46.352871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:02:46.362865 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m00:02:46.485208 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m00:02:46.486715 [info ] [MainThread]: Building catalog
[0m00:02:46.505049 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m00:02:46.515557 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m00:02:46.516591 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m00:02:46.516591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:46.535959 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m00:02:46.536981 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m00:02:46.536981 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('daily_sales_summary')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_customer_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customer_lifetime_value')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_order_details')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m00:02:46.548531 [debug] [ThreadPool]: SQL status: SELECT 69 in 0.011 seconds
[0m00:02:46.554545 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m00:02:46.555551 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m00:02:46.577694 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\catalog.json
[0m00:02:46.667389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:02:46.672406 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:02:46.672406 [info ] [MainThread]: Catalog written to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\catalog.json
[0m00:02:46.674392 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:02:46.674392 after 4.15 seconds
[0m00:02:46.675549 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:02:46.676291 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m00:02:46.676291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024068145880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240688043E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024068804CE0>]}
[0m00:02:46.677300 [debug] [MainThread]: Flushing usage events
[0m00:02:46.943055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:19.043382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D79FAB590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D79F81490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D78EA2540>]}


============================== 00:03:19.051938 | 76a3a633-fb4f-450a-b102-c6dadd727106 ==============================
[0m00:03:19.051938 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:03:19.052929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m00:03:19.326540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76a3a633-fb4f-450a-b102-c6dadd727106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7A094BF0>]}
[0m00:03:19.387254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76a3a633-fb4f-450a-b102-c6dadd727106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D79BF95B0>]}
[0m00:04:19.079552 [error] [MainThread]: Encountered an error:

[0m00:04:19.115999 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m00:04:19.119047 [debug] [MainThread]: Command `dbt docs serve` failed at 00:04:19.119047 after 60.31 seconds
[0m00:04:19.119047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D79F81490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7A0952E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7B1D2570>]}
[0m00:04:19.120038 [debug] [MainThread]: Flushing usage events
[0m00:04:19.372919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:16.706718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D0A9B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CEAD5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CE590260>]}


============================== 00:07:16.714738 | a430245b-b346-4f06-8101-d3ef0ae3419c ==============================
[0m00:07:16.714738 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:07:16.715831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:07:17.047731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a430245b-b346-4f06-8101-d3ef0ae3419c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D1622FC0>]}
[0m00:07:17.110528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a430245b-b346-4f06-8101-d3ef0ae3419c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D0AD3FE0>]}
[0m00:07:17.113530 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:07:17.645260 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:07:18.076770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:18.077771 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\src\schema.yml
[0m00:07:18.515619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m00:07:18.529637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a430245b-b346-4f06-8101-d3ef0ae3419c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D2F0FAD0>]}
[0m00:07:18.605505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a430245b-b346-4f06-8101-d3ef0ae3419c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D2E0F2C0>]}
[0m00:07:18.605505 [info ] [MainThread]: Found 7 models, 8 data tests, 3 sources, 433 macros
[0m00:07:18.606510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a430245b-b346-4f06-8101-d3ef0ae3419c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D15F5460>]}
[0m00:07:18.609506 [info ] [MainThread]: 
[0m00:07:18.610504 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:07:18.611506 [info ] [MainThread]: 
[0m00:07:18.611506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:07:18.618234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m00:07:19.297678 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:07:19.297678 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m00:07:19.298696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:19.359105 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m00:07:19.359105 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:07:19.360106 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:07:19.386159 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.025 seconds
[0m00:07:19.387162 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m00:07:19.389160 [debug] [ThreadPool]: On list_analytics_public: Close
[0m00:07:19.396164 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:19.396164 [debug] [MainThread]: On master: BEGIN
[0m00:07:19.396164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:19.415465 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m00:07:19.415465 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:19.416479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:07:19.426471 [debug] [MainThread]: SQL status: SELECT 8 in 0.010 seconds
[0m00:07:19.429493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a430245b-b346-4f06-8101-d3ef0ae3419c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D3064EF0>]}
[0m00:07:19.429493 [debug] [MainThread]: On master: ROLLBACK
[0m00:07:19.430998 [debug] [MainThread]: On master: Close
[0m00:07:19.439947 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.stg_customers
[0m00:07:19.440974 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_orders
[0m00:07:19.440974 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_products
[0m00:07:19.441945 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m00:07:19.442949 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m00:07:19.442949 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m00:07:19.443952 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m00:07:19.443952 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m00:07:19.444948 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_products
[0m00:07:19.452127 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m00:07:19.455113 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m00:07:19.458140 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m00:07:19.461114 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_orders
[0m00:07:19.462582 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.stg_customers
[0m00:07:19.462582 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_products
[0m00:07:19.464617 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_orders
[0m00:07:19.465761 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.stg_customers
[0m00:07:19.466767 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_products
[0m00:07:19.467766 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:07:19.467766 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:07:19.468766 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.int_customer_orders
[0m00:07:19.468766 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64'
[0m00:07:19.469768 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:07:19.469768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_orders, now test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a)
[0m00:07:19.470768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_customers, now model.analytics_warehouse.int_customer_orders)
[0m00:07:19.470768 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:07:19.471767 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_products, now test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m00:07:19.471767 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:07:19.471767 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.int_customer_orders
[0m00:07:19.483523 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:07:19.485546 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:07:19.491532 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m00:07:19.494518 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.int_customer_orders"
[0m00:07:19.499083 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:07:19.502092 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.int_customer_orders
[0m00:07:19.503292 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:07:19.504311 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.int_customer_orders
[0m00:07:19.504311 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:07:19.505327 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:07:19.506302 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:07:19.506302 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:07:19.507306 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:07:19.508305 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:07:19.508305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.int_customer_orders, now test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada)
[0m00:07:19.509302 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:07:19.509302 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:07:19.510302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a, now test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3)
[0m00:07:19.510302 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:07:19.511304 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.int_order_details
[0m00:07:19.511304 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64, now test.analytics_warehouse.unique_stg_products_product_id.7d950a1467)
[0m00:07:19.512304 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:07:19.516491 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m00:07:19.517461 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.analytics_warehouse.int_order_details)
[0m00:07:19.517461 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:07:19.521461 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m00:07:19.522460 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.int_order_details
[0m00:07:19.526484 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m00:07:19.529474 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.int_order_details"
[0m00:07:19.530996 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:07:19.532286 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:07:19.533296 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.int_order_details
[0m00:07:19.534798 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:07:19.534798 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:07:19.535808 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.int_order_details
[0m00:07:19.536809 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:07:19.537813 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:07:19.538995 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.customer_lifetime_value
[0m00:07:19.538995 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m00:07:19.539992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada, now model.analytics_warehouse.customer_lifetime_value)
[0m00:07:19.539992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3, now model.analytics_warehouse.daily_sales_summary)
[0m00:07:19.540992 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.customer_lifetime_value
[0m00:07:19.540992 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m00:07:19.543993 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.customer_lifetime_value"
[0m00:07:19.547025 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m00:07:19.549310 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.customer_lifetime_value
[0m00:07:19.550319 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m00:07:19.551322 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.customer_lifetime_value
[0m00:07:19.552317 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m00:07:19.552317 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:07:19.553319 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:07:19.553319 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_stg_products_product_id.7d950a1467, now test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a)
[0m00:07:19.554317 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.int_order_details, now test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9)
[0m00:07:19.554317 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:07:19.554317 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:07:19.559324 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m00:07:19.564839 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m00:07:19.567864 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:07:19.567864 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:07:19.568891 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:07:19.569897 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:07:19.570898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:19.571900 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m00:07:19.571900 [debug] [MainThread]: Connection 'model.analytics_warehouse.customer_lifetime_value' was properly closed.
[0m00:07:19.571900 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m00:07:19.572930 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9' was properly closed.
[0m00:07:19.572930 [debug] [MainThread]: Connection 'test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a' was properly closed.
[0m00:07:19.574911 [debug] [MainThread]: Command end result
[0m00:07:19.657057 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:07:19.664563 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:07:19.674036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m00:07:19.683525 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m00:07:19.684530 [info ] [MainThread]: Building catalog
[0m00:07:19.701411 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m00:07:19.717958 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m00:07:19.718954 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m00:07:19.719955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:19.741123 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m00:07:19.741123 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m00:07:19.742122 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customer_lifetime_value')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_customer_orders')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_order_details')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('daily_sales_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m00:07:19.754642 [debug] [ThreadPool]: SQL status: SELECT 69 in 0.012 seconds
[0m00:07:19.819458 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m00:07:19.820458 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m00:07:19.836161 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\catalog.json
[0m00:07:19.857849 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:07:19.862881 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:07:19.864391 [info ] [MainThread]: Catalog written to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\catalog.json
[0m00:07:19.865820 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:07:19.865820 after 3.72 seconds
[0m00:07:19.865820 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:07:19.866848 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m00:07:19.866848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D0B95940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D34D0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D12B2F60>]}
[0m00:07:19.867845 [debug] [MainThread]: Flushing usage events
[0m00:07:20.107042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:30.719669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5254AF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5509DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A54FA4260>]}


============================== 00:07:30.728671 | e9e0aec5-5a6a-41ba-a7a7-c989d614335b ==============================
[0m00:07:30.728671 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:07:30.729648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m00:07:31.046295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9e0aec5-5a6a-41ba-a7a7-c989d614335b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A527DFEC0>]}
[0m00:07:31.107686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9e0aec5-5a6a-41ba-a7a7-c989d614335b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A54AF6090>]}
[0m00:07:57.345419 [error] [MainThread]: Encountered an error:

[0m00:07:57.362581 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m00:07:57.365088 [debug] [MainThread]: Command `dbt docs serve` failed at 00:07:57.365088 after 26.88 seconds
[0m00:07:57.366219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5525BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5686D2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5686C1D0>]}
[0m00:07:57.367230 [debug] [MainThread]: Flushing usage events
[0m00:07:57.599442 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:38.108503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8A7B0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8C203F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF89C701A0>]}


============================== 00:11:38.116483 | 75bd200e-ad7c-474c-a948-b7a358a65143 ==============================
[0m00:11:38.116483 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:11:38.117577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:11:38.476893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75bd200e-ad7c-474c-a948-b7a358a65143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8C1D2750>]}
[0m00:11:38.549217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75bd200e-ad7c-474c-a948-b7a358a65143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8C203F80>]}
[0m00:11:38.552215 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:11:39.121612 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:11:39.247664 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:11:39.248765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75bd200e-ad7c-474c-a948-b7a358a65143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8C854110>]}
[0m00:11:40.708652 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named customer_lifetime_value. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for customer_lifetime_value in this file:
   - models\src\schema.yml
  
[0m00:11:40.711251 [debug] [MainThread]: Command `dbt snapshot` failed at 00:11:40.710227 after 3.16 seconds
[0m00:11:40.711251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8CB9B650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8E65CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8E64F5C0>]}
[0m00:11:40.711251 [debug] [MainThread]: Flushing usage events
[0m00:11:41.040495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:14:51.903064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001580BB96900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001580BBFF440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001580B47C950>]}


============================== 00:14:51.910088 | 5d13ebf3-c5f4-4981-b03e-5c72d8efb5e2 ==============================
[0m00:14:51.910088 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:14:51.911061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:14:52.218479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d13ebf3-c5f4-4981-b03e-5c72d8efb5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001580C01AF90>]}
[0m00:14:52.278749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d13ebf3-c5f4-4981-b03e-5c72d8efb5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001580BD63110>]}
[0m00:14:52.280979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:14:52.824634 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:14:52.947904 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:14:52.948917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d13ebf3-c5f4-4981-b03e-5c72d8efb5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001580D689460>]}
[0m00:14:54.757064 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named daily_sales_summary. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for daily_sales_summary in this file:
   - models\src\schema.yml
  
[0m00:14:54.759063 [debug] [MainThread]: Command `dbt snapshot` failed at 00:14:54.759063 after 3.38 seconds
[0m00:14:54.759063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001580B4206E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001580D9CF6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001580D746270>]}
[0m00:14:54.760060 [debug] [MainThread]: Flushing usage events
[0m00:14:55.021292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:08.314417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E208AD1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2083BC860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2083BD4C0>]}


============================== 00:16:08.320439 | f1f5fc42-572b-465e-b3c6-14ddeda8f09e ==============================
[0m00:16:08.320439 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:16:08.321438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:16:08.611815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1f5fc42-572b-465e-b3c6-14ddeda8f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E207EE6480>]}
[0m00:16:08.672460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1f5fc42-572b-465e-b3c6-14ddeda8f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E208CC4E60>]}
[0m00:16:08.675444 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:16:09.201025 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:16:09.307864 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:16:09.308862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1f5fc42-572b-465e-b3c6-14ddeda8f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E208D2CF20>]}
[0m00:16:11.062787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m00:16:11.083822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1f5fc42-572b-465e-b3c6-14ddeda8f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E20A743F20>]}
[0m00:16:11.205389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:16:11.213388 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:16:11.277531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1f5fc42-572b-465e-b3c6-14ddeda8f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E20A7D0B30>]}
[0m00:16:11.277531 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 data tests, 3 sources, 433 macros
[0m00:16:11.278535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1f5fc42-572b-465e-b3c6-14ddeda8f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E20A7E9880>]}
[0m00:16:11.281069 [info ] [MainThread]: 
[0m00:16:11.282083 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:16:11.282083 [info ] [MainThread]: 
[0m00:16:11.283092 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:16:11.285091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m00:16:12.213513 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m00:16:12.213513 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m00:16:12.216036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:12.292485 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.076 seconds
[0m00:16:12.295346 [debug] [ThreadPool]: On list_analytics: Close
[0m00:16:12.296888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_snapshots)
[0m00:16:12.298394 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "snapshots"
"
[0m00:16:12.307895 [debug] [ThreadPool]: Using postgres connection "create_analytics_snapshots"
[0m00:16:12.308436 [debug] [ThreadPool]: On create_analytics_snapshots: BEGIN
[0m00:16:12.309068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:12.337677 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m00:16:12.338382 [debug] [ThreadPool]: Using postgres connection "create_analytics_snapshots"
[0m00:16:12.339017 [debug] [ThreadPool]: On create_analytics_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "create_analytics_snapshots"} */
create schema if not exists "snapshots"
[0m00:16:12.347812 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.008 seconds
[0m00:16:12.349880 [debug] [ThreadPool]: On create_analytics_snapshots: COMMIT
[0m00:16:12.350442 [debug] [ThreadPool]: Using postgres connection "create_analytics_snapshots"
[0m00:16:12.350987 [debug] [ThreadPool]: On create_analytics_snapshots: COMMIT
[0m00:16:12.357480 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m00:16:12.358040 [debug] [ThreadPool]: On create_analytics_snapshots: Close
[0m00:16:12.368072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m00:16:12.374129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_snapshots'
[0m00:16:12.377122 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:16:12.380124 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:16:12.381125 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m00:16:12.381125 [debug] [ThreadPool]: On list_analytics_snapshots: BEGIN
[0m00:16:12.382345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:12.382345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:12.406610 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m00:16:12.407616 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:16:12.408612 [debug] [ThreadPool]: On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:16:12.410612 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m00:16:12.410612 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:16:12.411614 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:16:12.424847 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m00:16:12.427849 [debug] [ThreadPool]: On list_analytics_snapshots: ROLLBACK
[0m00:16:12.428861 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.016 seconds
[0m00:16:12.431250 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m00:16:12.432591 [debug] [ThreadPool]: On list_analytics_snapshots: Close
[0m00:16:12.434101 [debug] [ThreadPool]: On list_analytics_public: Close
[0m00:16:12.445296 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:12.446299 [debug] [MainThread]: On master: BEGIN
[0m00:16:12.446299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:12.475566 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m00:16:12.477075 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:12.478092 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:16:12.493885 [debug] [MainThread]: SQL status: SELECT 8 in 0.015 seconds
[0m00:16:12.496886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1f5fc42-572b-465e-b3c6-14ddeda8f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E206A64EF0>]}
[0m00:16:12.497884 [debug] [MainThread]: On master: ROLLBACK
[0m00:16:12.499410 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:12.500408 [debug] [MainThread]: On master: BEGIN
[0m00:16:12.502775 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:16:12.502775 [debug] [MainThread]: On master: COMMIT
[0m00:16:12.504285 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:12.504285 [debug] [MainThread]: On master: COMMIT
[0m00:16:12.506296 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:16:12.507295 [debug] [MainThread]: On master: Close
[0m00:16:12.517662 [debug] [Thread-1 (]: Began running node snapshot.analytics_warehouse.customers_snapshot
[0m00:16:12.518662 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m00:16:12.520812 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.analytics_warehouse.customers_snapshot'
[0m00:16:12.520812 [debug] [Thread-1 (]: Began compiling node snapshot.analytics_warehouse.customers_snapshot
[0m00:16:12.542403 [debug] [Thread-1 (]: Began executing node snapshot.analytics_warehouse.customers_snapshot
[0m00:16:12.674275 [debug] [Thread-1 (]: Using postgres connection "snapshot.analytics_warehouse.customers_snapshot"
[0m00:16:12.675373 [debug] [Thread-1 (]: On snapshot.analytics_warehouse.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "snapshot.analytics_warehouse.customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        


select
    customer_id,
    first_name,
    last_name,
    email,
    created_at,
    updated_at
from "analytics"."raw"."customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m00:16:12.676385 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:16:12.718964 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m00:16:12.729696 [debug] [Thread-1 (]: Using postgres connection "snapshot.analytics_warehouse.customers_snapshot"
[0m00:16:12.730416 [debug] [Thread-1 (]: On snapshot.analytics_warehouse.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "snapshot.analytics_warehouse.customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m00:16:12.736537 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m00:16:12.737549 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m00:16:12.739739 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.analytics_warehouse.customers_snapshot"
[0m00:16:12.743753 [debug] [Thread-1 (]: Using postgres connection "snapshot.analytics_warehouse.customers_snapshot"
[0m00:16:12.743753 [debug] [Thread-1 (]: On snapshot.analytics_warehouse.customers_snapshot: BEGIN
[0m00:16:12.746247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:16:12.747760 [debug] [Thread-1 (]: Using postgres connection "snapshot.analytics_warehouse.customers_snapshot"
[0m00:16:12.749517 [debug] [Thread-1 (]: On snapshot.analytics_warehouse.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "snapshot.analytics_warehouse.customers_snapshot"} */

      
  
    

  create  table "analytics"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        


select
    customer_id,
    first_name,
    last_name,
    email,
    created_at,
    updated_at
from "analytics"."raw"."customers"

    ) sbq



  );
  
  
[0m00:16:12.789403 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.039 seconds
[0m00:16:12.822049 [debug] [Thread-1 (]: On snapshot.analytics_warehouse.customers_snapshot: COMMIT
[0m00:16:12.823316 [debug] [Thread-1 (]: Using postgres connection "snapshot.analytics_warehouse.customers_snapshot"
[0m00:16:12.824334 [debug] [Thread-1 (]: On snapshot.analytics_warehouse.customers_snapshot: COMMIT
[0m00:16:12.830953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:16:12.834083 [debug] [Thread-1 (]: On snapshot.analytics_warehouse.customers_snapshot: Close
[0m00:16:12.840594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f5fc42-572b-465e-b3c6-14ddeda8f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E20602EEA0>]}
[0m00:16:12.842612 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mSELECT 500[0m in 0.32s]
[0m00:16:12.844594 [debug] [Thread-1 (]: Finished running node snapshot.analytics_warehouse.customers_snapshot
[0m00:16:12.847063 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:12.847063 [debug] [MainThread]: On master: BEGIN
[0m00:16:12.848076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:12.886704 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m00:16:12.886704 [debug] [MainThread]: On master: COMMIT
[0m00:16:12.887899 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:12.888940 [debug] [MainThread]: On master: COMMIT
[0m00:16:12.890952 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:16:12.891957 [debug] [MainThread]: On master: Close
[0m00:16:12.892952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:12.893956 [debug] [MainThread]: Connection 'create_analytics_snapshots' was properly closed.
[0m00:16:12.894954 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m00:16:12.895953 [debug] [MainThread]: Connection 'list_analytics_snapshots' was properly closed.
[0m00:16:12.895953 [debug] [MainThread]: Connection 'snapshot.analytics_warehouse.customers_snapshot' was properly closed.
[0m00:16:12.896953 [info ] [MainThread]: 
[0m00:16:12.901959 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m00:16:12.906486 [debug] [MainThread]: Command end result
[0m00:16:13.015424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:16:13.077049 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:16:13.120507 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m00:16:13.121518 [info ] [MainThread]: 
[0m00:16:13.126530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:16:13.137658 [info ] [MainThread]: 
[0m00:16:13.145961 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:16:13.151555 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:16:13.151555 after 5.13 seconds
[0m00:16:13.153547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E208C32870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E208879C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2088784A0>]}
[0m00:16:13.155723 [debug] [MainThread]: Flushing usage events
[0m00:16:13.462755 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:55.378364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5D941BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5D941E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5D941EE0>]}


============================== 00:20:55.386085 | a365fae1-12e5-4a8f-9b9b-dabff5ba3ec0 ==============================
[0m00:20:55.386085 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:20:55.387078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select daily_sales_summary', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:20:55.688967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a365fae1-12e5-4a8f-9b9b-dabff5ba3ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5DDA2D80>]}
[0m00:20:55.751888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a365fae1-12e5-4a8f-9b9b-dabff5ba3ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5DAD52E0>]}
[0m00:20:55.753938 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:20:56.367415 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:20:56.690331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:20:56.690331 [debug] [MainThread]: Partial parsing: added file: analytics_warehouse://macros\currency_utils.sql
[0m00:20:56.691333 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\marts\daily_sales_summary.sql
[0m00:20:57.196153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m00:20:57.218489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a365fae1-12e5-4a8f-9b9b-dabff5ba3ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5EFD4470>]}
[0m00:20:57.329957 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:20:57.337211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:20:57.394022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a365fae1-12e5-4a8f-9b9b-dabff5ba3ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5F91A3C0>]}
[0m00:20:57.395018 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 data tests, 3 sources, 434 macros
[0m00:20:57.395018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a365fae1-12e5-4a8f-9b9b-dabff5ba3ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5DC61D90>]}
[0m00:20:57.397042 [info ] [MainThread]: 
[0m00:20:57.398015 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:20:57.399030 [info ] [MainThread]: 
[0m00:20:57.399030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:20:57.401040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m00:20:57.970504 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m00:20:57.971540 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m00:20:57.971540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:58.012878 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.041 seconds
[0m00:20:58.014391 [debug] [ThreadPool]: On list_analytics: Close
[0m00:20:58.020908 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_snapshots'
[0m00:20:58.026475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m00:20:58.027492 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:20:58.029468 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:20:58.029468 [debug] [ThreadPool]: On list_analytics_snapshots: BEGIN
[0m00:20:58.029468 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m00:20:58.030974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:58.030974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:58.053076 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m00:20:58.054072 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:20:58.055069 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m00:20:58.056071 [debug] [ThreadPool]: On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:20:58.056071 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:20:58.057072 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:20:58.067271 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m00:20:58.068737 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m00:20:58.070749 [debug] [ThreadPool]: On list_analytics_snapshots: ROLLBACK
[0m00:20:58.073520 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m00:20:58.074530 [debug] [ThreadPool]: On list_analytics_snapshots: Close
[0m00:20:58.075534 [debug] [ThreadPool]: On list_analytics_public: Close
[0m00:20:58.085059 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:58.085059 [debug] [MainThread]: On master: BEGIN
[0m00:20:58.086062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:20:58.105110 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:20:58.105110 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:58.106136 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:20:58.113114 [debug] [MainThread]: SQL status: SELECT 8 in 0.008 seconds
[0m00:20:58.116782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a365fae1-12e5-4a8f-9b9b-dabff5ba3ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5FB536B0>]}
[0m00:20:58.116782 [debug] [MainThread]: On master: ROLLBACK
[0m00:20:58.118787 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:58.118787 [debug] [MainThread]: On master: BEGIN
[0m00:20:58.121301 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:20:58.121301 [debug] [MainThread]: On master: COMMIT
[0m00:20:58.121301 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:58.122310 [debug] [MainThread]: On master: COMMIT
[0m00:20:58.123312 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:20:58.123312 [debug] [MainThread]: On master: Close
[0m00:20:58.131144 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m00:20:58.132152 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_summary ........................ [RUN]
[0m00:20:58.133153 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.daily_sales_summary'
[0m00:20:58.133153 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m00:20:58.142678 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m00:20:58.146014 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m00:20:58.192137 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.daily_sales_summary"
[0m00:20:58.194134 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:20:58.195139 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: BEGIN
[0m00:20:58.195139 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:20:58.213737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m00:20:58.214735 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:20:58.215753 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */

  
    

  create  table "analytics"."public"."daily_sales_summary__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    order_date,
    category,
    status,
    sum(quantity) as total_items_sold,
    sum(total_price) as total_revenue_usd,
    
    (sum(total_price) * 0.92)
 as total_revenue_eur
from order_details
group by order_date, category, status
order by order_date, category;
  );
  
[0m00:20:58.219127 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: order by order_date, category;
                                      ^

[0m00:20:58.219127 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: ROLLBACK
[0m00:20:58.220136 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: Close
[0m00:20:58.240147 [debug] [Thread-1 (]: Database Error in model daily_sales_summary (models\marts\daily_sales_summary.sql)
  syntax error at or near ";"
  LINE 27: order by order_date, category;
                                        ^
  compiled code at target\run\analytics_warehouse\models\marts\daily_sales_summary.sql
[0m00:20:58.243125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a365fae1-12e5-4a8f-9b9b-dabff5ba3ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5FD2B260>]}
[0m00:20:58.243125 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.daily_sales_summary ............... [[31mERROR[0m in 0.11s]
[0m00:20:58.244156 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m00:20:58.245147 [debug] [Thread-7 (]: Marking all children of 'model.analytics_warehouse.daily_sales_summary' to be skipped because of status 'error'.  Reason: Database Error in model daily_sales_summary (models\marts\daily_sales_summary.sql)
  syntax error at or near ";"
  LINE 27: order by order_date, category;
                                        ^
  compiled code at target\run\analytics_warehouse\models\marts\daily_sales_summary.sql.
[0m00:20:58.247659 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:58.247659 [debug] [MainThread]: On master: BEGIN
[0m00:20:58.248690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:20:58.270691 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m00:20:58.270691 [debug] [MainThread]: On master: COMMIT
[0m00:20:58.271713 [debug] [MainThread]: Using postgres connection "master"
[0m00:20:58.271713 [debug] [MainThread]: On master: COMMIT
[0m00:20:58.273686 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:20:58.273686 [debug] [MainThread]: On master: Close
[0m00:20:58.274696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:58.275696 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m00:20:58.275696 [debug] [MainThread]: Connection 'list_analytics_snapshots' was properly closed.
[0m00:20:58.276700 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m00:20:58.276700 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m00:20:58.277688 [info ] [MainThread]: 
[0m00:20:58.277688 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m00:20:58.278687 [debug] [MainThread]: Command end result
[0m00:20:58.311911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:20:58.318656 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:20:58.327377 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m00:20:58.328377 [info ] [MainThread]: 
[0m00:20:58.328377 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:20:58.329378 [info ] [MainThread]: 
[0m00:20:58.330376 [error] [MainThread]:   Database Error in model daily_sales_summary (models\marts\daily_sales_summary.sql)
  syntax error at or near ";"
  LINE 27: order by order_date, category;
                                        ^
  compiled code at target\run\analytics_warehouse\models\marts\daily_sales_summary.sql
[0m00:20:58.330376 [info ] [MainThread]: 
[0m00:20:58.331375 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:20:58.332915 [debug] [MainThread]: Command `dbt run` failed at 00:20:58.332915 after 3.48 seconds
[0m00:20:58.332915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5DA0C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5F76C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5F61A330>]}
[0m00:20:58.333916 [debug] [MainThread]: Flushing usage events
[0m00:20:58.605202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:21:24.161663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282CEA4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282CEA4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282C8C8470>]}


============================== 00:21:24.167856 | 1d94618a-c732-4f8e-a397-a88333c11a03 ==============================
[0m00:21:24.167856 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:21:24.168858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select daily_sales_summary', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:21:24.452823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d94618a-c732-4f8e-a397-a88333c11a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282CF56000>]}
[0m00:21:24.513023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d94618a-c732-4f8e-a397-a88333c11a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282CFCE330>]}
[0m00:21:24.515599 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:21:25.111125 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:21:25.434130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:21:25.435109 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\marts\daily_sales_summary.sql
[0m00:21:26.010069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m00:21:26.028644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d94618a-c732-4f8e-a397-a88333c11a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282E80F110>]}
[0m00:21:26.128647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:21:26.137190 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:21:26.191944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d94618a-c732-4f8e-a397-a88333c11a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282E9A2030>]}
[0m00:21:26.192943 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 data tests, 3 sources, 434 macros
[0m00:21:26.193939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d94618a-c732-4f8e-a397-a88333c11a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282E7A8230>]}
[0m00:21:26.194974 [info ] [MainThread]: 
[0m00:21:26.195969 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:21:26.196939 [info ] [MainThread]: 
[0m00:21:26.198450 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:21:26.200468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m00:21:26.787974 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m00:21:26.787974 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m00:21:26.787974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:26.817489 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.029 seconds
[0m00:21:26.819493 [debug] [ThreadPool]: On list_analytics: Close
[0m00:21:26.825493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_snapshots'
[0m00:21:26.831060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m00:21:26.832073 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:21:26.834108 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:21:26.834108 [debug] [ThreadPool]: On list_analytics_snapshots: BEGIN
[0m00:21:26.835082 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m00:21:26.835082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:26.835082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:26.857898 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m00:21:26.857898 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:21:26.859194 [debug] [ThreadPool]: On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:21:26.864316 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m00:21:26.866337 [debug] [ThreadPool]: On list_analytics_snapshots: ROLLBACK
[0m00:21:26.868335 [debug] [ThreadPool]: On list_analytics_snapshots: Close
[0m00:21:26.872448 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m00:21:26.873451 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:21:26.873451 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:21:26.886489 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m00:21:26.888494 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m00:21:26.890004 [debug] [ThreadPool]: On list_analytics_public: Close
[0m00:21:26.897043 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:26.898044 [debug] [MainThread]: On master: BEGIN
[0m00:21:26.898044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:21:26.914571 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m00:21:26.915767 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:26.915767 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:21:26.919776 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m00:21:26.921801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d94618a-c732-4f8e-a397-a88333c11a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282ED8FC50>]}
[0m00:21:26.922802 [debug] [MainThread]: On master: ROLLBACK
[0m00:21:26.923780 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:26.924798 [debug] [MainThread]: On master: BEGIN
[0m00:21:26.925776 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:21:26.926803 [debug] [MainThread]: On master: COMMIT
[0m00:21:26.926803 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:26.926803 [debug] [MainThread]: On master: COMMIT
[0m00:21:26.927789 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:21:26.928781 [debug] [MainThread]: On master: Close
[0m00:21:26.936217 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m00:21:26.937226 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_summary ........................ [RUN]
[0m00:21:26.938220 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.daily_sales_summary'
[0m00:21:26.938220 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m00:21:26.948712 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m00:21:26.951728 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m00:21:26.996858 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.daily_sales_summary"
[0m00:21:26.999930 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:21:26.999930 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: BEGIN
[0m00:21:27.000961 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:21:27.028608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m00:21:27.029609 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:21:27.029609 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */

  
    

  create  table "analytics"."public"."daily_sales_summary__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    order_date,
    category,
    status,
    sum(quantity) as total_items_sold,
    sum(total_price) as total_revenue_usd,
    
    (sum(total_price) * 0.92)
 as total_revenue_eur
from order_details
group by order_date, category, status
order by order_date, category
  );
  
[0m00:21:27.072970 [debug] [Thread-1 (]: SQL status: SELECT 933 in 0.042 seconds
[0m00:21:27.083187 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:21:27.084195 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary" rename to "daily_sales_summary__dbt_backup"
[0m00:21:27.086198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:21:27.090333 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:21:27.090333 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary__dbt_tmp" rename to "daily_sales_summary"
[0m00:21:27.092328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:21:27.109883 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m00:21:27.109883 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:21:27.110873 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m00:21:27.115373 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:21:27.121949 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."daily_sales_summary__dbt_backup"
[0m00:21:27.127951 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:21:27.128953 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
drop table if exists "analytics"."public"."daily_sales_summary__dbt_backup" cascade
[0m00:21:27.139004 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m00:21:27.142003 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: Close
[0m00:21:27.146332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d94618a-c732-4f8e-a397-a88333c11a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282A0FF020>]}
[0m00:21:27.147844 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.daily_sales_summary ................... [[32mSELECT 933[0m in 0.21s]
[0m00:21:27.148856 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m00:21:27.150864 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:27.150864 [debug] [MainThread]: On master: BEGIN
[0m00:21:27.151895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:21:27.178203 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m00:21:27.178203 [debug] [MainThread]: On master: COMMIT
[0m00:21:27.179238 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:27.179238 [debug] [MainThread]: On master: COMMIT
[0m00:21:27.180207 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:21:27.181212 [debug] [MainThread]: On master: Close
[0m00:21:27.182312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:27.184521 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m00:21:27.184521 [debug] [MainThread]: Connection 'list_analytics_snapshots' was properly closed.
[0m00:21:27.185541 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m00:21:27.186534 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m00:21:27.186534 [info ] [MainThread]: 
[0m00:21:27.187534 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m00:21:27.187534 [debug] [MainThread]: Command end result
[0m00:21:27.275489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:21:27.279496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:21:27.287115 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m00:21:27.288090 [info ] [MainThread]: 
[0m00:21:27.289086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:21:27.289086 [info ] [MainThread]: 
[0m00:21:27.289086 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:21:27.291520 [debug] [MainThread]: Command `dbt run` succeeded at 00:21:27.290495 after 3.35 seconds
[0m00:21:27.291520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282C386750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282C387B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282C386A50>]}
[0m00:21:27.291520 [debug] [MainThread]: Flushing usage events
[0m00:21:27.532837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:26.757991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C55FCBAF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C561CBE2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C562BB9B50>]}


============================== 00:41:26.766707 | 5f5acfa8-6417-4c03-8118-5edb9bb17269 ==============================
[0m00:41:26.766707 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:41:26.767710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select daily_sales_summary', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:41:27.131047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f5acfa8-6417-4c03-8118-5edb9bb17269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5621F28D0>]}
[0m00:41:27.197086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f5acfa8-6417-4c03-8118-5edb9bb17269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C562812150>]}
[0m00:41:27.199924 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:41:27.711898 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:41:28.106046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m00:41:28.107186 [debug] [MainThread]: Partial parsing: added file: analytics_warehouse://macros\math_utils.sql
[0m00:41:28.107728 [debug] [MainThread]: Partial parsing: added file: analytics_warehouse://macros\format_utils.sql
[0m00:41:28.108278 [debug] [MainThread]: Partial parsing: added file: analytics_warehouse://macros\is_high_value_orders.sql
[0m00:41:28.108829 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://models\marts\daily_sales_summary.sql
[0m00:41:28.572457 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m00:41:28.586979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f5acfa8-6417-4c03-8118-5edb9bb17269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5645386E0>]}
[0m00:41:28.699991 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:41:28.709562 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:41:28.803843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f5acfa8-6417-4c03-8118-5edb9bb17269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5640D9910>]}
[0m00:41:28.805107 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 data tests, 3 sources, 437 macros
[0m00:41:28.806108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f5acfa8-6417-4c03-8118-5edb9bb17269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C56453A990>]}
[0m00:41:28.818943 [info ] [MainThread]: 
[0m00:41:28.819953 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:41:28.821468 [info ] [MainThread]: 
[0m00:41:28.826955 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:41:28.829203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m00:41:29.653823 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m00:41:29.653823 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m00:41:29.654824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:29.732077 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.077 seconds
[0m00:41:29.733080 [debug] [ThreadPool]: On list_analytics: Close
[0m00:41:29.740172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m00:41:29.747695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_snapshots'
[0m00:41:29.751086 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:41:29.753065 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:41:29.754056 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m00:41:29.754056 [debug] [ThreadPool]: On list_analytics_snapshots: BEGIN
[0m00:41:29.754056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:29.755056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:29.775933 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m00:41:29.777373 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:41:29.778388 [debug] [ThreadPool]: On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:41:29.786926 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m00:41:29.787928 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:41:29.787928 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:41:29.795437 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m00:41:29.797990 [debug] [ThreadPool]: On list_analytics_snapshots: ROLLBACK
[0m00:41:29.797990 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m00:41:29.800025 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m00:41:29.800025 [debug] [ThreadPool]: On list_analytics_snapshots: Close
[0m00:41:29.802024 [debug] [ThreadPool]: On list_analytics_public: Close
[0m00:41:29.810052 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:29.810052 [debug] [MainThread]: On master: BEGIN
[0m00:41:29.811054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:41:29.828545 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m00:41:29.828545 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:29.830054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:41:29.846257 [debug] [MainThread]: SQL status: SELECT 8 in 0.016 seconds
[0m00:41:29.849809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f5acfa8-6417-4c03-8118-5edb9bb17269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C564B3AEA0>]}
[0m00:41:29.849809 [debug] [MainThread]: On master: ROLLBACK
[0m00:41:29.850818 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:29.851791 [debug] [MainThread]: On master: BEGIN
[0m00:41:29.853788 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:41:29.853788 [debug] [MainThread]: On master: COMMIT
[0m00:41:29.854789 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:29.854789 [debug] [MainThread]: On master: COMMIT
[0m00:41:29.855791 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:41:29.856795 [debug] [MainThread]: On master: Close
[0m00:41:29.865331 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m00:41:29.865331 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_summary ........................ [RUN]
[0m00:41:29.866363 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.daily_sales_summary'
[0m00:41:29.867341 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m00:41:29.878353 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m00:41:29.883893 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m00:41:29.927718 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.daily_sales_summary"
[0m00:41:29.929696 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:41:29.931204 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: BEGIN
[0m00:41:29.932213 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:41:29.962345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m00:41:29.963346 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:41:29.965889 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */

  
    

  create  table "analytics"."public"."daily_sales_summary__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    order_date,
    category,
    status,
    sum(quantity) as total_items_sold,
    sum(total_price) as total_revenue_usd,
    
    (sum(total_price) * 0.92)
 as total_revenue_eur,
    
    concat('$', round(sum(total_price), 2))
 as formatted_usd,
    
    (sum(total_price) > 1000)
 as is_high_volume_day
from order_details
group by order_date, category, status
order by order_date, category
  );
  
[0m00:41:29.981803 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 26:     concat('$', round(sum(total_price), 2))
                         ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:41:29.984821 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: ROLLBACK
[0m00:41:29.986921 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: Close
[0m00:41:30.025796 [debug] [Thread-1 (]: Database Error in model daily_sales_summary (models\marts\daily_sales_summary.sql)
  function round(double precision, integer) does not exist
  LINE 26:     concat('$', round(sum(total_price), 2))
                           ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\analytics_warehouse\models\marts\daily_sales_summary.sql
[0m00:41:30.029804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f5acfa8-6417-4c03-8118-5edb9bb17269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C562183CB0>]}
[0m00:41:30.034348 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.daily_sales_summary ............... [[31mERROR[0m in 0.16s]
[0m00:41:30.036330 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m00:41:30.038326 [debug] [Thread-7 (]: Marking all children of 'model.analytics_warehouse.daily_sales_summary' to be skipped because of status 'error'.  Reason: Database Error in model daily_sales_summary (models\marts\daily_sales_summary.sql)
  function round(double precision, integer) does not exist
  LINE 26:     concat('$', round(sum(total_price), 2))
                           ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\analytics_warehouse\models\marts\daily_sales_summary.sql.
[0m00:41:30.042331 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:30.042842 [debug] [MainThread]: On master: BEGIN
[0m00:41:30.042842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:41:30.095167 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m00:41:30.095705 [debug] [MainThread]: On master: COMMIT
[0m00:41:30.095705 [debug] [MainThread]: Using postgres connection "master"
[0m00:41:30.096721 [debug] [MainThread]: On master: COMMIT
[0m00:41:30.099258 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:41:30.100280 [debug] [MainThread]: On master: Close
[0m00:41:30.101999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:30.103035 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m00:41:30.104553 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m00:41:30.104553 [debug] [MainThread]: Connection 'list_analytics_snapshots' was properly closed.
[0m00:41:30.105565 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m00:41:30.105565 [info ] [MainThread]: 
[0m00:41:30.108220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m00:41:30.111481 [debug] [MainThread]: Command end result
[0m00:41:30.175433 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:41:30.191718 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:41:30.212325 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m00:41:30.212325 [info ] [MainThread]: 
[0m00:41:30.213339 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:41:30.217377 [info ] [MainThread]: 
[0m00:41:30.219372 [error] [MainThread]:   Database Error in model daily_sales_summary (models\marts\daily_sales_summary.sql)
  function round(double precision, integer) does not exist
  LINE 26:     concat('$', round(sum(total_price), 2))
                           ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\analytics_warehouse\models\marts\daily_sales_summary.sql
[0m00:41:30.220385 [info ] [MainThread]: 
[0m00:41:30.222385 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:41:30.224385 [debug] [MainThread]: Command `dbt run` failed at 00:41:30.224385 after 4.00 seconds
[0m00:41:30.227385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C562CD1F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C562CD1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C562CD1370>]}
[0m00:41:30.228388 [debug] [MainThread]: Flushing usage events
[0m00:41:30.552704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:42:58.476976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265852FADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265876FD400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265876FC860>]}


============================== 00:42:58.483104 | 3f549c33-58d6-4b37-a383-01d40ef8787d ==============================
[0m00:42:58.483104 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:42:58.484104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select daily_sales_summary', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:42:58.802602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f549c33-58d6-4b37-a383-01d40ef8787d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026587792810>]}
[0m00:42:58.930516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f549c33-58d6-4b37-a383-01d40ef8787d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026589394A70>]}
[0m00:42:58.935375 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:42:59.444763 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:42:59.777442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:42:59.778441 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://macros\format_utils.sql
[0m00:43:00.269146 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m00:43:00.287739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f549c33-58d6-4b37-a383-01d40ef8787d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026589A0BEF0>]}
[0m00:43:00.386413 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:43:00.393409 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:43:00.471276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f549c33-58d6-4b37-a383-01d40ef8787d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026589CAB320>]}
[0m00:43:00.471276 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 data tests, 3 sources, 437 macros
[0m00:43:00.472278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f549c33-58d6-4b37-a383-01d40ef8787d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026589ABA330>]}
[0m00:43:00.475281 [info ] [MainThread]: 
[0m00:43:00.476275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:43:00.502222 [info ] [MainThread]: 
[0m00:43:00.539504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:43:00.552400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m00:43:01.171044 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m00:43:01.171044 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m00:43:01.171044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:01.201986 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.030 seconds
[0m00:43:01.203000 [debug] [ThreadPool]: On list_analytics: Close
[0m00:43:01.209159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_snapshots'
[0m00:43:01.215731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m00:43:01.216742 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:43:01.217738 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:43:01.218737 [debug] [ThreadPool]: On list_analytics_snapshots: BEGIN
[0m00:43:01.218737 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m00:43:01.219737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:01.219737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:01.239506 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m00:43:01.240515 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:43:01.240515 [debug] [ThreadPool]: On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:43:01.242517 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m00:43:01.242517 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:43:01.243545 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:43:01.246521 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m00:43:01.246521 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m00:43:01.249044 [debug] [ThreadPool]: On list_analytics_snapshots: ROLLBACK
[0m00:43:01.250074 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m00:43:01.252054 [debug] [ThreadPool]: On list_analytics_snapshots: Close
[0m00:43:01.252054 [debug] [ThreadPool]: On list_analytics_public: Close
[0m00:43:01.260054 [debug] [MainThread]: Using postgres connection "master"
[0m00:43:01.261055 [debug] [MainThread]: On master: BEGIN
[0m00:43:01.261055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:43:01.278083 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m00:43:01.278083 [debug] [MainThread]: Using postgres connection "master"
[0m00:43:01.279121 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:43:01.284282 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m00:43:01.286296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f549c33-58d6-4b37-a383-01d40ef8787d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658A06D610>]}
[0m00:43:01.286296 [debug] [MainThread]: On master: ROLLBACK
[0m00:43:01.288281 [debug] [MainThread]: Using postgres connection "master"
[0m00:43:01.288281 [debug] [MainThread]: On master: BEGIN
[0m00:43:01.290283 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:43:01.290283 [debug] [MainThread]: On master: COMMIT
[0m00:43:01.291290 [debug] [MainThread]: Using postgres connection "master"
[0m00:43:01.291290 [debug] [MainThread]: On master: COMMIT
[0m00:43:01.292282 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:43:01.293311 [debug] [MainThread]: On master: Close
[0m00:43:01.300821 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m00:43:01.300821 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_summary ........................ [RUN]
[0m00:43:01.301825 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.daily_sales_summary'
[0m00:43:01.302826 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m00:43:01.313109 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m00:43:01.319677 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m00:43:01.364375 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.daily_sales_summary"
[0m00:43:01.367387 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:43:01.367920 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: BEGIN
[0m00:43:01.367920 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:43:01.386434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m00:43:01.386434 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:43:01.387446 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */

  
    

  create  table "analytics"."public"."daily_sales_summary__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    order_date,
    category,
    status,
    sum(quantity) as total_items_sold,
    sum(total_price) as total_revenue_usd,
    
    (sum(total_price) * 0.92)
 as total_revenue_eur,
    
    concat('$', round(sum(total_price)::numeric, 2))
 as formatted_usd,
    
    (sum(total_price) > 1000)
 as is_high_volume_day
from order_details
group by order_date, category, status
order by order_date, category
  );
  
[0m00:43:01.435113 [debug] [Thread-1 (]: SQL status: SELECT 933 in 0.047 seconds
[0m00:43:01.444816 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:43:01.445818 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary" rename to "daily_sales_summary__dbt_backup"
[0m00:43:01.447814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:43:01.451064 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:43:01.452065 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary__dbt_tmp" rename to "daily_sales_summary"
[0m00:43:01.453061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:43:01.469833 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m00:43:01.470829 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:43:01.470829 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m00:43:01.474805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:43:01.481360 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."daily_sales_summary__dbt_backup"
[0m00:43:01.486440 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:43:01.487425 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
drop table if exists "analytics"."public"."daily_sales_summary__dbt_backup" cascade
[0m00:43:01.502992 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m00:43:01.505979 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: Close
[0m00:43:01.509979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f549c33-58d6-4b37-a383-01d40ef8787d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265853EED80>]}
[0m00:43:01.511009 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.daily_sales_summary ................... [[32mSELECT 933[0m in 0.21s]
[0m00:43:01.511977 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m00:43:01.512975 [debug] [MainThread]: Using postgres connection "master"
[0m00:43:01.512975 [debug] [MainThread]: On master: BEGIN
[0m00:43:01.512975 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:43:01.533248 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m00:43:01.534252 [debug] [MainThread]: On master: COMMIT
[0m00:43:01.535241 [debug] [MainThread]: Using postgres connection "master"
[0m00:43:01.535241 [debug] [MainThread]: On master: COMMIT
[0m00:43:01.537274 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:43:01.538248 [debug] [MainThread]: On master: Close
[0m00:43:01.539247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:43:01.540244 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m00:43:01.540244 [debug] [MainThread]: Connection 'list_analytics_snapshots' was properly closed.
[0m00:43:01.541242 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m00:43:01.541242 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m00:43:01.542242 [info ] [MainThread]: 
[0m00:43:01.543243 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m00:43:01.544246 [debug] [MainThread]: Command end result
[0m00:43:01.632270 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:43:01.637553 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:43:01.644664 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m00:43:01.645667 [info ] [MainThread]: 
[0m00:43:01.645667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:43:01.646662 [info ] [MainThread]: 
[0m00:43:01.648175 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:43:01.649209 [debug] [MainThread]: Command `dbt run` succeeded at 00:43:01.649209 after 3.69 seconds
[0m00:43:01.650218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026587FA44A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026587FDBC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026587B27530>]}
[0m00:43:01.650218 [debug] [MainThread]: Flushing usage events
[0m00:43:01.894077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:43:22.217223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A96B980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A2E1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A2E3680>]}


============================== 00:43:22.224249 | 5c96747b-deaa-4b32-9271-8e95be7dc075 ==============================
[0m00:43:22.224249 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:43:22.225245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:43:22.505270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c96747b-deaa-4b32-9271-8e95be7dc075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6BF8D730>]}
[0m00:43:22.567505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c96747b-deaa-4b32-9271-8e95be7dc075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6AB029C0>]}
[0m00:43:22.569524 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:43:23.091608 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:43:23.560332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:43:23.560332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:43:23.567864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m00:43:23.629795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c96747b-deaa-4b32-9271-8e95be7dc075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6AE01730>]}
[0m00:43:23.692293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c96747b-deaa-4b32-9271-8e95be7dc075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6C5C92E0>]}
[0m00:43:23.693295 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 data tests, 3 sources, 437 macros
[0m00:43:23.693295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c96747b-deaa-4b32-9271-8e95be7dc075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6C04AE40>]}
[0m00:43:23.696292 [info ] [MainThread]: 
[0m00:43:23.696292 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:43:23.697801 [info ] [MainThread]: 
[0m00:43:23.698811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:43:23.707346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_snapshots'
[0m00:43:23.714843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m00:43:24.432374 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:43:24.432374 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:43:24.432374 [debug] [ThreadPool]: On list_analytics_snapshots: BEGIN
[0m00:43:24.433385 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m00:43:24.433385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:24.434381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:24.465530 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m00:43:24.465530 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m00:43:24.466566 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:43:24.466566 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:43:24.466566 [debug] [ThreadPool]: On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:43:24.467541 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:43:24.471537 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m00:43:24.471537 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m00:43:24.473543 [debug] [ThreadPool]: On list_analytics_snapshots: ROLLBACK
[0m00:43:24.474538 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m00:43:24.476538 [debug] [ThreadPool]: On list_analytics_public: Close
[0m00:43:24.476538 [debug] [ThreadPool]: On list_analytics_snapshots: Close
[0m00:43:24.485284 [debug] [MainThread]: Using postgres connection "master"
[0m00:43:24.486284 [debug] [MainThread]: On master: BEGIN
[0m00:43:24.486284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:43:24.503273 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m00:43:24.503273 [debug] [MainThread]: Using postgres connection "master"
[0m00:43:24.504300 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:43:24.510274 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m00:43:24.512277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c96747b-deaa-4b32-9271-8e95be7dc075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6ADD5E80>]}
[0m00:43:24.513273 [debug] [MainThread]: On master: ROLLBACK
[0m00:43:24.514782 [debug] [MainThread]: On master: Close
[0m00:43:24.522303 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.stg_customers
[0m00:43:24.522303 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.stg_orders
[0m00:43:24.523313 [debug] [Thread-3 (]: Began running node model.analytics_warehouse.stg_products
[0m00:43:24.523313 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_customers'
[0m00:43:24.524333 [debug] [Thread-4 (]: Began running node snapshot.analytics_warehouse.customers_snapshot
[0m00:43:24.524333 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_orders'
[0m00:43:24.525331 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.analytics_warehouse.stg_products'
[0m00:43:24.525331 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.stg_customers
[0m00:43:24.526316 [debug] [Thread-4 (]: Acquiring new postgres connection 'snapshot.analytics_warehouse.customers_snapshot'
[0m00:43:24.526316 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.stg_orders
[0m00:43:24.527313 [debug] [Thread-3 (]: Began compiling node model.analytics_warehouse.stg_products
[0m00:43:24.536384 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.stg_customers"
[0m00:43:24.536384 [debug] [Thread-4 (]: Began compiling node snapshot.analytics_warehouse.customers_snapshot
[0m00:43:24.539362 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.stg_orders"
[0m00:43:24.541920 [debug] [Thread-3 (]: Writing injected SQL for node "model.analytics_warehouse.stg_products"
[0m00:43:24.545950 [debug] [Thread-4 (]: Began executing node snapshot.analytics_warehouse.customers_snapshot
[0m00:43:24.546930 [debug] [Thread-4 (]: Finished running node snapshot.analytics_warehouse.customers_snapshot
[0m00:43:24.549456 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.stg_customers
[0m00:43:24.550454 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.stg_customers
[0m00:43:24.551486 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:43:24.552460 [debug] [Thread-3 (]: Began executing node model.analytics_warehouse.stg_products
[0m00:43:24.552460 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:43:24.553477 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.analytics_warehouse.customers_snapshot, now test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m00:43:24.554027 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.stg_orders
[0m00:43:24.554027 [debug] [Thread-3 (]: Finished running node model.analytics_warehouse.stg_products
[0m00:43:24.555061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_customers, now test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada)
[0m00:43:24.555061 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:43:24.556035 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.stg_orders
[0m00:43:24.557040 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:43:24.557040 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:43:24.572565 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:43:24.572565 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:43:24.579570 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada"
[0m00:43:24.579570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_products, now test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3)
[0m00:43:24.579570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.stg_orders, now test.analytics_warehouse.unique_stg_products_product_id.7d950a1467)
[0m00:43:24.581079 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:43:24.582092 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:43:24.586102 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3"
[0m00:43:24.590089 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_products_product_id.7d950a1467"
[0m00:43:24.591600 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:43:24.592742 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:43:24.593753 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:43:24.594755 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada
[0m00:43:24.595764 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.int_customer_orders
[0m00:43:24.596752 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:43:24.598268 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:43:24.599253 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:43:24.599760 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.analytics_warehouse.int_customer_orders)
[0m00:43:24.600291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_stg_customers_customer_id.c7614daada, now test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64)
[0m00:43:24.600825 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3
[0m00:43:24.601906 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.unique_stg_products_product_id.7d950a1467
[0m00:43:24.602424 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.int_customer_orders
[0m00:43:24.602974 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:43:24.602974 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:43:24.606758 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.int_customer_orders"
[0m00:43:24.611662 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:43:24.612202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_products_product_id.6373b0acf3, now test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a)
[0m00:43:24.613286 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:43:24.619364 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a"
[0m00:43:24.620453 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:43:24.621470 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.int_customer_orders
[0m00:43:24.622465 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64
[0m00:43:24.623985 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.int_customer_orders
[0m00:43:24.624534 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:43:24.626544 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a
[0m00:43:24.626544 [debug] [Thread-2 (]: Began running node model.analytics_warehouse.int_order_details
[0m00:43:24.627570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_stg_products_product_id.7d950a1467, now model.analytics_warehouse.int_order_details)
[0m00:43:24.628548 [debug] [Thread-2 (]: Began compiling node model.analytics_warehouse.int_order_details
[0m00:43:24.631819 [debug] [Thread-2 (]: Writing injected SQL for node "model.analytics_warehouse.int_order_details"
[0m00:43:24.634846 [debug] [Thread-2 (]: Began executing node model.analytics_warehouse.int_order_details
[0m00:43:24.635844 [debug] [Thread-2 (]: Finished running node model.analytics_warehouse.int_order_details
[0m00:43:24.636841 [debug] [Thread-4 (]: Began running node model.analytics_warehouse.customer_lifetime_value
[0m00:43:24.637535 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m00:43:24.638598 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.int_customer_orders, now model.analytics_warehouse.customer_lifetime_value)
[0m00:43:24.638598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.not_null_stg_orders_order_id.81cfe2fe64, now model.analytics_warehouse.daily_sales_summary)
[0m00:43:24.639609 [debug] [Thread-4 (]: Began compiling node model.analytics_warehouse.customer_lifetime_value
[0m00:43:24.640609 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m00:43:24.645068 [debug] [Thread-4 (]: Writing injected SQL for node "model.analytics_warehouse.customer_lifetime_value"
[0m00:43:24.652186 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m00:43:24.655199 [debug] [Thread-4 (]: Began executing node model.analytics_warehouse.customer_lifetime_value
[0m00:43:24.656202 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m00:43:24.657202 [debug] [Thread-4 (]: Finished running node model.analytics_warehouse.customer_lifetime_value
[0m00:43:24.658626 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m00:43:24.659167 [debug] [Thread-2 (]: Began running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:43:24.659703 [debug] [Thread-3 (]: Began running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:43:24.660245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.int_order_details, now test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a)
[0m00:43:24.660784 [debug] [Thread-1 (]: Began running node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m00:43:24.661408 [debug] [Thread-4 (]: Began running node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m00:43:24.661950 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.analytics_warehouse.unique_stg_orders_order_id.e3b841c71a, now test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9)
[0m00:43:24.662488 [debug] [Thread-2 (]: Began compiling node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:43:24.663024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.daily_sales_summary, now test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2)
[0m00:43:24.663594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.analytics_warehouse.customer_lifetime_value, now test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf)
[0m00:43:24.664147 [debug] [Thread-3 (]: Began compiling node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:43:24.669204 [debug] [Thread-2 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a"
[0m00:43:24.669766 [debug] [Thread-1 (]: Began compiling node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m00:43:24.670304 [debug] [Thread-4 (]: Began compiling node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m00:43:24.676098 [debug] [Thread-3 (]: Writing injected SQL for node "test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9"
[0m00:43:24.681247 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2"
[0m00:43:24.686275 [debug] [Thread-4 (]: Writing injected SQL for node "test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf"
[0m00:43:24.687614 [debug] [Thread-2 (]: Began executing node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:43:24.689929 [debug] [Thread-2 (]: Finished running node test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a
[0m00:43:24.692006 [debug] [Thread-4 (]: Began executing node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m00:43:24.693008 [debug] [Thread-3 (]: Began executing node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:43:24.693008 [debug] [Thread-1 (]: Began executing node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m00:43:24.694008 [debug] [Thread-4 (]: Finished running node test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf
[0m00:43:24.695037 [debug] [Thread-3 (]: Finished running node test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9
[0m00:43:24.696572 [debug] [Thread-1 (]: Finished running node test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2
[0m00:43:24.697695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:43:24.699033 [debug] [MainThread]: Connection 'list_analytics_snapshots' was properly closed.
[0m00:43:24.700046 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m00:43:24.700046 [debug] [MainThread]: Connection 'test.analytics_warehouse.not_null_daily_sales_summary_order_date.7004dd75f2' was properly closed.
[0m00:43:24.700046 [debug] [MainThread]: Connection 'test.analytics_warehouse.not_null_customer_lifetime_value_customer_id.c206bdd83a' was properly closed.
[0m00:43:24.701051 [debug] [MainThread]: Connection 'test.analytics_warehouse.unique_customer_lifetime_value_customer_id.90786299e9' was properly closed.
[0m00:43:24.701051 [debug] [MainThread]: Connection 'test.analytics_warehouse.not_null_daily_sales_summary_total_revenue.9c70a180cf' was properly closed.
[0m00:43:24.704689 [debug] [MainThread]: Command end result
[0m00:43:24.819666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:43:24.830527 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:43:24.856312 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m00:43:24.867702 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m00:43:24.867702 [info ] [MainThread]: Building catalog
[0m00:43:24.888270 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m00:43:24.896809 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m00:43:24.897321 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m00:43:24.897321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:24.920216 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m00:43:24.920726 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m00:43:24.921295 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_order_details')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_customer_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('daily_sales_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customer_lifetime_value')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('customers_snapshot')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m00:43:24.932606 [debug] [ThreadPool]: SQL status: SELECT 81 in 0.011 seconds
[0m00:43:24.938342 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m00:43:24.939475 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m00:43:24.962592 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\catalog.json
[0m00:43:24.989008 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:43:24.994643 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:43:24.994643 [info ] [MainThread]: Catalog written to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\catalog.json
[0m00:43:24.996659 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:43:24.996659 after 3.00 seconds
[0m00:43:24.997663 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:43:24.997663 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m00:43:24.998944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A376DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A375820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A3765A0>]}
[0m00:43:24.998944 [debug] [MainThread]: Flushing usage events
[0m00:43:25.237247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:43:35.991185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997B1CAD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997DFA9CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997B0FC590>]}


============================== 00:43:35.998907 | afa2e9f7-ca77-4887-b109-fbd36dfee822 ==============================
[0m00:43:35.998907 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:43:35.999916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:43:36.306637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afa2e9f7-ca77-4887-b109-fbd36dfee822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997D5E21B0>]}
[0m00:43:36.405692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afa2e9f7-ca77-4887-b109-fbd36dfee822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997DCBBAA0>]}
[0m00:47:47.697668 [error] [MainThread]: Encountered an error:

[0m00:47:47.730445 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m00:47:47.737039 [debug] [MainThread]: Command `dbt docs serve` failed at 00:47:47.737039 after 251.98 seconds
[0m00:47:47.739018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997DC91700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997F326810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997F3AD8E0>]}
[0m00:47:47.741021 [debug] [MainThread]: Flushing usage events
[0m00:47:48.044737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:48:09.824513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BA73E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BD3F12E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BD3F1220>]}


============================== 00:48:09.831067 | 4926691e-ba6d-4b3b-bcc5-20d0d5726d78 ==============================
[0m00:48:09.831067 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:48:09.832083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Owner\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Owner\\modern_dbt_warehouse\\analytics_warehouse\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select daily_sales_summary', 'send_anonymous_usage_stats': 'True'}
[0m00:48:10.138759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4926691e-ba6d-4b3b-bcc5-20d0d5726d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BD6C51F0>]}
[0m00:48:10.221573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4926691e-ba6d-4b3b-bcc5-20d0d5726d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BD6ED520>]}
[0m00:48:10.223603 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:48:10.853546 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:48:11.169864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:48:11.170865 [debug] [MainThread]: Partial parsing: updated file: analytics_warehouse://macros\format_utils.sql
[0m00:48:11.629405 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_warehouse.example
[0m00:48:11.645783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4926691e-ba6d-4b3b-bcc5-20d0d5726d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BF0887D0>]}
[0m00:48:11.753566 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:48:11.761443 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:48:11.815828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4926691e-ba6d-4b3b-bcc5-20d0d5726d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BE956750>]}
[0m00:48:11.815828 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 data tests, 3 sources, 437 macros
[0m00:48:11.816838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4926691e-ba6d-4b3b-bcc5-20d0d5726d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BF010950>]}
[0m00:48:11.818851 [info ] [MainThread]: 
[0m00:48:11.819837 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:48:11.819837 [info ] [MainThread]: 
[0m00:48:11.820836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:48:11.821838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m00:48:12.421762 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m00:48:12.422775 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m00:48:12.422775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:12.452942 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.031 seconds
[0m00:48:12.455459 [debug] [ThreadPool]: On list_analytics: Close
[0m00:48:12.461458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_snapshots'
[0m00:48:12.466544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m00:48:12.468543 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:48:12.470569 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:48:12.471539 [debug] [ThreadPool]: On list_analytics_snapshots: BEGIN
[0m00:48:12.471539 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m00:48:12.471539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:12.472542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:12.491431 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m00:48:12.491431 [debug] [ThreadPool]: Using postgres connection "list_analytics_snapshots"
[0m00:48:12.492436 [debug] [ThreadPool]: On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:48:12.496435 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m00:48:12.496435 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m00:48:12.497942 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m00:48:12.497942 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:48:12.499987 [debug] [ThreadPool]: On list_analytics_snapshots: ROLLBACK
[0m00:48:12.500960 [debug] [ThreadPool]: On list_analytics_snapshots: Close
[0m00:48:12.511957 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m00:48:12.512982 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m00:48:12.515528 [debug] [ThreadPool]: On list_analytics_public: Close
[0m00:48:12.522534 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:12.523537 [debug] [MainThread]: On master: BEGIN
[0m00:48:12.523537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:48:12.540091 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m00:48:12.540091 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:12.540091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:48:12.545116 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m00:48:12.547607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4926691e-ba6d-4b3b-bcc5-20d0d5726d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BF0F4050>]}
[0m00:48:12.548622 [debug] [MainThread]: On master: ROLLBACK
[0m00:48:12.549620 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:12.549620 [debug] [MainThread]: On master: BEGIN
[0m00:48:12.551620 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:48:12.551620 [debug] [MainThread]: On master: COMMIT
[0m00:48:12.552640 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:12.552640 [debug] [MainThread]: On master: COMMIT
[0m00:48:12.553618 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:48:12.553618 [debug] [MainThread]: On master: Close
[0m00:48:12.563572 [debug] [Thread-1 (]: Began running node model.analytics_warehouse.daily_sales_summary
[0m00:48:12.563572 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_summary ........................ [RUN]
[0m00:48:12.564571 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.analytics_warehouse.daily_sales_summary'
[0m00:48:12.565827 [debug] [Thread-1 (]: Began compiling node model.analytics_warehouse.daily_sales_summary
[0m00:48:12.574991 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_warehouse.daily_sales_summary"
[0m00:48:12.577999 [debug] [Thread-1 (]: Began executing node model.analytics_warehouse.daily_sales_summary
[0m00:48:12.626306 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_warehouse.daily_sales_summary"
[0m00:48:12.629298 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:48:12.630289 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: BEGIN
[0m00:48:12.630289 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:48:12.649265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m00:48:12.650297 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:48:12.650297 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */

  
    

  create  table "analytics"."public"."daily_sales_summary__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "analytics"."public"."int_order_details"
)

select
    order_date,
    category,
    status,
    sum(quantity) as total_items_sold,
    sum(total_price) as total_revenue_usd,
    
    (sum(total_price) * 0.92)
 as total_revenue_eur,
    
    concat('$', to_char(sum(total_price)::numeric, 'FM999G999G999D00'))
 as formatted_usd,
    
    (sum(total_price) > 1000)
 as is_high_volume_day
from order_details
group by order_date, category, status
order by order_date, category
  );
  
[0m00:48:12.683749 [debug] [Thread-1 (]: SQL status: SELECT 933 in 0.033 seconds
[0m00:48:12.695753 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:48:12.696755 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary" rename to "daily_sales_summary__dbt_backup"
[0m00:48:12.698860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:48:12.701907 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:48:12.701907 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
alter table "analytics"."public"."daily_sales_summary__dbt_tmp" rename to "daily_sales_summary"
[0m00:48:12.703869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:48:12.720406 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m00:48:12.721422 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:48:12.721422 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: COMMIT
[0m00:48:12.731398 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m00:48:12.737929 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."daily_sales_summary__dbt_backup"
[0m00:48:12.742929 [debug] [Thread-1 (]: Using postgres connection "model.analytics_warehouse.daily_sales_summary"
[0m00:48:12.743930 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_warehouse", "target_name": "dev", "node_id": "model.analytics_warehouse.daily_sales_summary"} */
drop table if exists "analytics"."public"."daily_sales_summary__dbt_backup" cascade
[0m00:48:12.749975 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:48:12.752013 [debug] [Thread-1 (]: On model.analytics_warehouse.daily_sales_summary: Close
[0m00:48:12.758175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4926691e-ba6d-4b3b-bcc5-20d0d5726d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BA84EDE0>]}
[0m00:48:12.759209 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.daily_sales_summary ................... [[32mSELECT 933[0m in 0.19s]
[0m00:48:12.759754 [debug] [Thread-1 (]: Finished running node model.analytics_warehouse.daily_sales_summary
[0m00:48:12.761763 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:12.761763 [debug] [MainThread]: On master: BEGIN
[0m00:48:12.761763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:48:12.779542 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m00:48:12.781052 [debug] [MainThread]: On master: COMMIT
[0m00:48:12.782065 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:12.782065 [debug] [MainThread]: On master: COMMIT
[0m00:48:12.784078 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:48:12.785089 [debug] [MainThread]: On master: Close
[0m00:48:12.786074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:48:12.787081 [debug] [MainThread]: Connection 'list_analytics' was properly closed.
[0m00:48:12.788090 [debug] [MainThread]: Connection 'list_analytics_snapshots' was properly closed.
[0m00:48:12.788090 [debug] [MainThread]: Connection 'list_analytics_public' was properly closed.
[0m00:48:12.789077 [debug] [MainThread]: Connection 'model.analytics_warehouse.daily_sales_summary' was properly closed.
[0m00:48:12.790096 [info ] [MainThread]: 
[0m00:48:12.790096 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m00:48:12.791075 [debug] [MainThread]: Command end result
[0m00:48:12.877712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\manifest.json
[0m00:48:12.883269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\semantic_manifest.json
[0m00:48:12.890267 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Owner\modern_dbt_warehouse\analytics_warehouse\target\run_results.json
[0m00:48:12.891274 [info ] [MainThread]: 
[0m00:48:12.892275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:48:12.893268 [info ] [MainThread]: 
[0m00:48:12.893268 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:48:12.895271 [debug] [MainThread]: Command `dbt run` succeeded at 00:48:12.895271 after 3.59 seconds
[0m00:48:12.895271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BD231850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BD2322D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193BD2320F0>]}
[0m00:48:12.896271 [debug] [MainThread]: Flushing usage events
[0m00:48:13.120780 [debug] [MainThread]: An error was encountered while trying to flush usage events
